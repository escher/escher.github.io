!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.escher=a()}}(function(){var a;return function b(a,c,d){function e(g,h){if(!c[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};a[g][0].call(k.exports,function(b){var c=a[g][1][b];return e(c?c:b)},k,k.exports,b,a,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function d(a,b){this.map=a,this.undo_stack=b,this.empty_behavior=function(){},this.rotation_mode_enabled=!1,this.rotation_drag=w(),this.selectable_mousedown=null,this.text_label_mousedown=null,this.text_label_click=null,this.selectable_drag=this.empty_behavior,this.node_mouseover=null,this.node_mouseout=null,this.label_mousedown=null,this.label_mouseover=null,this.label_mouseout=null,this.bezier_drag=this.empty_behavior,this.bezier_mouseover=null,this.bezier_mouseout=null,this.reaction_label_drag=this.empty_behavior,this.node_label_drag=this.empty_behavior,this.dragging=!1,this.turn_everything_on()}function e(){this.toggle_selectable_click(!0),this.toggle_selectable_drag(!0),this.toggle_label_drag(!0),this.toggle_label_mouseover(!0)}function f(){this.toggle_selectable_click(!1),this.toggle_selectable_drag(!1),this.toggle_label_drag(!1),this.toggle_label_mouseover(!1)}function g(a){function b(){var a=this.map.sel.selectAll("#rotation-center").data([0]),b=a.enter().append("g").attr("id","rotation-center");b.append("path").attr("d","M-32 0 L32 0").attr("class","rotation-center-line"),b.append("path").attr("d","M0 -32 L0 32").attr("class","rotation-center-line"),b.merge(a).attr("transform","translate("+this.center.x+","+this.center.y+")").attr("visibility","visible"),a.call(w().on("drag",function(a){var b=u.d3_transform_catch(a.attr("transform")),c=[z.event.dx+b.translate[0],z.event.dy+b.translate[1]];a.attr("transform","translate("+c+")"),this.center={x:c[0],y:c[1]}}.bind(this,a))),a.on("mouseover",function(){var a=parseFloat(this.selectAll("path").style("stroke-width"));this.selectAll("path").style("stroke-width",2*a+"px")}.bind(a)),a.on("mouseout",function(){this.selectAll("path").style("stroke-width",null)}.bind(a))}function c(a){this.map.sel.select("#rotation-center").attr("visibility","hidden")}function d(a){var b=[],c=[];for(var d in a){var e=a[d];void 0!==e.x&&b.push(e.x),void 0!==e.y&&c.push(e.y)}return{x:u.mean(b),y:u.mean(c)}}void 0===a?this.rotation_mode_enabled=!this.rotation_mode_enabled:this.rotation_mode_enabled=a;var e=this.map.sel.selectAll(".node-circle"),f=this.map.sel.selectAll("#canvas");if(this.rotation_mode_enabled){this.map.callback_manager.run("start_rotation");var g=this.map.get_selected_nodes();if(0===Object.keys(g).length)return void console.warn("No selected nodes");this.center=d(g),b.call(this);var h=this.map,i=Object.keys(g),j=this.map.reactions,k=this.map.nodes,l=this.map.beziers,m=function(a){z.event.sourceEvent.stopPropagation()},n=function(a,b,c,d){var e=v.rotate_nodes(g,j,l,b,d);h.draw_these_nodes(e.node_ids),h.draw_these_reactions(e.reaction_ids)},o=function(a){},p=function(a,b,c){var d={};i.forEach(function(a){d[a]=k[a]});var e=v.rotate_nodes(d,j,l,-b,c);h.draw_these_nodes(e.node_ids),h.draw_these_reactions(e.reaction_ids)},q=function(a,b,c){var d={};i.forEach(function(a){d[a]=k[a]});var e=v.rotate_nodes(d,j,l,b,c);h.draw_these_nodes(e.node_ids),h.draw_these_reactions(e.reaction_ids)},r=function(){return this.center}.bind(this);this.rotation_drag=this._get_generic_angular_drag(m,n,o,p,q,r,this.map.sel),f.call(this.rotation_drag),this.selectable_drag=this.rotation_drag}else c.call(this),e.on("mousedown.center",null),f.on("mousedown.center",null),f.on("mousedown.drag",null),f.on("touchstart.drag",null),this.rotation_drag=null,this.selectable_drag=null}function h(a){if(void 0===a&&(a=null===this.selectable_mousedown),a){var b=this.map;this.selectable_mousedown=function(a){z.event.stopPropagation()},this.selectable_click=function(a){z.event.stopPropagation(),z.event.defaultPrevented||b.select_selectable(this,a,z.event.shiftKey)},this.node_mouseover=function(a){x(this).style("stroke-width",null);var b=parseFloat(x(this).style("stroke-width"));x(this.parentNode).classed("selected")||x(this).style("stroke-width",3*b+"px")},this.node_mouseout=function(a){x(this).style("stroke-width",null)}}else this.selectable_mousedown=null,this.selectable_click=null,this.node_mouseover=null,this.node_mouseout=null,this.map.sel.select("#nodes").selectAll(".node-circle").style("stroke-width",null)}function i(a){if(void 0===a&&(a=null==this.text_edit_mousedown),a){var b=this.map;this.selection;this.text_label_mousedown=function(){if(!z.event.defaultPrevented){var a=u.d3_transform_catch(x(this).attr("transform")).translate,c={x:a[0],y:a[1]};b.callback_manager.run("edit_text_label",null,x(this),c),z.event.stopPropagation()}},this.text_label_click=null,this.map.sel.select("#text-labels").selectAll(".label").classed("edit-text-cursor",!0),this.map.sel.on("mousedown.new_text_label",function(a){z.event.preventDefault();var b={x:y(a)[0],y:y(a)[1]};this.map.callback_manager.run("new_text_label",null,b)}.bind(this,this.map.sel.node()))}else this.text_label_mousedown=this.selectable_mousedown,this.text_label_click=this.selectable_click,this.map.sel.select("#text-labels").selectAll(".label").classed("edit-text-cursor",!1),this.map.sel.on("mousedown.new_text_label",null),this.map.callback_manager.run("hide_text_label_editor")}function j(a){void 0===a&&(a=this.selectable_drag===this.empty_behavior),a?(this.selectable_drag=this._get_selectable_drag(this.map,this.undo_stack),this.bezier_drag=this._get_bezier_drag(this.map,this.undo_stack)):(this.selectable_drag=this.empty_behavior,this.bezier_drag=this.empty_behavior)}function k(a){void 0===a&&(a=this.label_drag===this.empty_behavior),a?(this.reaction_label_drag=this._get_reaction_label_drag(this.map),this.node_label_drag=this._get_node_label_drag(this.map)):(this.reaction_label_drag=this.empty_behavior,this.node_label_drag=this.empty_behavior)}function l(a){void 0===a&&(a=null===this.label_mouseover),a?(this.label_mouseover=function(a,b){this.dragging||this.map.callback_manager.run("show_tooltip",null,a,b)}.bind(this),this.label_mouseout=function(){this.map.callback_manager.run("delay_hide_tooltip")}.bind(this)):this.label_mouseover=null}function m(a){void 0===a&&(a=this.bezier_drag===this.empty_behavior),a?(this.bezier_drag=this._get_bezier_drag(this.map),this.bezier_mouseover=function(a){x(this).style("stroke-width",String(3)+"px")},this.bezier_mouseout=function(a){x(this).style("stroke-width",String(1)+"px")}):(this.bezier_drag=this.empty_behavior,this.bezier_mouseover=null,this.bezier_mouseout=null)}function n(a){a.on("mousedown.drag",null),a.on("touchstart.drag",null)}function o(a,b){function c(b,c){var d=a.nodes[c],e=a.nodes[b],f=[];return d.connected_segments.forEach(function(d){var g;try{if(g=a.reactions[d.reaction_id].segments[d.segment_id],void 0===g)throw new Error("undefined segment")}catch(h){return void console.warn("Could not find connected segment "+d.segment_id)}if(g.from_node_id==c)g.from_node_id=b;else{if(g.to_node_id!=c)return void console.error("Segment does not connect to dragged node");g.to_node_id=b}e.connected_segments.push(d),f.push(u.clone(d))}),a.delete_node_data([c]),a.sel.selectAll(".node-to-combine").classed("node-to-combine",!1),a.draw_everything(),f}var d=w(),e=null,f=null,g=null,h=null,i=null,j=function(b,c){var d=a.text_labels[b];d.x=d.x+c.x,d.y=d.y+c.y},k=function(a){this.dragging=a}.bind(this);return d.on("start",function(b){if(k(!0),z.event.sourceEvent.stopPropagation(),f={x:0,y:0},-1===x(this).attr("class").indexOf("label")){var c=this.parentNode.__data__,d=c.bigg_id,g=this.parentNode;e=setTimeout(function(){g.parentNode.insertBefore(g,g.parentNode.firstChild)},200),a.sel.selectAll(".metabolite-circle").on("mouseover.combine",function(a){a.bigg_id===d&&a.node_id!==c.node_id&&x(this).style("stroke-width",String(12)+"px").classed("node-to-combine",!0)}).on("mouseout.combine",function(b){b.bigg_id===d&&a.sel.selectAll(".node-to-combine").style("stroke-width",String(2)+"px").classed("node-to-combine",!1)})}}),d.on("drag",function(b){x(this.parentNode).classed("selected")||a.select_selectable(this,b);var c={};-1===x(this).attr("class").indexOf("label")?(c.type="node",c.id=this.parentNode.__data__.node_id):(c.type="label",c.id=this.__data__.text_label_id);var d=a.get_selected_node_ids(),e=a.get_selected_text_label_ids();g=[],i=[],"node"==c.type&&-1===d.indexOf(c.id)?g.push(c.id):"label"===c.type&&-1===e.indexOf(c.id)?i.push(c.id):(g=d,i=e),h=[];var k={x:z.event.dx,y:z.event.dy};f=u.c_plus_c(f,k),g.forEach(function(b){var c=a.nodes[b],d=v.move_node_and_dependents(c,b,a.reactions,a.beziers,k);h=u.unique_concat([h,d.reaction_ids])}),i.forEach(function(a){j(a,k)}),a.draw_these_nodes(g),a.draw_these_reactions(h),a.draw_these_text_labels(i)}),d.on("end",function(){if(k(!1),null===g)return f=null,g=null,i=null,h=null,void(e=null);var d=[];if(a.sel.selectAll(".node-to-combine").each(function(a){d.push(a.node_id)}),1===d.length){var l=d[0],m=this.parentNode.__data__.node_id,n=u.clone(a.nodes[m]),o=c(l,m);b.push(function(){a.nodes[m]=n;var b=a.nodes[l],c=[];o.forEach(function(d){var e=a.reactions[d.reaction_id].segments[d.segment_id];e.from_node_id==l?e.from_node_id=m:e.to_node_id==l?e.to_node_id=m:console.error("Segment does not connect to fixed node"),b.connected_segments=b.connected_segments.filter(function(a){return!(a.reaction_id==d.reaction_id&&a.segment_id==d.segment_id)}),-1==c.indexOf(d.reaction_id)&&c.push(d.reaction_id)}),a.draw_these_nodes([m]),a.draw_these_reactions(c)},function(){c(l,m)})}else{var p=u.clone(f),q=u.clone(g),r=u.clone(i),s=u.clone(h);b.push(function(){q.forEach(function(b){var c=a.nodes[b];v.move_node_and_dependents(c,b,a.reactions,a.beziers,u.c_times_scalar(p,-1))}),r.forEach(function(a){j(a,u.c_times_scalar(p,-1))}),a.draw_these_nodes(q),a.draw_these_reactions(s),a.draw_these_text_labels(r)},function(){q.forEach(function(b){var c=a.nodes[b];v.move_node_and_dependents(c,b,a.reactions,a.beziers,p)}),r.forEach(function(a){j(a,p)}),a.draw_these_nodes(q),a.draw_these_reactions(s),a.draw_these_text_labels(r)})}a.sel.selectAll(".metabolite-circle").on("mouseover.combine",null).on("mouseout.combine",null),clearTimeout(e),f=null,g=null,i=null,h=null,e=null}),d}function p(a){var b=function(b,c,d,e,f){var g=a.reactions[b].segments[c];g[d]=u.c_plus_c(g[d],f),a.beziers[e].x=g[d].x,a.beziers[e].y=g[d].y},c=function(a){a.dragging=!0},d=function(c,d,e){b(c.reaction_id,c.segment_id,c.bezier,c.bezier_id,d),a.draw_these_reactions([c.reaction_id],!1),a.draw_these_beziers([c.bezier_id])},e=function(a){a.dragging=!1},f=function(c,d){b(c.reaction_id,c.segment_id,c.bezier,c.bezier_id,u.c_times_scalar(d,-1)),a.draw_these_reactions([c.reaction_id],!1),a.draw_these_beziers([c.bezier_id])},g=function(c,d){b(c.reaction_id,c.segment_id,c.bezier,c.bezier_id,d),a.draw_these_reactions([c.reaction_id],!1),a.draw_these_beziers([c.bezier_id])};return this._get_generic_drag(c,d,e,f,g,this.map.sel)}function q(a){var b=function(b,c){var d=a.reactions[b];d.label_x=d.label_x+c.x,d.label_y=d.label_y+c.y},c=function(b){a.callback_manager.run("hide_tooltip")},d=function(c,d,e){b(c.reaction_id,d),a.draw_these_reactions([c.reaction_id])},e=function(a){},f=function(c,d){b(c.reaction_id,u.c_times_scalar(d,-1)),a.draw_these_reactions([c.reaction_id])},g=function(c,d){b(c.reaction_id,d),a.draw_these_reactions([c.reaction_id])};return this._get_generic_drag(c,d,e,f,g,this.map.sel)}function r(a){var b=function(b,c){var d=a.nodes[b];d.label_x=d.label_x+c.x,d.label_y=d.label_y+c.y},c=function(b){a.callback_manager.run("hide_tooltip")},d=function(c,d,e){b(c.node_id,d),a.draw_these_nodes([c.node_id])},e=function(a){},f=function(c,d){b(c.node_id,u.c_times_scalar(d,-1)),a.draw_these_nodes([c.node_id])},g=function(c,d){b(c.node_id,d),a.draw_these_nodes([c.node_id])};return this._get_generic_drag(c,d,e,f,g,this.map.sel)}function s(a,b,c,d,e,f){var g,h=w(),i=this.undo_stack,j=f.node();return h.on("start",function(b){this.dragging=!0,z.event.sourceEvent.stopPropagation(),g={x:0,y:0},a(b)}.bind(this)),h.on("drag",function(a){var c={x:z.event.dx,y:z.event.dy},d={x:y(j)[0],y:y(j)[1]};g=u.c_plus_c(g,c),b(a,c,g,d)}.bind(this)),h.on("end",function(a){this.dragging=!1;var b=u.clone(a),f=u.clone(g),h={x:y(j)[0],y:y(j)[1]};i.push(function(){d(b,f,h)},function(){e(b,f,h)}),c(a)}.bind(this)),h}function t(a,b,c,d,e,f,g){var h,i=w(),j=this.undo_stack,k=g.node();return i.on("start",function(b){this.dragging=!0,z.event.sourceEvent.stopPropagation(),h=0,a(b)}.bind(this)),i.on("drag",function(a){var c={x:z.event.dx,y:z.event.dy},d={x:y(k)[0],y:y(k)[1]},e=f(),g=u.angle_for_event(c,d,e);h+=g,b(a,g,h,e)}.bind(this)),i.on("end",function(a){this.dragging=!1;var b=u.clone(a),g=h,i=u.clone(f());j.push(function(){d(b,g,i)},function(){e(b,g,i)}),c(a)}.bind(this)),i}var u=a("./utils"),v=a("./build"),w=a("d3-drag").drag,x=a("d3-selection").select,y=a("d3-selection").mouse,z=a("d3-selection"),A=u.make_class();A.prototype={init:d,toggle_rotation_mode:g,turn_everything_on:e,turn_everything_off:f,toggle_selectable_click:h,toggle_text_label_edit:i,toggle_selectable_drag:j,toggle_label_drag:k,toggle_label_mouseover:l,toggle_bezier_drag:m,turn_off_drag:n,_get_selectable_drag:o,_get_bezier_drag:p,_get_reaction_label_drag:q,_get_node_label_drag:r,_get_generic_drag:s,_get_generic_angular_drag:t},b.exports=A},{"./build":26,"./utils":33,"d3-drag":40,"d3-selection":47}],2:[function(a,b,c){function d(a,b,c,d){this.brush_sel=a.append("g").attr("id","brush-container");var e=this.brush_sel.node(),f=a.select(d).node().nextSibling;e!==f&&e.parentNode.insertBefore(e,f),this.enabled=b,this.map=c}function e(a){void 0===a&&(a=!this.enabled),a?this.setup_selection_brush():this.brush_sel.selectAll("*").remove()}function f(a){a.selectAll("rect").attr("cursor",null)}function g(){var a=this.map,b=this.brush_sel,c=a.sel.selectAll("#nodes,#text-labels"),d=a.canvas.size_and_location(),e=d.width,g=d.height,h=d.x,l=d.y;b.selectAll("*").remove();var m=!1,n=i().extent([[h,l],[h+e,l+g]]).on("start",function(){f(b),a.settings.get_option("hide_secondary_metabolites")&&(a.settings.set_conditional("hide_secondary_metabolites",!1),a.draw_everything(),a.set_status("Showing secondary metabolites. You can hide them again in Settings.",2e3))}).on("brush",function(){var a=k.event.sourceEvent.shiftKey,b=j(this);if(null!==b){var d=a?c.selectAll(".node:not(.selected),.text-label:not(.selected)"):c.selectAll(".node,.text-label");d.classed("selected",function(a){var c=a.x,d=a.y;return b[0][0]<=c&&c<b[1][0]&&b[0][1]<=d&&d<b[1][1]})}}).on("end",function(){f(b);var c=j(this);null===c?m?m=!1:a.select_none():(m=!0,b.call(n.move,null))});b.call(n),f(b)}var h=a("./utils"),i=a("d3-brush").brush,j=a("d3-brush").brushSelection,k=(a("d3-scale").scaleIdentity,a("d3-selection")),l=(a("d3-selection").select,h.make_class());l.prototype={init:d,toggle:e,setup_selection_brush:g},b.exports=l},{"./utils":33,"d3-brush":36,"d3-scale":46,"d3-selection":47}],3:[function(a,b,c){function d(a,b,c,d){var e=a.append("div").attr("id","rxn-input");this.placed_div=s(e,b,{x:240,y:0}),this.placed_div.hide();var f=t(e.node(),{backgroundColor:"#eee"});x(f.input),this.completely=f,e.append("button").attr("class","button input-close-button").text("×").on("mousedown",function(){this.hide_dropdown()}.bind(this)),this.map=b;var g=90;this.direction_arrow=new u(b.sel),this.direction_arrow.set_rotation(g),this.setup_map_callbacks(b),this.zoom_container=c,this.setup_zoom_callbacks(c),this.settings=d,this.toggle(!1),this.target_coords=null}function e(a){a.callback_manager.set("select_metabolite_with_id.input",function(a,b){this.is_active&&(this.reload(a,b,!1),this.show_dropdown(b)),this.hide_target()}.bind(this)),a.callback_manager.set("select_selectable.input",function(a,b,c){this.hide_target(),1==a&&this.is_active&&c?(this.reload(b,c,!1),this.show_dropdown(c)):this.toggle(!1)}.bind(this)),a.callback_manager.set("deselect_nodes",function(){this.direction_arrow.hide(),this.hide_dropdown()}.bind(this)),a.callback_manager.set("before_svg_export",function(){this.direction_arrow.hide(),this.hide_target()}.bind(this))}function f(a){a.callback_manager.set("zoom.input",function(){this.is_active&&this.place_at_selected()}.bind(this))}function g(){return this.placed_div.is_visible()}function h(a){void 0===a?this.is_active=!this.is_active:this.is_active=a,this.is_active?(this.toggle_start_reaction_listener(!0),w.isNull(this.target_coords)?this.reload_at_selected():this.placed_div.place(this.target_coords),this.show_dropdown(),this.map.set_status("Click on the canvas or an existing metabolite"),this.direction_arrow.show()):(this.toggle_start_reaction_listener(!1),this.hide_dropdown(),this.map.set_status(null),this.direction_arrow.hide())}function i(a){this.clear_escape=this.map.key_manager.add_escape_listener(function(){this.hide_dropdown()}.bind(this),!0),this.completely.input.blur(),this.completely.repaint(),this.completely.setText(""),this.completely.input.focus()}function j(){this.clear_escape&&this.clear_escape(),this.clear_escape=null,this.placed_div.hide(),this.completely.input.blur(),this.completely.hideDropDown()}function k(){this.map.deselect_text_labels();var a=this.map.select_single_node();if(null!=a){var b={x:a.x,y:a.y};this.place(b)}}function l(a){this.placed_div.place(a),this.direction_arrow.set_location(a),this.direction_arrow.show()}function m(){this.map.deselect_text_labels();var a=this.map.select_single_node();if(null==a)return!1;var b={x:a.x,y:a.y};return this.reload(a,b,!1),!0}function n(a,b,c){function d(a,b){for(var c in b)if(b[c].bigg_id===a)return!0;return!1}if(!c&&!a)return void console.error("No selected node, and not starting from scratch");if(this.place(b),null===this.map.cobra_model)return void this.completely.setText("Cannot add: No model.");var e="name"===this.settings.get_option("identifiers_on_map"),f=this.settings.get_option("allow_building_duplicate_reactions"),g=[],h=this.map.cobra_model.reactions,i=this.map.cobra_model.metabolites,j=this.map.reactions,k=this.map.has_data_on_reactions,l=(this.map.reaction_data,this.map.reaction_data_styles,a?e?a.name:a.bigg_id:""),m=function(a,b){return a.replace(new RegExp("(^| )("+b.join("|")+")($| )","g"),"$1<b>$2</b>$3")},n={};for(var o in h){var p=h[o],q=p.name,s=e?q:o;if(f||!d(o,j))for(var t in p.metabolites)if(c||t==a.bigg_id){if(o in n)continue;i[t].name;if(k)g.push({reaction_data:p.data,html:"<b>"+s+"</b>: "+p.data_string,matches:[s],id:o}),n[o]=!0;else{var u,x={},y=[];if(e)for(u in p.metabolites){var z=i[u].name;x[z]=p.metabolites[u],y.push(z)}else{x=r.clone(p.metabolites);for(u in p.metabolites)y.push(u)}var A=w.flatten(p.genes.map(function(a){return[a.name,a.bigg_id]})),B=v.build_reaction_string(x,p.reversibility,p.lower_bound,p.upper_bound);g.push({html:"<b>"+s+"</b>	"+m(B,[l]),matches:[s].concat(y).concat(A),id:o}),n[o]=!0}}}var C;C=k?function(a,b){return Math.abs(b.reaction_data)-Math.abs(a.reaction_data)}:function(a,b){return a.html.toLowerCase()<b.html.toLowerCase()?-1:1},g=g.sort(C);var D=this.completely;D.options=g,D.setText("");var E=this.direction_arrow,F=function(d){if(null!==d)if(c)this.map.new_reaction_from_scratch(d,b,E.get_rotation());else{if(!(a.node_id in this.map.nodes))return console.error("Selected node no longer exists"),void this.hide_dropdown();this.map.new_reaction_for_metabolite(d,a.node_id,E.get_rotation())}}.bind(this);D.onEnter=function(a){this.setText(""),this.onChange(""),F(a)}}function o(a){if(void 0===a)this.start_reaction_listener=!this.start_reaction_listener;else{if(this.start_reaction_listener===a)return;this.start_reaction_listener=a}this.start_reaction_listener?(this.map.sel.on("click.start_reaction",function(a){if(!this.direction_arrow.dragging){var b={x:y(a)[0],y:y(a)[1]};this.map.deselect_nodes(),this.map.deselect_text_labels(),this.reload(null,b,!0),this.show_target(this.map,b),this.show_dropdown(b)}}.bind(this,this.map.sel.node())),this.map.sel.classed("start-reaction-cursor",!0)):(this.map.sel.on("click.start_reaction",null),this.map.sel.classed("start-reaction-cursor",!1),this.hide_target())}function p(){this.target_coords&&this.map.sel.selectAll(".start-reaction-target").remove(),this.target_coords=null}function q(a,b){var c=a.sel.selectAll(".start-reaction-target").data([12,5]);c.enter().append("circle").classed("start-reaction-target",!0).attr("r",function(a){return a}).style("stroke-width",4).merge(c).style("visibility","visible").attr("transform","translate("+b.x+","+b.y+")"),this.target_coords=b}var r=a("./utils"),s=a("./PlacedDiv"),t=a("./complete.ly"),u=a("./DirectionArrow"),v=a("./CobraModel"),w=a("underscore"),x=a("d3-selection").select,y=a("d3-selection").mouse,z=r.make_class();z.prototype={init:d,setup_map_callbacks:e,setup_zoom_callbacks:f,is_visible:g,toggle:h,show_dropdown:i,hide_dropdown:j,place_at_selected:k,place:l,reload_at_selected:m,reload:n,toggle_start_reaction_listener:o,hide_target:p,show_target:q},b.exports=z},{"./CobraModel":7,"./DirectionArrow":9,"./PlacedDiv":13,"./complete.ly":27,"./utils":33,"d3-selection":47,underscore:56}],4:[function(a,b,c){function d(a,b,c,d,e){if(d?d instanceof S||(d=R("node"in d?d.node():d)):d=R("body").append("div"),e||(e={}),c||(c=N),this.map_data=a,this.model_data=b,this.embedded_css=c,this.selection=d,this.selection.datum(this),this.selection.__builder__=this,this.options=z.set_options(e,{menu:"all",scroll_behavior:"pan",use_3d_transform:!z.check_browser("safari"),enable_editing:!0,enable_keys:!0,enable_search:!0,fill_screen:!1,zoom_to_element:null,full_screen_button:!1,ignore_bootstrap:!1,starting_reaction:null,never_ask_before_quit:!1,unique_map_id:null,primary_metabolite_radius:20,secondary_metabolite_radius:10,marker_radius:5,gene_font_size:18,hide_secondary_metabolites:!1,show_gene_reaction_rules:!1,hide_all_labels:!1,canvas_size_and_loc:null,reaction_data:null,reaction_styles:["color","size","text"],reaction_compare_style:"log2_fold",reaction_scale:[{type:"min",color:"#c8c8c8",size:12},{type:"median",color:"#9696ff",size:20},{type:"max",color:"#ff0000",size:25}],reaction_no_data_color:"#dcdcdc",reaction_no_data_size:8,gene_data:null,and_method_in_gene_reaction_rule:"mean",metabolite_data:null,metabolite_styles:["color","size","text"],metabolite_compare_style:"log2_fold",metabolite_scale:[{type:"min",color:"#fffaf0",size:20},{type:"median",color:"#f1c470",size:30},{type:"max",color:"#800000",size:40}],metabolite_no_data_color:"#ffffff",metabolite_no_data_size:10,identifiers_on_map:"bigg_id",highlight_missing:!1,allow_building_duplicate_reactions:!1,cofactors:["atp","adp","nad","nadh","nadp","nadph","gtp","gdp","h","coa","ump","h20","ppi"],tooltip_component:P,enable_tooltips:!0,first_load_callback:null},{primary_metabolite_radius:!0,secondary_metabolite_radius:!0,marker_radius:!0,gene_font_size:!0,reaction_no_data_size:!0,metabolite_no_data_size:!0}),z.check_for_parent_tag(this.selection,"svg"))throw new Error("Builder cannot be placed within an svg node becuase UI elements are html-based.");var f=function(a,b){this.options[a]=b}.bind(this),g=function(a){return this.options[a]}.bind(this),h=["hide_secondary_metabolites","show_gene_reaction_rules","hide_all_labels","scroll_behavior","reaction_styles","reaction_compare_style","reaction_scale","reaction_no_data_color","reaction_no_data_size","and_method_in_gene_reaction_rule","metabolite_styles","metabolite_compare_style","metabolite_scale","metabolite_no_data_color","metabolite_no_data_size","identifiers_on_map","highlight_missing","allow_building_duplicate_reactions","enable_tooltips"];this.settings=new I(f,g,h);var i=["reaction_scale","metabolite_scale"];i.forEach(function(a){this.settings.streams[a].onValue(function(b){var c=["min","max"];c.forEach(function(c){var d=b.reduce(function(a,b){return a||b.type===c},!1);d||(b.push({type:c,color:"#ffffff",size:10}),this.settings.set_conditional(a,b))}.bind(this))}.bind(this))}.bind(this)),this.callback_manager=F(),null!==this.options.first_load_callback&&this.callback_manager.set("first_load",this.options.first_load_callback),this.load_model(this.model_data,!1),this.load_map(this.map_data,!1),this._update_data(!0,!0),this.settings.status_bus.onValue(function(a){if("accepted"===a){if(this._update_data(!0,!0,["reaction","metabolite"],!1),null!==this.zoom_container){var b=this.settings.get_option("scroll_behavior");this.zoom_container.set_scroll_behavior(b)}null!==this.map&&(this.map.draw_all_nodes(!1),this.map.draw_all_reactions(!0,!1),this.map.select_none())}}.bind(this)),this.callback_manager.run("first_load",this)}function e(a,b){Q.isUndefined(b)&&(b=!0),Q.isNull(a)?this.cobra_model=null:this.cobra_model=D.from_cobra_json(a),this.map&&(this.map.cobra_model=this.cobra_model,b&&this._update_data(!0,!1),this.settings.get_option("highlight_missing")&&this.map.draw_all_reactions(!1,!1)),this.callback_manager.run("load_model",null,a,b)}function f(a,b){Q.isUndefined(b)&&(b=!0);z.remove_child_nodes(this.selection),this.zoom_container=new B(this.selection,this.options.scroll_behavior,this.options.use_3d_transform,this.options.fill_screen);var c=this.zoom_container.zoomed_sel,d=this.zoom_container.svg;this.map&&this.map.key_manager.toggle(!1),null!==a?this.map=C.from_data(a,d,this.embedded_css,c,this.zoom_container,this.settings,this.cobra_model,this.options.enable_search):this.map=new C(d,this.embedded_css,c,this.zoom_container,this.settings,this.cobra_model,this.options.canvas_size_and_loc,this.options.enable_search),this.zoom_container.callback_manager.set("svg_start",function(){this.map.set_status("Drawing ...")}.bind(this)),this.zoom_container.callback_manager.set("svg_finish",function(){this.map.set_status("")}.bind(this)),b&&this._update_data(!1,!0),this.build_input=new A(this.selection,this.map,this.zoom_container,this.settings),this.text_edit_input=new K(this.selection,this.map,this.zoom_container),this.tooltip_container=new O(this.selection,this.map,this.options.tooltip_component,this.zoom_container),this.brush=new E(c,!1,this.map,".canvas-group"),this.map.canvas.callback_manager.set("resize",function(){this.brush.toggle(!0)}.bind(this)),this._setup_modes(this.map,this.brush,this.zoom_container);var e=this.selection.append("div").attr("class","search-menu-container").append("div").attr("class","search-menu-container-inline"),f=e.append("div"),g=e.append("div"),h=this.selection.append("div");this.search_bar=new H(g,this.map.search_index,this.map),this.search_bar.callback_manager.set("show",function(){this.settings_bar.toggle(!1)}.bind(this));var i=this.selection.append("div");this.settings_bar=new J(i,this.settings,this.map,function(a,b){var c=this.options[a+"_styles"];if(b&&-1==c.indexOf("abs"))c.push("abs");else if(!b){var d=c.indexOf("abs");-1!=d&&(this.options[a+"_styles"]=c.slice(0,d).concat(c.slice(d+1)))}this._update_data(!1,!0,a)}.bind(this)),this.settings_bar.callback_manager.set("show",function(){this.search_bar.toggle(!1)}.bind(this));var j=this._get_keys(this.map,this.zoom_container,this.search_bar,this.settings_bar,this.options.enable_editing,this.options.full_screen_button);if(this.map.key_manager.assigned_keys=j,this.map.key_manager.input_list=[this.build_input,this.search_bar,this.settings_bar,this.text_edit_input],this.map.key_manager.update(),this.map.key_manager.toggle(this.options.enable_keys),"all"===this.options.menu&&(this.options.ignore_bootstrap?console.error("Cannot create the dropdown menus if ignore_bootstrap = true"):this._set_up_menu(f,this.map,this.map.key_manager,j,this.options.enable_editing,this.options.enable_keys,this.options.full_screen_button)),this._set_up_button_panel(h,j,this.options.enable_editing,this.options.enable_keys,this.options.full_screen_button,this.options.menu,this.options.ignore_bootstrap),this.options.zoom_to_element){var k=this.options.zoom_to_element.type,l=this.options.zoom_to_element.id;if("undefined"==typeof k||-1==["reaction","node"].indexOf(k))throw new Error('zoom_to_element type must be "reaction" or "node"');if("undefined"==typeof l)throw new Error("zoom_to_element must include id");"reaction"==k?this.map.zoom_to_reaction(l):"node"==k&&this.map.zoom_to_node(l)}else if(null!==a)this.map.zoom_extent_canvas();else if(null!==this.options.starting_reaction&&null!==this.cobra_model){var m=this.zoom_container.get_size(),n={x:m.width/2,y:m.height/4};this.map.new_reaction_from_scratch(this.options.starting_reaction,n,90),this.map.zoom_extent_nodes()}else this.map.zoom_extent_canvas();this._setup_status(this.selection,this.map);this._setup_quick_jump(this.selection),this.options.enable_editing?this.zoom_mode():this.view_mode(),this.options.enable_editing&&this._setup_confirm_before_exit(),this.map.draw_everything()}function g(a){this.search_bar.toggle(!1),this.build_input.toggle("build"==a),this.build_input.direction_arrow.toggle("build"==a),"all"==this.options.menu&&this.options.enable_editing&&this._toggle_direction_buttons("build"==a),this.brush.toggle("brush"==a),this.zoom_container.toggle_pan_drag("zoom"==a||"view"==a),this.map.canvas.toggle_resize("zoom"==a||"brush"==a),"rotate"==a?(this.map.behavior.toggle_selectable_drag(!1),this.map.behavior.toggle_rotation_mode(!0)):(this.map.behavior.toggle_rotation_mode("rotate"==a),this.map.behavior.toggle_selectable_drag("brush"==a)),this.map.behavior.toggle_selectable_click("build"==a||"brush"==a),this.map.behavior.toggle_label_drag("brush"==a),this.map.behavior.toggle_label_mouseover(!0),this.map.behavior.toggle_text_label_edit("text"==a),this.map.behavior.toggle_bezier_drag("brush"==a),("view"==a||"text"==a)&&this.map.select_none(),"rotate"==a&&this.map.deselect_text_labels(),this.map.draw_everything()}function h(){this.callback_manager.run("view_mode"),this._set_mode("view")}function i(){this.callback_manager.run("build_mode"),this._set_mode("build")}function j(){this.callback_manager.run("brush_mode"),this._set_mode("brush")}function k(){this.callback_manager.run("zoom_mode"),this._set_mode("zoom")}function l(){this.callback_manager.run("rotate_mode"),this._set_mode("rotate")}function m(){this.callback_manager.run("text_mode"),this._set_mode("text")}function n(a){this.options.reaction_data=a,this._update_data(!0,!0,"reaction"),this.map.set_status("")}function o(a,b){b&&this.settings.set_conditional("show_gene_reaction_rules",!1),this.options.gene_data=a,this._update_data(!0,!0,"reaction"),this.map.set_status("")}function p(a){this.options.metabolite_data=a,this._update_data(!0,!0,"metabolite"),this.map.set_status("")}function q(a,b,c,d){function e(a,b,c){var d={};return null!==b&&z.extend(d,b.reactions),null!==c&&z.extend(d,c.reactions,!0),M.import_and_check(a,"gene_data",d)}void 0===c&&(c=["reaction","metabolite"]),void 0===d&&(d=!0);var f,g,h,i=-1!==c.indexOf("metabolite"),j=-1!==c.indexOf("reaction");i&&b&&null!==this.map&&(f=M.import_and_check(this.options.metabolite_data,"metabolite_data"),this.map.apply_metabolite_data_to_map(f),d&&this.map.draw_all_nodes(!1)),j&&(null!==this.options.reaction_data&&b&&null!==this.map?(g=M.import_and_check(this.options.reaction_data,"reaction_data"),this.map.apply_reaction_data_to_map(g),d&&this.map.draw_all_reactions(!1,!1)):null!==this.options.gene_data&&b&&null!==this.map?(h=e(this.options.gene_data,this.cobra_model,this.map),this.map.apply_gene_data_to_map(h),d&&this.map.draw_all_reactions(!1,!1)):b&&null!==this.map&&(this.map.apply_reaction_data_to_map(null),d&&this.map.draw_all_reactions(!1,!1))),this.update_model_timer&&clearTimeout(this.update_model_timer);var k=5;this.update_model_timer=setTimeout(function(){
i&&a&&null!==this.cobra_model&&(f||(f=M.import_and_check(this.options.metabolite_data,"metabolite_data")),this.cobra_model.apply_metabolite_data(f,this.options.metabolite_styles,this.options.metabolite_compare_style)),j&&(null!==this.options.reaction_data&&a&&null!==this.cobra_model?(g||(g=M.import_and_check(this.options.reaction_data,"reaction_data")),this.cobra_model.apply_reaction_data(g,this.options.reaction_styles,this.options.reaction_compare_style)):null!==this.options.gene_data&&a&&null!==this.cobra_model?(h||(h=e(this.options.gene_data,this.cobra_model,this.map)),this.cobra_model.apply_gene_data(h,this.options.reaction_styles,this.options.identifiers_on_map,this.options.reaction_compare_style,this.options.and_method_in_gene_reaction_rule)):a&&null!==this.cobra_model&&this.cobra_model.apply_reaction_data(null,this.options.reaction_styles,this.options.reaction_compare_style)),this.callback_manager.run("update_data",null,a,b,c,d)}.bind(this),k)}function r(a,b,c,d,e,f,g,h){function i(a,b){function c(a){if(!("map_id"in a[0]&&"reactions"in a[1]&&"nodes"in a[1]&&"canvas"in a[1]))throw new Error("Bad map data.")}if(a)return console.warn(a),void this.map.set_status("Error loading map: "+a,2e3);try{c(b),this.load_map(b),this.map.set_status("Loaded map "+b[0].map_name,3e3)}catch(d){console.warn(d),this.map.set_status("Error loading map: "+d,2e3)}}function j(a,b){if(a)return console.warn(a),void this.map.set_status("Error loading model: "+a,2e3);try{this.load_model(b,!0),this.build_input.toggle(!1),"id"in b?this.map.set_status("Loaded model "+b.id,3e3):this.map.set_status("Loaded model (no model id)",3e3)}catch(c){console.warn(c),this.map.set_status("Error loading model: "+c,2e3)}}function k(a,b){return a?(console.warn(a),void this.map.set_status("Could not parse file as JSON or CSV",2e3)):(null!==b&&this.set_gene_data(null),void this.set_reaction_data(b))}function l(a,b){return a?(console.warn(a),void this.map.set_status("Could not parse file as JSON or CSV",2e3)):void this.set_metabolite_data(b)}function m(a,b){return a?(console.warn(a),void this.map.set_status("Could not parse file as JSON or CSV",2e3)):(null!==b&&this.set_reaction_data(null),this.settings.set_conditional("show_gene_reaction_rules",!0),void this.set_gene_data(b))}var n=a.attr("id","menu").append("ul").attr("class","nav nav-pills");G.dropdown_menu(n,"Map").button({key:d.save,text:"Save map JSON",key_text:f?" (Ctrl+S)":null}).button({text:"Load map JSON",key_text:f?" (Ctrl+O)":null,input:{assign:c.assigned_keys.load,key:"fn",fn:i.bind(this),pre_fn:function(){b.set_status("Loading map ...")},failure_fn:function(){b.set_status("")}}}).button({key:d.save_svg,text:"Export as SVG",key_text:f?" (Ctrl+Shift+S)":null}).button({key:d.save_png,text:"Export as PNG",key_text:f?" (Ctrl+Shift+P)":null}).button({key:d.clear_map,text:"Clear map"});var o=G.dropdown_menu(n,"Model").button({text:"Load COBRA model JSON",key_text:f?" (Ctrl+M)":null,input:{assign:c.assigned_keys.load_model,key:"fn",fn:j.bind(this),pre_fn:function(){b.set_status("Loading model ...")},failure_fn:function(){b.set_status("")}}}).button({id:"convert_map",key:d.convert_map,text:"Update names and gene reaction rules using model"}).button({id:"clear_model",key:d.clear_model,text:"Clear model"}),p=function(){o.dropdown.selectAll("li").classed("escher-disabled",function(a){return"clear_model"!=a.id&&"convert_map"!=a.id||null!==this.cobra_model?null:!0}.bind(this))}.bind(this);p(),this.callback_manager.set("load_model",p);var q=G.dropdown_menu(n,"Data").button({input:{assign:c.assigned_keys.load_reaction_data,key:"fn",fn:k.bind(this),accept_csv:!0,pre_fn:function(){b.set_status("Loading reaction data ...")},failure_fn:function(){b.set_status("")}},text:"Load reaction data"}).button({key:d.clear_reaction_data,text:"Clear reaction data"}).divider().button({input:{fn:m.bind(this),accept_csv:!0,pre_fn:function(){b.set_status("Loading gene data ...")},failure_fn:function(){b.set_status("")}},text:"Load gene data"}).button({key:d.clear_gene_data,text:"Clear gene data"}).divider().button({input:{fn:l.bind(this),accept_csv:!0,pre_fn:function(){b.set_status("Loading metabolite data ...")},failure_fn:function(){b.set_status("")}},text:"Load metabolite data"}).button({key:d.clear_metabolite_data,text:"Clear metabolite data"}),r=function(){q.dropdown.selectAll("li").classed("escher-disabled",function(a){return a?"Clear reaction data"==a.text&&null===this.options.reaction_data?!0:"Clear gene data"==a.text&&null===this.options.gene_data?!0:"Clear metabolite data"==a.text&&null===this.options.metabolite_data?!0:null:null}.bind(this))}.bind(this);r(),this.callback_manager.set("update_data",r);var s=G.dropdown_menu(n,"Edit",!0);e?s.button({key:d.zoom_mode,id:"zoom-mode-menu-button",text:"Pan mode",key_text:f?" (Z)":null}).button({key:d.brush_mode,id:"brush-mode-menu-button",text:"Select mode",key_text:f?" (V)":null}).button({key:d.build_mode,id:"build-mode-menu-button",text:"Add reaction mode",key_text:f?" (N)":null}).button({key:d.rotate_mode,id:"rotate-mode-menu-button",text:"Rotate mode",key_text:f?" (R)":null}).button({key:d.text_mode,id:"text-mode-menu-button",text:"Text mode",key_text:f?" (T)":null}).divider().button({key:d["delete"],text:"Delete",key_text:f?" (Del)":null}).button({key:d.undo,text:"Undo",key_text:f?" (Ctrl+Z)":null}).button({key:d.redo,text:"Redo",key_text:f?" (Ctrl+Shift+Z)":null}).button({key:d.toggle_primary,text:"Toggle primary/secondary",key_text:f?" (P)":null}).button({key:d.cycle_primary,text:"Rotate reactant locations",key_text:f?" (C)":null}).button({key:d.select_all,text:"Select all",key_text:f?" (Ctrl+A)":null}).button({key:d.select_none,text:"Select none",key_text:f?" (Ctrl+Shift+A)":null}).button({key:d.invert_selection,text:"Invert selection"}):s.button({key:d.view_mode,id:"view-mode-menu-button",text:"View mode"});var t=G.dropdown_menu(n,"View",!0).button({key:d.zoom_in,text:"Zoom in",key_text:f?" (+)":null}).button({key:d.zoom_out,text:"Zoom out",key_text:f?" (-)":null}).button({key:d.extent_nodes,text:"Zoom to nodes",key_text:f?" (0)":null}).button({key:d.extent_canvas,text:"Zoom to canvas",key_text:f?" (1)":null}).button({key:d.search,text:"Find",key_text:f?" (F)":null});g&&t.button({key:d.full_screen,text:"Full screen",key_text:f?" (2)":null}),e&&(t.button({key:d.toggle_beziers,id:"bezier-button",text:"Show control points",key_text:f?" (B)":null}),b.callback_manager.set("toggle_beziers.button",function(a){n.select("#bezier-button").select(".dropdown-button-text").text((a?"Hide":"Show")+" control points"+(f?" (B)":""))})),t.divider().button({key:d.show_settings,text:"Settings",key_text:f?" (,)":null}),n.append("a").attr("class","help-button").attr("target","#").attr("href","https://escher.readthedocs.org").text("?");var u=function(a){$(this.selection.node()).find("#"+a).button("toggle");var b=["zoom-mode-menu-button","brush-mode-menu-button","build-mode-menu-button","rotate-mode-menu-button","view-mode-menu-button","text-mode-menu-button"];b.forEach(function(b){var c=b.replace("-menu","");this.selection.select("#"+b).select("span").classed("glyphicon",c==a).classed("glyphicon-ok",c==a)}.bind(this))};this.callback_manager.set("zoom_mode",u.bind(this,"zoom-mode-button")),this.callback_manager.set("brush_mode",u.bind(this,"brush-mode-button")),this.callback_manager.set("build_mode",u.bind(this,"build-mode-button")),this.callback_manager.set("rotate_mode",u.bind(this,"rotate-mode-button")),this.callback_manager.set("view_mode",u.bind(this,"view-mode-button")),this.callback_manager.set("text_mode",u.bind(this,"text-mode-button"))}function s(a,b,c,d,e,f,g){var h=a.append("ul").attr("class","nav nav-pills nav-stacked").attr("id","button-panel");if(G.individual_button(h.append("li"),{key:b.zoom_in,text:"+",icon:"glyphicon glyphicon-plus-sign",tooltip:"Zoom in",key_text:d?" (+)":null,ignore_bootstrap:g}),G.individual_button(h.append("li"),{key:b.zoom_out,text:"–",icon:"glyphicon glyphicon-minus-sign",tooltip:"Zoom out",key_text:d?" (-)":null,ignore_bootstrap:g}),G.individual_button(h.append("li"),{key:b.extent_canvas,text:"↔",icon:"glyphicon glyphicon-resize-full",tooltip:"Zoom to canvas",key_text:d?" (1)":null,ignore_bootstrap:g}),e&&G.individual_button(h.append("li"),{key:b.full_screen,text:"▣",icon:"glyphicon glyphicon-fullscreen",tooltip:"Full screen",key_text:d?" (2)":null,ignore_bootstrap:g}),c&&"all"===f){G.radio_button_group(h.append("li")).button({key:b.zoom_mode,id:"zoom-mode-button",text:"Z",icon:"glyphicon glyphicon-move",tooltip:"Pan mode",key_text:d?" (Z)":null,ignore_bootstrap:g}).button({key:b.brush_mode,text:"V",id:"brush-mode-button",icon:"glyphicon glyphicon-hand-up",tooltip:"Select mode",key_text:d?" (V)":null,ignore_bootstrap:g}).button({key:b.build_mode,text:"N",id:"build-mode-button",icon:"glyphicon glyphicon-plus",tooltip:"Add reaction mode",key_text:d?" (N)":null,ignore_bootstrap:g}).button({key:b.rotate_mode,text:"R",id:"rotate-mode-button",icon:"glyphicon glyphicon-repeat",tooltip:"Rotate mode",key_text:d?" (R)":null,ignore_bootstrap:g}).button({key:b.text_mode,text:"T",id:"text-mode-button",icon:"glyphicon glyphicon-font",tooltip:"Text mode",key_text:d?" (T)":null,ignore_bootstrap:g}),this.direction_buttons=h.append("li");G.button_group(this.direction_buttons).button({key:b.direction_arrow_left,text:"←",icon:"glyphicon glyphicon-arrow-left",tooltip:"Direction arrow (←)",ignore_bootstrap:g}).button({key:b.direction_arrow_right,text:"→",icon:"glyphicon glyphicon-arrow-right",tooltip:"Direction arrow (→)",ignore_bootstrap:g}).button({key:b.direction_arrow_up,text:"↑",icon:"glyphicon glyphicon-arrow-up",tooltip:"Direction arrow (↑)",ignore_bootstrap:g}).button({key:b.direction_arrow_down,text:"↓",icon:"glyphicon glyphicon-arrow-down",tooltip:"Direction arrow (↓)",ignore_bootstrap:g})}}function t(a){Q.isUndefined(a)&&(a="block"===!this.direction_buttons.style("display")),this.direction_buttons.style("display",a?"block":"none")}function u(a,b){var c=a.append("div").attr("id","status");return b.callback_manager.set("set_status",function(a){c.html(a)}),c}function v(a){var b=function(a,b,c){if(this.options.enable_editing&&!this.options.never_ask_before_quit&&!confirm("You will lose any unsaved changes.\n\nAre you sure you want to switch maps?"))return void(c&&c(!1));this.map.set_status("Loading map "+a+" ...");var d=z.name_to_url(a,b);T(d,function(a,b){return a?(console.warn("Could not load data: "+a),this.map.set_status("Could not load map",2e3),void(c&&c(!1))):(c&&c(!0),this.load_map(b),void this.map.set_status(""))}.bind(this))}.bind(this);this.quick_jump=L(a,b)}function w(a,b,c){var d={};a.callback_manager.set("start_rotation",function(){d.brush=b.enabled,b.toggle(!1),d.zoom=c.zoom_on,c.toggle_pan_drag(!1),d.selectable_mousedown=null!==a.behavior.selectable_mousedown,a.behavior.toggle_selectable_click(!1),d.label_mouseover=null!==a.behavior.label_mouseover,a.behavior.toggle_label_mouseover(!1)}),a.callback_manager.set("end_rotation",function(){b.toggle(d.brush),c.toggle_pan_drag(d.zoom),a.behavior.toggle_selectable_click(d.selectable_mousedown),a.behavior.toggle_label_mouseover(d.label_mouseover),d={}})}function x(a,b,c,d,e,f){var g={save:{key:"ctrl+s",target:a,fn:a.save},save_svg:{key:"ctrl+shift+s",target:a,fn:a.save_svg},save_png:{key:"ctrl+shift+p",target:a,fn:a.save_png},load:{key:"ctrl+o",fn:null},convert_map:{target:a,fn:a.convert_map},clear_map:{target:a,fn:a.clear_map},load_model:{key:"ctrl+m",fn:null},clear_model:{fn:this.load_model.bind(this,null,!0)},load_reaction_data:{fn:null},clear_reaction_data:{target:this,fn:function(){this.set_reaction_data(null)}},load_metabolite_data:{fn:null},clear_metabolite_data:{target:this,fn:function(){this.set_metabolite_data(null)}},load_gene_data:{fn:null},clear_gene_data:{target:this,fn:function(){this.set_gene_data(null,!0)}},zoom_in_ctrl:{key:"ctrl+=",target:b,fn:b.zoom_in},zoom_in:{key:"=",target:b,fn:b.zoom_in,ignore_with_input:!0},zoom_out_ctrl:{key:"ctrl+-",target:b,fn:b.zoom_out},zoom_out:{key:"-",target:b,fn:b.zoom_out,ignore_with_input:!0},extent_nodes_ctrl:{key:"ctrl+0",target:a,fn:a.zoom_extent_nodes},extent_nodes:{key:"0",target:a,fn:a.zoom_extent_nodes,ignore_with_input:!0},extent_canvas_ctrl:{key:"ctrl+1",target:a,fn:a.zoom_extent_canvas},extent_canvas:{key:"1",target:a,fn:a.zoom_extent_canvas,ignore_with_input:!0},search_ctrl:{key:"ctrl+f",fn:c.toggle.bind(c,!0)},search:{key:"f",fn:c.toggle.bind(c,!0),ignore_with_input:!0},view_mode:{target:this,fn:this.view_mode,ignore_with_input:!0},show_settings_ctrl:{key:"ctrl+,",target:d,fn:d.toggle},show_settings:{key:",",target:d,fn:d.toggle,ignore_with_input:!0}};return f&&z.extend(g,{full_screen_ctrl:{key:"ctrl+2",target:a,fn:a.full_screen},full_screen:{key:"2",target:a,fn:a.full_screen,ignore_with_input:!0}}),e&&z.extend(g,{build_mode:{key:"n",target:this,fn:this.build_mode,ignore_with_input:!0},zoom_mode:{key:"z",target:this,fn:this.zoom_mode,ignore_with_input:!0},brush_mode:{key:"v",target:this,fn:this.brush_mode,ignore_with_input:!0},rotate_mode:{key:"r",target:this,fn:this.rotate_mode,ignore_with_input:!0},text_mode:{key:"t",target:this,fn:this.text_mode,ignore_with_input:!0},toggle_beziers:{key:"b",target:a,fn:a.toggle_beziers,ignore_with_input:!0},delete_ctrl:{key:"ctrl+backspace",target:a,fn:a.delete_selected,ignore_with_input:!0},"delete":{key:"backspace",target:a,fn:a.delete_selected,ignore_with_input:!0},delete_del:{key:"del",target:a,fn:a.delete_selected,ignore_with_input:!0},toggle_primary:{key:"p",target:a,fn:a.toggle_selected_node_primary,ignore_with_input:!0},cycle_primary:{key:"c",target:a,fn:a.cycle_primary_node,ignore_with_input:!0},direction_arrow_right:{key:"right",target:this.build_input.direction_arrow,fn:this.build_input.direction_arrow.right,ignore_with_input:!0},direction_arrow_down:{key:"down",target:this.build_input.direction_arrow,fn:this.build_input.direction_arrow.down,ignore_with_input:!0},direction_arrow_left:{key:"left",target:this.build_input.direction_arrow,fn:this.build_input.direction_arrow.left,ignore_with_input:!0},direction_arrow_up:{key:"up",target:this.build_input.direction_arrow,fn:this.build_input.direction_arrow.up,ignore_with_input:!0},undo:{key:"ctrl+z",target:a.undo_stack,fn:a.undo_stack.undo},redo:{key:"ctrl+shift+z",target:a.undo_stack,fn:a.undo_stack.redo},select_all:{key:"ctrl+a",target:a,fn:a.select_all},select_none:{key:"ctrl+shift+a",target:a,fn:a.select_none},invert_selection:{target:a,fn:a.invert_selection}}),g}function y(){window.onbeforeunload=function(a){return a=a||window.event,this.options.never_ask_before_quit?null:"You will lose any unsaved changes."}.bind(this)}var z=a("./utils"),A=a("./BuildInput"),B=a("./ZoomContainer"),C=a("./Map"),D=a("./CobraModel"),E=a("./Brush"),F=a("./CallbackManager"),G=a("./ui"),H=a("./SearchBar"),I=a("./Settings"),J=a("./SettingsMenu"),K=a("./TextEditInput"),L=a("./QuickJump"),M=a("./data_styles"),N=a("./inline").builder_embed,O=a("./TooltipContainer"),P=a("./Tooltip").DefaultTooltip,Q=a("underscore"),R=a("d3-selection").select,S=a("d3-selection").selection,T=a("d3-request").json,U=z.make_class();U.prototype={init:d,load_map:f,load_model:e,_set_mode:g,view_mode:h,build_mode:i,brush_mode:j,zoom_mode:k,rotate_mode:l,text_mode:m,set_reaction_data:n,set_metabolite_data:p,set_gene_data:o,_update_data:q,_toggle_direction_buttons:t,_set_up_menu:r,_set_up_button_panel:s,_setup_status:u,_setup_quick_jump:v,_setup_modes:w,_get_keys:x,_setup_confirm_before_exit:y},b.exports=U},{"./Brush":2,"./BuildInput":3,"./CallbackManager":5,"./CobraModel":7,"./Map":12,"./QuickJump":14,"./SearchBar":17,"./Settings":19,"./SettingsMenu":20,"./TextEditInput":21,"./Tooltip":22,"./TooltipContainer":23,"./ZoomContainer":25,"./data_styles":28,"./inline":29,"./ui":32,"./utils":33,"d3-request":45,"d3-selection":47,underscore:56}],5:[function(a,b,c){function d(){}function e(a,b){return void 0===this.callbacks&&(this.callbacks={}),void 0===this.callbacks[a]&&(this.callbacks[a]=[]),this.callbacks[a].push(b),this}function f(a){return(void 0===this.callbacks||0==Object.keys(this.callbacks).length)&&console.warn("No callbacks to remove"),delete this.callbacks[a],this}function g(a,b){if(i.isUndefined(this.callbacks))return this;i.isUndefined(b)&&(b=null);var c=Array.prototype.slice.call(arguments,2);for(var d in this.callbacks){var e=d.split(".")[0];e==a&&this.callbacks[d].forEach(function(a){a.apply(b,c)})}return this}var h=a("./utils"),i=a("underscore"),j=h.make_class();j.prototype={init:d,set:e,remove:f,run:g},b.exports=j},{"./utils":33,underscore:56}],6:[function(a,b,c){function d(a,b){this.selection=a,this.x=b.x,this.y=b.y,this.width=b.width,this.height=b.height,this.resize_enabled=!0,this.callback_manager=new i,this.setup()}function e(a){l.isUndefined(a)&&(a=!this.resize_enabled),a?this.selection.selectAll(".drag-rect").style("pointer-events","auto"):this.selection.selectAll(".drag-rect").style("pointer-events","none")}function f(){function a(){k.event.sourceEvent.stopPropagation()}function b(a,b,c){var d=h.d3_transform_catch(c),e=d.translate;return null!==a&&(e[0]=a),null!==b&&(e[1]=b),"translate("+e+")"}function c(a){var c=a.x;a.x=Math.min(a.x+g.width-i/2,k.event.x),g.x=a.x,g.width=g.width+(c-a.x),t.attr("transform",function(a){return b(a.x-i/2,null,t.attr("transform"))}),n.attr("transform",function(a){return b(a.x,null,n.attr("transform"))}).attr("width",g.width*l),o.attr("transform",function(a){return b(a.x,null,o.attr("transform"))}).attr("width",g.width),v.attr("transform",function(a){return b(a.x+i/2,null,v.attr("transform"))}).attr("width",g.width-i),w.attr("transform",function(a){return b(a.x+i/2,null,w.attr("transform"))}).attr("width",g.width-i),g.callback_manager.run("resize")}function d(a){k.event.sourceEvent.stopPropagation();var c=Math.max(a.x+i/2,a.x+g.width+k.event.dx);g.width=c-a.x,u.attr("transform",function(a){return b(c-i/2,null,u.attr("transform"))}),n.attr("width",g.width*l),o.attr("width",g.width),v.attr("width",g.width-i),w.attr("width",g.width-i),g.callback_manager.run("resize")}function e(a){k.event.sourceEvent.stopPropagation();var c=a.y;a.y=Math.min(a.y+g.height-i/2,k.event.y),g.y=a.y,g.height=g.height+(c-a.y),v.attr("transform",function(a){return b(null,a.y-i/2,v.attr("transform"))}),n.attr("transform",function(a){return b(null,a.y,n.attr("transform"))}).attr("width",g.height*l),o.attr("transform",function(a){return b(null,a.y,o.attr("transform"))}).attr("height",g.height),t.attr("transform",function(a){return b(null,a.y+i/2,t.attr("transform"))}).attr("height",g.height-i),u.attr("transform",function(a){return b(null,a.y+i/2,u.attr("transform"))}).attr("height",g.height-i),g.callback_manager.run("resize")}function f(a){k.event.sourceEvent.stopPropagation();var c=Math.max(a.y+i/2,a.y+g.height+k.event.dy);g.height=c-a.y,w.attr("transform",function(a){return b(null,c-i/2,w.attr("transform"))}),n.attr("height",g.height*l),o.attr("height",g.height),t.attr("height",g.height-i),u.attr("height",g.height-i),g.callback_manager.run("resize")}var g=this,i=({x:this.width,y:this.height},100),l=10,m=this.selection.append("g").classed("canvas-group",!0).data([{x:this.x,y:this.y}]),n=m.append("rect").attr("id","mouse-node").attr("width",this.width*l).attr("height",this.height*l).attr("transform","translate("+[g.x-this.width*l/2,g.y-this.height*l/2]+")").attr("pointer-events","all");this.mouse_node=n;var o=m.append("rect").attr("id","canvas").attr("width",this.width).attr("height",this.height).attr("transform","translate("+[g.x,g.y]+")"),p=j().on("start",a).on("drag",d),q=j().on("start",a).on("drag",c),r=j().on("start",a).on("drag",e),s=j().on("start",a).on("drag",f),t=m.append("rect").classed("drag-rect",!0).attr("transform",function(a){return"translate("+[a.x-i/2,a.y+i/2]+")"}).attr("height",this.height-i).attr("id","dragleft").attr("width",i).attr("cursor","ew-resize").classed("resize-rect",!0).call(q),u=m.append("rect").classed("drag-rect",!0).attr("transform",function(a){return"translate("+[a.x+g.width-i/2,a.y+i/2]+")"}).attr("id","dragright").attr("height",this.height-i).attr("width",i).attr("cursor","ew-resize").classed("resize-rect",!0).call(p),v=m.append("rect").classed("drag-rect",!0).attr("transform",function(a){return"translate("+[a.x+i/2,a.y-i/2]+")"}).attr("height",i).attr("id","dragtop").attr("width",this.width-i).attr("cursor","ns-resize").classed("resize-rect",!0).call(r),w=m.append("rect").classed("drag-rect",!0).attr("transform",function(a){return"translate("+[a.x+i/2,a.y+g.height-i/2]+")"}).attr("id","dragbottom").attr("height",i).attr("width",this.width-i).attr("cursor","ns-resize").classed("resize-rect",!0).call(s)}function g(){return{x:this.x,y:this.y,width:this.width,height:this.height}}var h=a("./utils"),i=a("./CallbackManager"),j=a("d3-drag").drag,k=a("d3-selection"),l=a("underscore"),m=h.make_class();m.prototype={init:d,toggle_resize:e,setup:f,size_and_location:g},b.exports=m},{"./CallbackManager":5,"./utils":33,"d3-drag":40,"d3-selection":47,underscore:56}],7:[function(a,b,c){function d(a,b){var c=function(a){return 1==a?"":String(a)+" "},d=[],e=[];for(var f in a){var g=a[f];g>0?e.push(c(g)+f):d.push(c(Math.abs(g))+f)}var h=d.join(" + ");return h+=b?" ↔ ":" → ",h+=e.join(" + ")}function e(a){if(!a.reactions||!a.metabolites)throw new Error("Bad model data.");for(var b={},c=0,d=a.genes.length;d>c;c++){var e=a.genes[c],f=e.id;b[f]=e}var g=new l;g.reactions={};for(var c=0,d=a.reactions.length;d>c;c++){var e=a.reactions[c],f=e.id,h=j.clone(e);if(delete h.id,h.bigg_id=f,h.data_string="",h.genes=[],h.reversibility=h.lower_bound<0&&h.upper_bound>0,h.upper_bound<=0&&h.lower_bound<0)for(var i in h.metabolites)h.metabolites[i]=-h.metabolites[i];if(delete h.lower_bound,delete h.upper_bound,"gene_reaction_rule"in h){var m=k.genes_for_gene_reaction_rule(h.gene_reaction_rule);m.forEach(function(a){if(a in b){var c=j.clone(b[a]);c.bigg_id=c.id,delete c.id,h.genes.push(c)}else console.warn("Could not find gene for gene_id "+a)})}g.reactions[f]=h}g.metabolites={};for(var c=0,d=a.metabolites.length;d>c;c++){var e=a.metabolites[c],f=e.id,n=j.clone(e);delete n.id,n.bigg_id=f,g.metabolites[f]=n}return g}function f(){this.reactions={},this.metabolites={}}function g(a,b,c){k.apply_reaction_data_to_reactions(this.reactions,a,b,c)}function h(a,b,c){k.apply_metabolite_data_to_nodes(this.metabolites,a,b,c)}function i(a,b,c,d,e){k.apply_gene_data_to_reactions(this.reactions,a,b,c,d,e)}var j=a("./utils"),k=a("./data_styles"),l=j.make_class();l.from_cobra_json=e,l.build_reaction_string=d,l.prototype={init:f,apply_reaction_data:g,apply_metabolite_data:h,apply_gene_data:i},b.exports=l},{"./data_styles":28,"./utils":33}],8:[function(a,b,c){var d=a("./utils"),e=a("d3-request").json;b.exports=function(a){function b(a,b,d,e,g){d.node().addEventListener("change",function(){c(a,this.value,g,e)},!1);var h=b[0];f(b,d),c(a,h,g,e)}function c(a,b,c,e){d.load_the_file(a,b,function(a,b){return a?console.warn(a):(g.data=b,void(e&&e(b)))})}function f(a,b){b.selectAll(".menu-option").data(a).enter().append("option").attr("value",function(a){return a}).text(function(a){return a}),b.node().focus()}var g=d.set_options(a,{selection:null,getdatafiles:null,datafiles:null,update_callback:null,target:null});if(null===g.selection)throw new Error("No selection provided for DataMenu");var h=g.selection.select(".data-menu");h.empty()&&(h=g.selection.append("div").attr("class","data-menu"));var i=h.append("form").append("select").attr("class","dropdown-menu");return g.getdatafiles?(g.datafiles&&console.warn("DataMenu: getdatafiles option overrides datafiles"),e(g.getdatafiles,function(a,c){return a?console.warn(a):(b(g.target,c.data,i,g.update_callback,g.selection),null)})):g.datafiles?b(g.target,g.datafiles,i,g.update_callback,g.selection):console.warn("DataMenu: No datafiles given"),{update:f}}},{"./utils":33,"d3-request":45}],9:[function(a,b,c){function d(a){function b(){return"M0 -5 L0 5 L20 5 L20 10 L30 0 L20 -10 L20 -5 Z"}this.arrow_container=a.append("g").attr("id","direction-arrow-container").attr("transform","translate(0,0)rotate(0)"),this.arrow=this.arrow_container.append("path").classed("direction-arrow",!0).attr("d",b()).style("visibility","hidden").attr("transform","translate(30,0)scale(2.5)"),this.sel=a,this.center={x:0,y:0},this._setup_drag(),this.dragging=!1,this.is_visible=!1,this.show()}function e(a){this.center=a;var b=q.d3_transform_catch(this.arrow_container.attr("transform"));this.arrow_container.attr("transform","translate("+a.x+","+a.y+")rotate("+b.rotate+")")}function f(a){var b=q.d3_transform_catch(this.arrow_container.attr("transform"));this.arrow_container.attr("transform","translate("+b.translate+")rotate("+a+")")}function g(a){var b=q.d3_transform_catch(this.arrow_container.attr("transform"));this.arrow_container.attr("transform","translate("+b.translate+")rotate("+(b.rotate+a)+")")}function h(){return q.d3_transform_catch(this.arrow_container.attr("transform")).rotate}function i(a){void 0===a?this.is_visible=!this.is_visible:this.is_visible=a,this.arrow.style("visibility",this.is_visible?"visible":"hidden")}function j(){this.toggle(!0)}function k(){this.toggle(!1)}function l(){this.set_rotation(0)}function m(){this.set_rotation(90)}function n(){this.set_rotation(180)}function o(){this.set_rotation(270)}function p(){var a=r().on("start",function(a){t.event.sourceEvent.stopPropagation(),this.dragging=!0}.bind(this)).on("drag.direction_arrow",function(a){var b={x:t.event.dx,y:t.event.dy},c={x:s(this.sel.node())[0],y:s(this.sel.node())[1]},d=q.angle_for_event(b,c,this.center);this.displace_rotation(q.to_degrees(d))}.bind(this)).on("end",function(a){setTimeout(function(){this.dragging=!1}.bind(this),200)}.bind(this));this.arrow_container.call(a)}var q=a("./utils"),r=a("d3-drag").drag,s=a("d3-selection").mouse,t=a("d3-selection"),u=q.make_class();u.prototype={init:d,set_location:e,set_rotation:f,displace_rotation:g,get_rotation:h,toggle:i,show:j,hide:k,right:l,left:n,up:o,down:m,_setup_drag:p},b.exports=u},{"./utils":33,"d3-drag":40,"d3-selection":47}],10:[function(a,b,c){function d(a,b){this.behavior=a,this.settings=b,this.callback_manager=new v}function e(a){var b=a.append("rect").attr("class","membrane");return this.callback_manager.run("create_membrane",this,a),b}function f(a){a.attr("width",function(a){return a.width}).attr("height",function(a){return a.height}).attr("transform",function(a){return"translate("+a.x+","+a.y+")"}).style("stroke-width",function(a){return 10}).attr("rx",function(a){return 20}).attr("ry",function(a){return 20}),this.callback_manager.run("update_membrane",this,a)}function g(a){var b=a.append("g").attr("id",function(a){return"r"+a.reaction_id}).attr("class","reaction");return this.create_reaction_label(b),this.callback_manager.run("create_reaction",this,a),b}function h(a,b,c,d,e,f){a.select(".reaction-label-group").call(function(a){return this.update_reaction_label(a,f)}.bind(this)),t.draw_a_nested_object(a,".segment-group","segments","segment_id",this.create_segment.bind(this),function(a){return this.update_segment(a,b,c,d,e,f)}.bind(this),function(a){a.remove()}),this.callback_manager.run("update_reaction",this,a)}function i(a,b){var c=a.append("g").attr("class","reaction-label-group");return c.append("text").attr("class","reaction-label label"),c.append("g").attr("class","all-genes-label-group"),this.callback_manager.run("create_reaction_label",this,a),c}function j(a,b){var c=(w(".4g"),this.settings.get_option("identifiers_on_map")),d=this.settings.get_option("reaction_styles"),e=this.settings.get_option("show_gene_reaction_rules"),f=this.settings.get_option("hide_all_labels"),g=this.settings.get_option("gene_font_size"),h=this.behavior.label_mousedown,i=this.behavior.label_mouseover,j=this.behavior.label_mouseout;a.attr("transform",function(a){return"translate("+a.label_x+","+a.label_y+")"}).call(this.behavior.turn_off_drag).call(this.behavior.reaction_label_drag);var k=a.select(".reaction-label").attr("visibility",f?"hidden":"visible");f||k.text(function(a){var e=a[c];return b&&-1!==d.indexOf("text")&&(e+=" "+a.data_string),e}).on("mousedown",h).on("mouseover",function(a){i("reaction_label",a)}).on("mouseout",j);var l=function(a,b){return a+1.5*g*(b+1)},m=a.select(".all-genes-label-group").selectAll(".gene-label-group").data(function(a){var b="gene_string"in a&&null!==a.gene_string&&e&&!f&&-1!==d.indexOf("text"),g="gene_reaction_rule"in a&&null!==a.gene_reaction_rule&&e&&!f;if(b)return console.warn("Showing gene_string. See TODO in source."),a.gene_string;if(g){var h=u.gene_string_for_data(a.gene_reaction_rule,null,a.genes,null,c,null);return h.forEach(function(b,c){b.label_x=a.label_x,b.label_y=l(a.label_y,c)}),h}return[]}),n=m.enter().append("g").attr("class","gene-label-group");n.append("text").attr("class","gene-label").style("font-size",g+"px").on("mousedown",h).on("mouseover",function(a){i("gene_label",a)}).on("mouseout",j);var o=n.merge(m);o.attr("transform",function(a,b){return"translate(0, "+l(0,b)+")"}),o.select("text").text(function(a){return a.text}),m.exit().remove(),this.callback_manager.run("update_reaction_label",this,a)}function k(a){var b=a.append("g").attr("class","segment-group").attr("id",function(a){return"s"+a.segment_id});return b.append("path").attr("class","segment"),b.append("g").attr("class","arrowheads"),b.append("g").attr("class","stoichiometry-labels"),this.callback_manager.run("create_segment",this,a),b}function l(a,b,c,d,e,f){var g=this.settings.get_option("reaction_styles"),h=f&&-1!==g.indexOf("size"),i=f&&-1!==g.indexOf("color"),j=this.settings.get_option("reaction_no_data_size"),k=this.settings.get_option("reaction_no_data_color"),l=this.settings.get_option("highlight_missing"),m=this.settings.get_option("hide_secondary_metabolites"),n=this.settings.get_option("primary_metabolite_radius"),o=this.settings.get_option("secondary_metabolite_radius"),p=function(a,c){var d=20,e=13;return c&&(e=null===a?j:b.reaction_size(a),isNaN(e)&&(e=j),d=2*e),{width:d,height:e}},q=function(a,b,c,d){var e=b||c>0?a.height:0,f=d?n:o;return f+e+10};a.selectAll(".segment").datum(function(){return this.parentNode.__data__}).style("visibility",function(a){var b=d[a.from_node_id],c=d[a.to_node_id];return m&&("metabolite"===c.node_type&&!c.node_is_primary||"metabolite"===b.node_type&&!b.node_is_primary)?"hidden":null}).attr("d",function(a){if(null===a.from_node_id||null===a.to_node_id)return null;var b=d[a.from_node_id],c=d[a.to_node_id],e=a.b1,f=a.b2;if("metabolite"===b.node_type){var g=p(a.data,h),i=q(g,a.reversibility,a.from_node_coefficient,b.node_is_primary),j=null===e?c:e;b=s(i,b,j,"start")}if("metabolite"==c.node_type){var g=p(a.data,h),i=q(g,a.reversibility,a.to_node_coefficient,c.node_is_primary),j=null===f?b:f;c=s(i,j,c,"end")}var k="M"+b.x+","+b.y+" ";return null!==e&&null!==f&&(k+="C"+e.x+","+e.y+" "+f.x+","+f.y+" "),k+=c.x+","+c.y}).style("stroke",function(a){var d=this.parentNode.parentNode.__data__.bigg_id,e=l&&null!==c&&!(d in c.reactions);if(e)return"red";if(i){var f=a.data;return null===f?k:b.reaction_color(f)}return null}).style("stroke-width",function(a){if(h){var c=a.data;return null===c?j:b.reaction_size(c)}return null});var r=a.select(".arrowheads").selectAll(".arrowhead").data(function(a){var b=[],c=d[a.from_node_id],e=a.b1,f=d[a.to_node_id],g=a.b2;if(m&&("metabolite"===f.node_type&&!f.node_is_primary||"metabolite"===c.node_type&&!c.node_is_primary))return b;if("metabolite"===c.node_type&&(a.reversibility||a.from_node_coefficient>0)){var i=p(a.data,h),j=q(i,a.reversibility,a.from_node_coefficient,c.node_is_primary),k=null===e?f:e,l=t.to_degrees(t.get_angle([c,k]))+90,n=s(j,c,k,"start");b.push({data:a.data,x:n.x,y:n.y,size:i,rotation:l,show_arrowhead_flux:a.from_node_coefficient<0===a.reverse_flux||0===a.data})}if("metabolite"===f.node_type&&(a.reversibility||a.to_node_coefficient>0)){var i=p(a.data,h),j=q(i,a.reversibility,a.to_node_coefficient,f.node_is_primary),k=null===g?c:g,l=t.to_degrees(t.get_angle([f,k]))+90,n=s(j,k,f,"end");
b.push({data:a.data,x:n.x,y:n.y,size:i,rotation:l,show_arrowhead_flux:a.to_node_coefficient<0===a.reverse_flux||0===a.data})}if(a.unconnected_segment_with_arrow){var i=p(a.data,h),k=f,l=t.to_degrees(t.get_angle([c,k]))+90;b.push({data:a.data,x:c.x,y:c.y,size:i,rotation:l,show_arrowhead_flux:a.to_node_coefficient<0===a.reverse_flux||0===a.data})}return b});r.enter().append("path").classed("arrowhead",!0).merge(r).attr("d",function(a){return"M"+[-a.size.width/2,0]+" L"+[0,a.size.height]+" L"+[a.size.width/2,0]+" Z"}).attr("transform",function(a){return"translate("+a.x+","+a.y+")rotate("+a.rotation+")"}).style("fill",function(a){if(i){if(a.show_arrowhead_flux){var c=a.data;return null===c?k:b.reaction_color(c)}return"#FFFFFF"}return null}).style("stroke",function(a){if(i){var c=a.data;return null===c?k:b.reaction_color(c)}return null}),r.exit().remove();var u=a.select(".stoichiometry-labels").selectAll(".stoichiometry-label").data(function(a){var b=[],c=d[a.from_node_id],e=a.b1,f=d[a.to_node_id],g=a.b2,i=1.5;if(m&&("metabolite"==f.node_type&&!f.node_is_primary||"metabolite"==c.node_type&&!c.node_is_primary))return b;if("metabolite"===c.node_type&&1!=Math.abs(a.from_node_coefficient)){var j=p(a.data,h),k=i*q(j,!1,0,f.node_is_primary),l=null===e?f:e;l=t.c_plus_c(l,t.rotate_coords(l,.5,c));var n=s(k,c,l,"start");n=t.c_plus_c(n,{x:0,y:7}),b.push({coefficient:Math.abs(a.from_node_coefficient),x:n.x,y:n.y,data:a.data})}if("metabolite"===f.node_type&&1!==Math.abs(a.to_node_coefficient)){var j=p(a.data,h),k=i*q(j,!1,0,f.node_is_primary),l=null===g?c:g;l=t.c_plus_c(l,t.rotate_coords(l,.5,f));var n=s(k,l,f,"end");n=t.c_plus_c(n,{x:0,y:7}),b.push({coefficient:Math.abs(a.to_node_coefficient),x:n.x,y:n.y,data:a.data})}return b});u.enter().append("text").attr("class","stoichiometry-label").attr("text-anchor","middle").merge(u).attr("transform",function(a){return"translate("+a.x+","+a.y+")"}).text(function(a){return a.coefficient}).style("fill",function(a){if(i){var c=a.data;return null===c?k:b.reaction_color(c)}return null}),u.exit().remove(),this.callback_manager.run("update_segment",this,a)}function m(a){var b=a.append("g").attr("id",function(a){return a.bezier_id}).attr("class",function(a){return"bezier"});return b.append("path").attr("class","connect-line"),b.append("circle").attr("class",function(a){return"bezier-circle "+a.bezier}).style("stroke-width",String(1)+"px").attr("r",String(7)+"px"),this.callback_manager.run("create_bezier",this,a),b}function n(a,b,c,d,e,f,g){var h=this.settings.get_option("hide_secondary_metabolites");return b?(a.attr("visibility","visible"),a.style("visibility",function(a){var b=g[a.reaction_id].segments[a.segment_id],c=f[b.from_node_id],d=f[b.to_node_id];return h&&("metabolite"==d.node_type&&!d.node_is_primary||"metabolite"==c.node_type&&!c.node_is_primary)?"hidden":null}),a.select(".bezier-circle").call(this.behavior.turn_off_drag).call(c).on("mouseover",d).on("mouseout",e).attr("transform",function(a){return null==a.x||null==a.y?"":"translate("+a.x+","+a.y+")"}),a.select(".connect-line").attr("d",function(a){var b,c=g[a.reaction_id].segments[a.segment_id];return b="b1"==a.bezier?f[c.from_node_id]:f[c.to_node_id],null==a.x||null==a.y||null==b.x||null==b.y?"":"M"+a.x+", "+a.y+" "+b.x+","+b.y}),void this.callback_manager.run("update_bezier",this,a)):void a.attr("visibility","hidden")}function o(a,b,c){var d=a.append("g").attr("class","node").attr("id",function(a){return"n"+a.node_id});d.append("circle").attr("class",function(a){var b="node-circle";return null!==a.node_type&&(b+=" "+a.node_type+"-circle"),b});var e=d.filter(function(a){return"metabolite"===a.node_type});return e.append("text").attr("class","node-label label"),this.callback_manager.run("create_node",this,a),d}function p(a,b,c,d,e,f,g,h,i){function j(a,b){return"metabolite"===a.node_type&&b&&!a.node_is_primary}var k=this.settings.get_option("hide_secondary_metabolites"),l=this.settings.get_option("primary_metabolite_radius"),m=this.settings.get_option("secondary_metabolite_radius"),n=this.settings.get_option("marker_radius"),o=this.settings.get_option("hide_all_labels"),p=this.settings.get_option("identifiers_on_map"),q=this.settings.get_option("metabolite_styles"),r={color:this.settings.get_option("metabolite_no_data_color"),size:this.settings.get_option("metabolite_no_data_size")},s=this.behavior.label_mousedown,t=this.behavior.label_mouseover,u=this.behavior.label_mouseout,v=(a.select(".node-circle").attr("transform",function(a){return"translate("+a.x+","+a.y+")"}).style("visibility",function(a){return j(a,k)?"hidden":null}).attr("r",function(a){if("metabolite"===a.node_type){var d=c&&-1!==q.indexOf("size");if(d){var e=a.data;return null===e?r.size:b.metabolite_size(e)}return a.node_is_primary?l:m}return n}).style("fill",function(a){if("metabolite"===a.node_type){var d=c&&-1!==q.indexOf("color");if(d){var e=a.data;return null===e?r.color:b.metabolite_color(e)}return null}return null}).call(this.behavior.turn_off_drag).call(h).on("mousedown",d).on("click",e).on("mouseover",f).on("mouseout",g),a.select(".node-label").attr("visibility",o?"hidden":"visible"));o||v.style("visibility",function(a){return j(a,k)?"hidden":null}).attr("transform",function(a){return"translate("+a.label_x+","+a.label_y+")"}).text(function(a){var b=a[p];return c&&-1!==q.indexOf("text")&&(b+=" "+a.data_string),b}).call(this.behavior.turn_off_drag).call(i).on("mousedown",s).on("mouseover",function(a){t("node_label",a)}).on("mouseout",u),this.callback_manager.run("update_node",this,a)}function q(a){var b=a.append("g").attr("id",function(a){return"l"+a.text_label_id}).attr("class","text-label");return b.append("text").attr("class","label"),this.callback_manager.run("create_text_label",this,a),b}function r(a){var b=this.behavior.text_label_mousedown,c=this.behavior.text_label_click,d=this.behavior.selectable_drag,e=this.behavior.turn_off_drag;a.select(".label").text(function(a){return a.text}).attr("transform",function(a){return"translate("+a.x+","+a.y+")"}).on("mousedown",b).on("click",c).call(e).call(d),this.callback_manager.run("update_text_label",this,a)}function s(a,b,c,d){t.check_undefined(arguments,["reaction_arrow_displacement","start","end","displace"]);var e,f,g=a,h=t.distance(b,c);return g&&h||console.error("Bad value"),"start"===d?(e=b.x+g*(c.x-b.x)/h,f=b.y+g*(c.y-b.y)/h):"end"===d?(e=c.x-g*(c.x-b.x)/h,f=c.y-g*(c.y-b.y)/h):console.error("bad displace value: "+d),{x:e,y:f}}var t=a("./utils"),u=a("./data_styles"),v=a("./CallbackManager"),w=a("d3-format").format,x=(a("d3-selection").select,t.make_class());x.prototype={init:d,create_reaction:g,update_reaction:h,create_bezier:m,update_bezier:n,create_node:o,update_node:p,create_text_label:q,update_text_label:r,create_membrane:e,update_membrane:f,create_reaction_label:i,update_reaction_label:j,create_segment:k,update_segment:l},b.exports=x},{"./CallbackManager":5,"./data_styles":28,"./utils":33,"d3-format":43,"d3-selection":47}],11:[function(a,b,c){function d(a,b,c,d){this.assigned_keys=a||{},this.input_list=b||[],this.mousetrap=c?new l(c):new l,this.ctrl_equals_cmd=m.isBoolean(d)?d:!1,this.mousetrap.stopCallback=function(){return!1},this.enabled=!0,this.update()}function e(a,b){if(!b)return a;var c=m.isArray(a)?a:[a],d=c.reduce(function(a,b){var c=b.replace("ctrl+","meta+");return c!==b&&a.push(c),a},c.slice());return d.length===c.length?a:d}function f(){if(this.mousetrap.reset(),this.enabled)for(var a in this.assigned_keys){var b=this.assigned_keys[a];if(b.key){var c=e(b.key,this.ctrl_equals_cmd);b.input_list=this.input_list,this.mousetrap.bind(c,function(a){var b=!1;if(this.ignore_with_input)for(var c=0,d=this.input_list.length;d>c;c++)if(this.input_list[c].is_visible()){b=!0;break}b||(this.fn?this.fn.call(this.target):console.warn("No function for key: "+this.key),a.preventDefault())}.bind(b),"keydown")}}}function g(a){m.isUndefined(a)&&(a=!this.enabled),this.enabled=a,this.update()}function h(a,b){return this.add_key_listener("enter",a,b)}function i(a,b){return this.add_key_listener("escape",a,b)}function j(a,b,c){m.isUndefined(c)&&(c=!1);var d=this.mousetrap.unbind.bind(this.mousetrap,a);return this.mousetrap.bind(e(a,this.ctrl_equals_cmd),function(a){a.preventDefault(),b(),c&&d()}),d}var k=a("./utils"),l=a("mousetrap"),m=a("underscore"),n=k.make_class();n.prototype={init:d,update:f,toggle:g,add_escape_listener:i,add_enter_listener:h,add_key_listener:j},b.exports=n},{"./utils":33,mousetrap:54,underscore:56}],12:[function(a,b,c){function d(a,b,c,d,e,f,g,h,i,j,k){if(null===g){var l=d.get_size();g={x:-l.width,y:-l.height,width:3*l.width,height:3*l.height}}i=Pa.isUndefined(i)||null===i||""===i?"new_map":String(i),j=Pa.isUndefined(j)||null===j||""===j?Ea.generate_map_id():String(j),k=Pa.isUndefined(k)||null===k?"":String(k),this.callback_manager=new Ka,this.svg=a,this.defs=Ea.setup_defs(a,b),this.canvas=new Ma(c,g),this.setup_containers(c),this.sel=c,this.zoom_container=d,this.settings=e,this.cobra_model=f,this.largest_ids={reactions:-1,nodes:-1,segments:-1,text_labels:-1},this.scale=new Ha,this.calc_data_stats("reaction"),this.calc_data_stats("metabolite"),this.scale.connect_to_settings(this.settings,this,D.bind(this)),this.undo_stack=new Ja,this.behavior=new Ga(this,this.undo_stack),this.draw=new Fa(this.behavior,this.settings),this.key_manager=new La,this.key_manager.ctrl_equals_cmd=!0,this.enable_search=h,this.search_index=new Oa,this.map_name=i,this.map_id=j,this.map_description=k;this.beziers_enabled=!1,this.has_data_on_reactions=!1,this.has_data_on_nodes=!1,this.imported_reaction_data=null,this.imported_metabolite_data=null,this.imported_gene_data=null,this.nodes={},this.reactions={},this.beziers={},this.text_labels={},this.apply_reaction_data_to_map(null),this.apply_metabolite_data_to_map(null),this.apply_gene_data_to_map(null),this.rotation_on=!1,this.listen_for_full_screen(function(){setTimeout(function(){this.zoom_extent_canvas()}.bind(this),50)}.bind(this))}function e(a,b,c,d,e,f,g,h){function i(a,b){return Pa.isUndefined(b)&&(b=0),Pa.isUndefined(a)?b:Math.max.apply(null,Object.keys(a).map(function(a){return parseInt(a)}).concat([b]))}var j=a[1].canvas,k=a[0].map_name,l=a[0].map_id,m=a[0].map_description.replace(/(\nLast Modified.*)+$/g,"")+"\nLast Modified "+Date(Date.now()).toString(),n=new Ra(b,c,d,e,f,g,j,h,k,l,m);n.reactions=a[1].reactions,n.nodes=a[1].nodes,n.text_labels=a[1].text_labels;for(var o in n.nodes){var p=n.nodes[o];if(p.connected_segments=[],h){if("metabolite"!==p.node_type)continue;n.search_index.insert("n"+o,{name:p.bigg_id,data:{type:"metabolite",node_id:o}}),n.search_index.insert("n_name"+o,{name:p.name,data:{type:"metabolite",node_id:o}})}}for(var q in n.reactions){var r=n.reactions[q];if(h){n.search_index.insert("r"+q,{name:r.bigg_id,data:{type:"reaction",reaction_id:q}}),n.search_index.insert("r_name"+q,{name:r.name,data:{type:"reaction",reaction_id:q}});for(var s in r.genes){var t=r.genes[s];n.search_index.insert("r"+q+"_g"+s,{name:t.bigg_id,data:{type:"reaction",reaction_id:q}}),n.search_index.insert("r"+q+"_g_name"+s,{name:t.name,data:{type:"reaction",reaction_id:q}})}}var u=[];for(var v in r.segments){var w=r.segments[v];if(w.reversibility=r.reversibility,w.from_node_id in n.nodes&&w.to_node_id in n.nodes){var x=n.nodes[w.from_node_id],y=n.nodes[w.to_node_id];r.metabolites.forEach(function(a){a.bigg_id==x.bigg_id?w.from_node_coefficient=a.coefficient:a.bigg_id==y.bigg_id&&(w.to_node_coefficient=a.coefficient)}),[x,y].forEach(function(a){a.connected_segments.push({segment_id:v,reaction_id:q})});var z=n.nodes[w.from_node_id],A=n.nodes[w.to_node_id];if("metabolite"==z.node_type||"metabolite"==A.node_type){var B=Ea.c_plus_c(z,Ea.c_times_scalar(Ea.c_minus_c(A,z),.5));null===w.b1&&(w.b1=B),null===w.b2&&(w.b2=B)}}else console.warn("Bad node references in segment "+v+". Deleting segment."),u.push(v)}u.forEach(function(a){delete r.segments[a]})}if(h)for(var C in n.text_labels){var D=n.text_labels[C];n.search_index.insert("l"+C,{name:D.text,data:{type:"text_label",text_label_id:C}})}n.beziers=Ia.new_beziers_for_reactions(n.reactions),n.largest_ids.reactions=i(n.reactions),n.largest_ids.nodes=i(n.nodes),n.largest_ids.text_labels=i(n.text_labels);var E=0;for(var F in n.reactions)E=i(n.reactions[F].segments,E);return n.largest_ids.segments=E,n.apply_reaction_data_to_map(null),n.apply_metabolite_data_to_map(null),n.apply_gene_data_to_map(null),n}function f(a){a.append("g").attr("id","reactions"),a.append("g").attr("id","nodes"),a.append("g").attr("id","beziers"),a.append("g").attr("id","text-labels")}function g(){this.sel.select("#reactions").selectAll(".reaction").remove(),this.sel.select("#nodes").selectAll(".node").remove(),this.sel.select("#beziers").selectAll(".bezier").remove(),this.sel.select("#text-labels").selectAll(".text-label").remove()}function h(a,b){this.callback_manager.run("set_status",null,a),clearTimeout(this._status_timer),this._status_timer=null,void 0!==b&&(this._status_timer=setTimeout(function(){this.callback_manager.run("set_status",null,"")}.bind(this),b))}function i(){this.reactions={},this.beziers={},this.nodes={},this.text_labels={},this.map_name="new_map",this.map_id=Ea.generate_map_id(),this.map_description="",this.apply_reaction_data_to_map(null),this.apply_metabolite_data_to_map(null),this.apply_gene_data_to_map(null),this.draw_everything()}function j(){return null!==this.cobra_model}function k(){this.draw_all_reactions(!0,!0),this.draw_all_nodes(!0),this.draw_all_text_labels()}function l(a,b){Pa.isUndefined(a)&&(a=!0),Pa.isUndefined(b)&&(b=!0);var c=[];for(var d in this.reactions)c.push(d);this.draw_these_reactions(c,!1),a&&this.beziers_enabled&&this.draw_all_beziers(),b&&this.clear_deleted_reactions(a)}function m(a,b){Pa.isUndefined(b)&&(b=!0);var c=Ea.object_slice_for_ids_ref(this.reactions,a),d=function(a){return this.draw.update_reaction(a,this.scale,this.cobra_model,this.nodes,this.defs,this.has_data_on_reactions)}.bind(this);if(Ea.draw_an_object(this.sel,"#reactions",".reaction",c,"reaction_id",this.draw.create_reaction.bind(this.draw),d),b){var e=Ia.bezier_ids_for_reaction_ids(c);this.draw_these_beziers(e)}}function n(a){Pa.isUndefined(a)&&(a=!0),Ea.draw_an_object(this.sel,"#reactions",".reaction",this.reactions,"reaction_id",null,function(a){Ea.draw_a_nested_object(a,".segment-group","segments","segment_id",null,null,function(a){a.remove()})},function(a){a.remove()}),a===!0&&this.clear_deleted_beziers()}function o(a){void 0===a&&(a=!0);var b=[];for(var c in this.nodes)b.push(c);this.draw_these_nodes(b),a&&this.clear_deleted_nodes()}function p(a){var b=Ea.object_slice_for_ids_ref(this.nodes,a),c=function(a){return this.draw.create_node(a,this.nodes,this.reactions)}.bind(this),d=function(a){return this.draw.update_node(a,this.scale,this.has_data_on_nodes,this.behavior.selectable_mousedown,this.behavior.selectable_click,this.behavior.node_mouseover,this.behavior.node_mouseout,this.behavior.selectable_drag,this.behavior.node_label_drag)}.bind(this);Ea.draw_an_object(this.sel,"#nodes",".node",b,"node_id",c,d)}function q(){Ea.draw_an_object(this.sel,"#nodes",".node",this.nodes,"node_id",null,null,function(a){a.remove()})}function r(){this.draw_these_text_labels(Object.keys(this.text_labels)),this.clear_deleted_text_labels()}function s(a){var b=Ea.object_slice_for_ids_ref(this.text_labels,a);Ea.draw_an_object(this.sel,"#text-labels",".text-label",b,"text_label_id",this.draw.create_text_label.bind(this.draw),this.draw.update_text_label.bind(this.draw))}function t(){Ea.draw_an_object(this.sel,"#text-labels",".text-label",this.text_labels,"text_label_id",null,null,function(a){a.remove()})}function u(){var a=[];for(var b in this.beziers)a.push(b);this.draw_these_beziers(a),this.clear_deleted_beziers()}function v(a){var b=Ea.object_slice_for_ids_ref(this.beziers,a),c=function(a){return this.draw.update_bezier(a,this.beziers_enabled,this.behavior.bezier_drag,this.behavior.bezier_mouseover,this.behavior.bezier_mouseout,this.nodes,this.reactions)}.bind(this);Ea.draw_an_object(this.sel,"#beziers",".bezier",b,"bezier_id",this.draw.create_bezier.bind(this.draw),c)}function w(){Ea.draw_an_object(this.sel,"#beziers",".bezier",this.beziers,"bezier_id",null,null,function(a){a.remove()})}function x(){this.toggle_beziers(!0)}function y(){this.toggle_beziers(!1)}function z(a){Pa.isUndefined(a)?this.beziers_enabled=!this.beziers_enabled:this.beziers_enabled=a,this.draw_all_beziers(),this.callback_manager.run("toggle_beziers",null,this.beziers_enabled)}function A(a,b){var c=this.settings.get_option("reaction_styles"),d=this.settings.get_option("reaction_compare_style"),e=Na.apply_reaction_data_to_reactions(this.reactions,a,c,d,b);return this.has_data_on_reactions=e,this.imported_reaction_data=e?a:null,this.calc_data_stats("reaction")}function B(a,b){var c=this.settings.get_option("metabolite_styles"),d=this.settings.get_option("metabolite_compare_style"),e=Na.apply_metabolite_data_to_nodes(this.nodes,a,c,d,b);return this.has_data_on_nodes=e,this.imported_metabolite_data=e?a:null,this.calc_data_stats("metabolite")}function C(a,b){var c=this.settings.get_option("reaction_styles"),d=this.settings.get_option("reaction_compare_style"),e=this.settings.get_option("identifiers_on_map"),f=this.settings.get_option("and_method_in_gene_reaction_rule"),g=Na.apply_gene_data_to_reactions(this.reactions,a,c,e,d,f,b);return this.has_data_on_reactions=g,this.imported_gene_data=g?a:null,this.calc_data_stats("reaction")}function D(){return this.data_statistics}function E(a){return function(b){return a.apply(null,b)}}function F(a){if(-1===["reaction","metabolite"].indexOf(a))throw new Error("Bad type "+a);"data_statistics"in this?a in this.data_statistics||(this.data_statistics[a]={}):(this.data_statistics={},this.data_statistics[a]={});var b=!0,c=[];if("metabolite"===a)for(var d in this.nodes){var e=this.nodes[d];Pa.isUndefined(e.data)?console.error("metabolite missing "):null!==e.data&&c.push(e.data)}else if("reaction"==a)for(var f in this.reactions){var g=this.reactions[f];Pa.isUndefined(g.data)?console.error("reaction data missing "):null!==g.data&&c.push(g.data)}var h=Ea.quartiles(c),i=[["min",E(Math.min)],["max",E(Math.max)],["mean",Ea.mean],["Q1",function(){return h[0]}],["median",function(){return h[1]}],["Q3",function(){return h[2]}]];if(i.forEach(function(d){var e,f=d[0];if(0===c.length)e=null;else{var g=d[1];e=g(c)}e!=this.data_statistics[a][f]&&(b=!1),this.data_statistics[a][f]=e}.bind(this)),this.data_statistics[a].min===this.data_statistics[a].max&&null!==this.data_statistics[a].min){var j=this.data_statistics[a].min,k=this.data_statistics[a].max;this.data_statistics[a].min=j-1-.1*Math.abs(j),this.data_statistics[a].max=k+1+.1*Math.abs(k)}return"reaction"===a?this.callback_manager.run("calc_data_stats__reaction",null,!b):this.callback_manager.run("calc_data_stats__metabolite",null,!b),!b}function G(){var a=[];return this.sel.select("#nodes").selectAll(".selected").each(function(b){a.push(b.node_id)}),a}function H(){var a={};return this.sel.select("#nodes").selectAll(".selected").each(function(b){a[b.node_id]=this.nodes[b.node_id]}.bind(this)),a}function I(){var a=[];return this.sel.select("#text-labels").selectAll(".selected").each(function(b){a.push(b.text_label_id)}),a}function J(){var a={};return this.sel.select("#text-labels").selectAll(".selected").each(function(b){a[b.text_label_id]=this.text_labels[b.text_label_id]}.bind(this)),a}function K(){this.sel.selectAll("#nodes,#text-labels").selectAll(".node,.text-label").classed("selected",!0)}function L(){this.sel.selectAll(".selected").classed("selected",!1)}function M(){var a=this.sel.selectAll("#nodes,#text-labels").selectAll(".node,.text-label");a.classed("selected",function(){return!Qa(this).classed("selected")})}function N(a){this.deselect_text_labels();var b,c,d=this.sel.select("#nodes").selectAll(".node");d.classed("selected",function(d){var e=String(d.node_id)==String(a);return e&&(c=d,b={x:d.x,y:d.y}),e}),this.sel.selectAll(".start-reaction-target").style("visibility","hidden"),this.callback_manager.run("select_metabolite_with_id",null,c,b)}function O(a,b,c){c=Pa.isUndefined(c)?!1:c;var d,e=this.sel.selectAll("#nodes,#text-labels").selectAll(".node,.text-label");d=-1==Qa(a).attr("class").indexOf("text-label")?a.parentNode:a,c?Qa(d).classed("selected",!Qa(d).classed("selected")):(e.classed("selected",!1),Qa(d).classed("selected",!0));var f,g,h=this.sel.select("#nodes").selectAll(".selected"),i=0;h.each(function(a){g=a,f={x:a.x,y:a.y},i++}),this.callback_manager.run("select_selectable",null,i,g,f)}function P(){var a=null,b=this.sel.select("#nodes").selectAll(".selected");return b.classed("selected",function(b,c){return 0===c?(a=b,!0):!1}),a}function Q(){var a=this.sel.select("#nodes").selectAll(".node");a.classed("selected",!1),this.callback_manager.run("deselect_nodes")}function R(a,b){this.deselect_nodes();var c=this.sel.select("#text-labels").selectAll(".text-label");c.classed("selected",function(a){return b===a});var d,e=this.sel.select("#text-labels").selectAll(".selected");e.each(function(a){d={x:a.x,y:a.y}}),this.callback_manager.run("select_text_label")}function S(){var a=this.sel.select("#text-labels").selectAll(".text-label");a.classed("selected",!1)}function T(){var a=this.get_selected_nodes(),b=this.get_selected_text_labels();(Object.keys(a).length>=1||Object.keys(b).length>=1)&&this.delete_selectable(a,b,!0)}function U(a,b,c){var d=this.segments_and_reactions_for_nodes(a),e=d.segment_objs_w_segments,f=d.reactions,g=Ea.clone(a),h=Ea.clone(e),i=Ea.clone(f),j=Ea.clone(b),k=function(b,d,e,f){this.delete_node_data(Object.keys(a)),this.delete_segment_data(e),this.delete_reaction_data(Object.keys(d)),this.delete_text_label_data(Object.keys(f));var g=!1,h=!1;this.has_data_on_reactions&&(g=this.calc_data_stats("reaction")),this.has_data_on_nodes&&(h=this.calc_data_stats("metabolite")),c&&(g?this.draw_all_reactions(!0,!0):this.clear_deleted_reactions(),h?this.draw_all_nodes(!0):this.clear_deleted_nodes(),this.clear_deleted_text_labels())}.bind(this);k(a,f,e,b),this.undo_stack.push(function(){this.extend_nodes(g),this.extend_reactions(i);var d=Object.keys(i);for(var k in h){var l=h[k],m=l.segment;this.reactions[l.reaction_id].segments[l.segment_id]=m;var n=[m.from_node_id,m.to_node_id];n.forEach(function(a){if(!(a in g)){var b=this.nodes[a];b.connected_segments.push({reaction_id:l.reaction_id,segment_id:l.segment_id})}}.bind(this));var o=l.segment_id,p=l.reaction_id,q={};q[o]=l.segment,Ea.extend(this.beziers,Ia.new_beziers_for_segments(q,p)),-1===d.indexOf(l.reaction_id)&&d.push(l.reaction_id)}if(this.has_data_on_reactions){var r=this.calc_data_stats("reaction");r?this.draw_all_reactions(!0,!1):this.draw_these_reactions(d)}else c&&this.draw_these_reactions(d);if(this.has_data_on_nodes){var r=this.calc_data_stats("metabolite");c&&(r?this.draw_all_nodes(!1):this.draw_these_nodes(Object.keys(g)))}else c&&this.draw_these_nodes(Object.keys(g));Ea.extend(this.text_labels,j),c&&this.draw_these_text_labels(Object.keys(j)),b=Ea.clone(j),a=Ea.clone(g),e=Ea.clone(h),f=Ea.clone(i)}.bind(this),function(){k(a,f,e,b)}.bind(this))}function V(a){a.forEach(function(a){if(this.enable_search&&"metabolite"==this.nodes[a].node_type){var b=this.search_index.remove("n"+a)&&this.search_index.remove("n_name"+a);b||console.warn("Could not find deleted metabolite in search index")}delete this.nodes[a]}.bind(this))}function W(a){for(var b in a){var c=a[b],d=this.reactions[c.reaction_id];if(!(c.segment_id in d.segments))return;var e=d.segments[c.segment_id];[e.from_node_id,e.to_node_id].forEach(function(a){if(a in this.nodes){var b=this.nodes[a];b.connected_segments=b.connected_segments.filter(function(a){return a.segment_id!=c.segment_id})}}.bind(this)),["b1","b2"].forEach(function(a){var b=Ia.bezier_id_for_segment_id(c.segment_id,a);delete this.beziers[b]}.bind(this)),delete d.segments[c.segment_id]}}function X(a){a.forEach(function(a){var b=this.reactions[a];for(var c in b.segments)["b1","b2"].forEach(function(a){var b=Ia.bezier_id_for_segment_id(c,a);delete this.beziers[b]}.bind(this));delete this.reactions[a];var d=this.search_index.remove("r"+a)&&this.search_index.remove("r_name"+a);d||console.warn("Could not find deleted reaction "+a+" in search index");for(var e in b.genes){var d=this.search_index.remove("r"+a+"_g"+e)&&this.search_index.remove("r"+a+"_g_name"+e);d||console.warn("Could not find deleted gene "+e+" in search index")}}.bind(this))}function Y(a){a.forEach(function(a){delete this.text_labels[a];var b=this.search_index.remove("l"+a);b||console.warn("Could not find deleted text label in search index")}.bind(this))}function Z(a,b){this.extend_nodes(a);var c=[b];if(this.has_data_on_nodes){if(null===this.imported_metabolite_data)throw new Error("imported_metabolite_data should not be null");var d=this.apply_metabolite_data_to_map(this.imported_metabolite_data,c);d?this.draw_all_nodes(!1):this.draw_these_nodes(c)}else this.draw_these_nodes(c)}function $(a,b,c){if(!this.cobra_model)return void console.error("No CobraModel. Cannot build new reaction");var d=Ea.clone(this.cobra_model.reactions[a]);if(0===Pa.size(d.metabolites))throw Error("No metabolites in reaction "+d.bigg_id);var e=Pa.map(d.metabolites,function(a,b){return[a,b]}).filter(function(a){return a[0]<0}).map(function(a){return a[1]}),f=e.length>0?e[0]:Object.keys(d.metabolites)[0],g=this.cobra_model.metabolites[f],h=String(++this.largest_ids.nodes),i=Ia.get_met_label_loc(Math.PI/180*c,0,1,!0,f),j={connected_segments:[],x:b.x,y:b.y,node_is_primary:!0,label_x:b.x+i.x,label_y:b.y+i.y,name:g.name,bigg_id:f,node_type:"metabolite"},k={};k[h]=j,Z.apply(this,[k,h]);var l=Ea.clone(k),m=this.new_reaction_for_metabolite(a,h,c,!1),n=m.redo,o=m.undo;this.undo_stack.push(function(){o(),this.delete_node_data(Object.keys(k)),k=Ea.clone(l),this.clear_deleted_nodes(),this.deselect_nodes()}.bind(this),function(){Z.apply(this,[k,h]),n()}.bind(this))}function _(a){if(this.enable_search)for(var b in a){var c=a[b];"metabolite"==c.node_type&&(this.search_index.insert("n"+b,{name:c.bigg_id,data:{type:"metabolite",node_id:b}}),this.search_index.insert("n_name"+b,{name:c.name,data:{type:"metabolite",node_id:b}}))}Ea.extend(this.nodes,a)}function aa(a){if(this.enable_search)for(var b in a){var c=a[b];this.search_index.insert("r"+b,{name:c.bigg_id,data:{type:"reaction",reaction_id:b}}),this.search_index.insert("r_name"+b,{name:c.name,data:{type:"reaction",reaction_id:b}});for(var d in c.genes){var e=c.genes[d];this.search_index.insert("r"+b+"_g"+d,{name:e.bigg_id,data:{type:"reaction",reaction_id:b}}),this.search_index.insert("r"+b+"_g_name"+d,{name:e.name,data:{type:"reaction",reaction_id:b}})}}Ea.extend(this.reactions,a)}function ba(a,b,c,d){this.extend_reactions(b),Ea.extend(this.beziers,c),this.delete_node_data([d]),this.extend_nodes(a);var e=Object.keys(b);if(this.has_data_on_reactions){var f=!1;if(this.imported_reaction_data)f=this.apply_reaction_data_to_map(this.imported_reaction_data,e);else{if(!this.imported_gene_data)throw new Error("imported_gene_data or imported_reaction_data should not be null");f=this.apply_gene_data_to_map(this.imported_gene_data,e)}f?this.draw_all_reactions(!0,!1):this.draw_these_reactions(e)}else this.draw_these_reactions(e);var g=Object.keys(a);if(this.has_data_on_nodes){if(null===this.imported_metabolite_data)throw new Error("imported_metabolite_data should not be null");var f=this.apply_metabolite_data_to_map(this.imported_metabolite_data,g);f?this.draw_all_nodes(!1):this.draw_these_nodes(g)}else this.draw_these_nodes(g);for(var h in a){var i=a[h];if(i.node_is_primary&&h!=d){this.select_metabolite_with_id(h);var j={x:i.x,y:i.y};this.zoom_container&&this.zoom_container.translate_off_screen(j)}}}function ca(a,b,c,d){void 0===d&&(d=!0);var e=this.nodes[b],f=this.cobra_model.reactions[a],g=Ia.new_reaction(a,f,this.cobra_model.metabolites,b,Ea.clone(e),this.largest_ids,this.settings.get_option("cofactors"),c),h=g.new_nodes,i=g.new_reactions,j=g.new_beziers;ba.apply(this,[h,i,j,b]);var k=Ea.clone(h),l=Ea.clone(i),m=Ea.clone(j),n=function(){if(delete h[b],this.delete_node_data(Object.keys(h)),this.delete_reaction_data(Object.keys(i)),N.apply(this,[b]),h=Ea.clone(k),i=Ea.clone(l),j=Ea.clone(m),this.has_data_on_reactions){var a=this.calc_data_stats("reaction");a?this.draw_all_reactions(!0,!0):this.clear_deleted_reactions(!0)}else this.clear_deleted_reactions(!0);if(this.has_data_on_nodes){var a=this.calc_data_stats("metabolite");a?this.draw_all_nodes(!0):this.clear_deleted_nodes()}else this.clear_deleted_nodes()}.bind(this),o=function(){ba.apply(this,[h,i,j,b])}.bind(this);return d&&this.undo_stack.push(n,o),{undo:n,redo:o}}function da(){var a,b=this.get_selected_nodes(),c=Object.keys(b)[0],d=(b[c],this.reactions),e=this.nodes,f=[];if(e[c].connected_segments.forEach(function(b){a=[b.reaction_id];var e;try{if(e=d[b.reaction_id].segments[b.segment_id],void 0===e)throw new Error("undefined segment")}catch(g){return void console.warn("Could not find connected segment "+b.segment_id)}f.push(e.from_node_id==c?e.to_node_id:e.from_node_id)}),1!=f.length)return void console.error("Only connected nodes with a single reaction can be selected");var g=f[0],h=[c];e[g].connected_segments.forEach(function(a){var b;try{if(b=d[a.reaction_id].segments[a.segment_id],void 0===b)throw new Error("undefined segment")}catch(f){return void console.warn("Could not find connected segment "+a.segment_id)}var i=b.from_node_id==g?b.to_node_id:b.from_node_id,j=e[i];"metabolite"==j.node_type&&i!=c&&h.push(String(i))});for(var i=0;i<h.length;i++)if(e[h[i]].connected_segments.length>1)return void console.error("Only connected nodes with a single reaction can be selected");for(var j in b)if(j!=c&&-1==h.indexOf(j))return void console.warn("Selected nodes are not on the same reaction");var k=[],l=h.length-1,m=e[h[l]],n=m.node_is_primary,o={x:m.x,y:m.y,label_x:m.label_x,label_y:m.label_y};m.connected_segments.length>1&&console.warn("Too many connected segments for node "+m.node_id);var p,q=m.connected_segments[0];try{if(p=d[q.reaction_id].segments[q.segment_id],void 0===p)throw new Error("undefined segment")}catch(r){return void console.error("Could not find connected segment "+q.segment_id)}var s,t={b1:p.b1,b2:p.b2};h.forEach(function(a){var b=e[a],c=b.node_is_primary,f={x:b.x,y:b.y,label_x:b.label_x,label_y:b.label_y},g=b.connected_segments[0],h=d[g.reaction_id].segments[g.segment_id],i={b1:h.b1,b2:h.b2};b.node_is_primary=n,b.x=o.x,b.y=o.y,b.label_x=o.label_x,b.label_y=o.label_y,h.b1=t.b1,h.b2=t.b2,n=c,o=f,t=i,b.node_is_primary&&(s=a),k.push(a)});var u=e[g].connected_segments,l=u.length-1,v=[u[l]];u.forEach(function(a,b){l!=b&&v.push(a)}),e[g].connected_segments=v,this.draw_these_nodes(k),this.draw_these_reactions(a),this.select_metabolite_with_id(s)}function ea(){var a=this.get_selected_node_ids(),b=function(a){var b={},c=this.settings.get_option("hide_secondary_metabolites");if(a.forEach(function(a){if(!(a in this.nodes))return void console.warn("Could not find node: "+a);var c=this.nodes[a];"metabolite"==c.node_type&&(c.node_is_primary=!c.node_is_primary,b[a]=c)}.bind(this)),this.draw_these_nodes(Object.keys(b)),c){var d=this.segments_and_reactions_for_nodes(b),e={};for(var f in d.segment_objs_w_segments){var g=d.segment_objs_w_segments[f].reaction_id;e[g]=!0}this.draw_these_reactions(Object.keys(e))}}.bind(this);b(a),this.undo_stack.push(function(){b(a)},function(){b(a)})}function fa(a){var b={},c={},d={},e=this.reactions;for(var f in a){var g=a[f];g.connected_segments.forEach(function(a){var c;try{if(c=e[a.reaction_id].segments[a.segment_id],void 0===c)throw new Error("undefined segment")}catch(f){return void console.warn("Could not find connected segments for node")}var g=Ea.clone(a);g.segment=Ea.clone(c),b[a.segment_id]=g,a.reaction_id in d||(d[a.reaction_id]=[]),d[a.reaction_id].push(a.segment_id)})}for(var h in d){var i=e[h],j=d[h],k=!0;for(var l in i.segments)-1==j.indexOf(l)&&(k=!1);
k&&(c[h]=i)}return{segment_objs_w_segments:b,reactions:c}}function ga(a,b){this.search_index.insert("l"+a,{name:b,data:{type:"text_label",text_label_id:a}})}function ha(a,b){var c=Ia.new_text_label(this.largest_ids,b,a);return this.text_labels[c.id]=c.label,this.draw_these_text_labels([c.id]),""!==b&&this.add_label_to_search_index(c.id,b),c.id}function ia(a,b,c,d){if(Pa.isUndefined(d)&&(d=!1),""===b)throw new Error("Should not be called for empty string");var e=function(b,c){var e=this.text_labels[a];e.text=b,c&&this.draw_these_text_labels([a]);var f="l"+a,g=this.search_index.remove(f);d||g||console.warn("Could not find modified text label in search index"),this.search_index.insert(f,{name:b,data:{type:"text_label",text_label_id:a}})}.bind(this),f=Ea.clone(this.text_labels[a]);e(b,c),this.undo_stack.push(function(){d?(this.delete_text_label_data([a]),this.clear_deleted_text_labels()):e(f.text,!0)}.bind(this),function(){d?(this.text_labels[a]=Ea.clone(f),this.text_labels[a].text=b,this.draw_these_text_labels([a]),this.add_label_to_search_index(a,b)):e(b,!0)}.bind(this))}function ja(a){this._zoom_extent(a,"nodes")}function ka(a){this._zoom_extent(a,"canvas")}function la(a,b){Pa.isUndefined(a)&&(a="nodes"===b?.2:0),Pa.isUndefined(b)&&(b="canvas");var c,d,e=this.get_size();if(a*=e.height,"nodes"===b){var f={x:null,y:null},g={x:null,y:null};for(var h in this.nodes){var i=this.nodes[h];null===f.x&&(f.x=i.x),null===f.y&&(f.y=i.y),null===g.x&&(g.x=i.x),null===g.y&&(g.y=i.y),f.x=Math.min(f.x,i.x),f.y=Math.min(f.y,i.y),g.x=Math.max(g.x,i.x),g.y=Math.max(g.y,i.y)}c=Math.min((e.width-2*a)/(g.x-f.x),(e.height-2*a)/(g.y-f.y)),d={x:-(f.x*c)+a+(e.width-2*a-(g.x-f.x)*c)/2,y:-(f.y*c)+a+(e.height-2*a-(g.y-f.y)*c)/2}}else{if("canvas"!=b)return console.error("Did not recognize mode");c=Math.min((e.width-2*a)/this.canvas.width,(e.height-2*a)/this.canvas.height),d={x:-(this.canvas.x*c)+a+(e.width-2*a-this.canvas.width*c)/2,y:-(this.canvas.y*c)+a+(e.height-2*a-this.canvas.height*c)/2}}return this.zoom_container.go_to(c,d),null}function ma(){return this.zoom_container.get_size()}function na(a){var b=this.reactions[a],c=.5,d=this.get_size(),e={x:-b.label_x*c+d.width/2,y:-b.label_y*c+d.height/2};this.zoom_container.go_to(c,e)}function oa(a){var b=this.nodes[a],c=.5,d=this.get_size(),e={x:-b.label_x*c+d.width/2,y:-b.label_y*c+d.height/2};this.zoom_container.go_to(c,e)}function pa(a){var b=this.text_labels[a],c=.5,d=this.get_size(),e={x:-b.x*c+d.width/2,y:-b.y*c+d.height/2};this.zoom_container.go_to(c,e)}function qa(a){this.highlight(this.sel.selectAll("#r"+a).selectAll("text"))}function ra(a){this.highlight(this.sel.selectAll("#n"+a).selectAll("text"))}function sa(a){this.highlight(this.sel.selectAll("#l"+a).selectAll("text"))}function ta(a){this.sel.selectAll(".highlight").classed("highlight",!1),null!==a&&a.classed("highlight",!0)}function ua(){return document.fullscreenEnabled?"fullscreenchange":document.mozFullScreenEnabled?"mozfullscreenchange":document.webkitFullscreenEnabled?"webkitfullscreenchange":document.msFullscreenEnabled?"MSFullscreenChange":null}function va(a){document.addEventListener(ua(),a),this.full_screen_listener=a}function wa(){document.removeEventListener(ua(),this.full_screen_listener)}function xa(){var a=this.zoom_container.selection,b=a.node(),c=document,d=c.fullscreenElement||c.mozFullScreenElement||c.webkitFullscreenElement||c.msFullscreenElement;if(d)if(a.classed("full-screen-on",!1),c.exitFullscreen)c.exitFullscreen();else if(c.mozCancelFullScreen)c.mozCancelFullScreen();else if(c.webkitExitFullscreen)c.webkitExitFullscreen();else{if(!c.msExitFullscreen)throw Error("Cannot exit full screen");c.msExitFullscreen()}else if(a.classed("full-screen-on",!0),b.requestFullscreen)b.requestFullscreen();else if(b.mozRequestFullScreen)b.mozRequestFullScreen();else if(b.webkitRequestFullscreen)b.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);else{if(!b.msRequestFullscreen)throw Error("Full screen does not seem to be supported on this system.");b.msRequestFullscreen()}}function ya(){Ea.download_json(this.map_for_export(),this.map_name)}function za(){var a=[{map_name:this.map_name,map_id:this.map_id,map_description:this.map_description,homepage:"https://escher.github.io",schema:"https://escher.github.io/escher/jsonschema/1-0-0#"},{reactions:Ea.clone(this.reactions),nodes:Ea.clone(this.nodes),text_labels:Ea.clone(this.text_labels),canvas:this.canvas.size_and_location()}];for(var b in a[1].reactions){var c=a[1].reactions[b],d={},e=["name","bigg_id","reversibility","label_x","label_y","gene_reaction_rule","genes","metabolites"];e.forEach(function(a){d[a]=c[a]}),d.segments={};for(var f in c.segments){var g=c.segments[f],h={},e=["from_node_id","to_node_id","b1","b2"];e.forEach(function(a){h[a]=g[a]}),d.segments[f]=h}a[1].reactions[b]=d}for(var i in a[1].nodes){var e,j=a[1].nodes[i],k={};e="metabolite"===j.node_type?["node_type","x","y","bigg_id","name","label_x","label_y","node_is_primary"]:["node_type","x","y"],e.forEach(function(a){k[a]=j[a]}),a[1].nodes[i]=k}for(var l in a[1].text_labels){var m=a[1].text_labels[l],n={},e=["x","y","text"];e.forEach(function(a){n[a]=m[a]}),a[1].text_labels[l]=n}var o=a[1].canvas,p={},e=["x","y","width","height"];return e.forEach(function(a){p[a]=o[a]}),a[1].canvas=p,a}function Aa(a,b,c,d){a.callback_manager.run(b);var e=a.zoom_container.window_scale,f=a.zoom_container.window_translate,g=a.canvas.size_and_location(),h={w:a.canvas.mouse_node.attr("width"),h:a.canvas.mouse_node.attr("height"),transform:a.canvas.mouse_node.attr("transform")};a.zoom_container._go_to_svg(1,{x:-g.x,y:-g.y},function(){a.svg.attr("width",g.width),a.svg.attr("height",g.height),a.canvas.mouse_node.attr("width","0px"),a.canvas.mouse_node.attr("height","0px"),a.canvas.mouse_node.attr("transform",null);var b=a.sel.selectAll(".multimarker-circle,.midmarker-circle,#canvas").style("visibility","hidden");"svg"==d?Ea.download_svg("saved_map",a.svg,!0):"png"==d&&Ea.download_png("saved_map",a.svg,!0),a.zoom_container._go_to_svg(e,f,function(){a.svg.attr("width",null),a.svg.attr("height",null),a.canvas.mouse_node.attr("width",h.w),a.canvas.mouse_node.attr("height",h.h),a.canvas.mouse_node.attr("transform",h.transform),b.style("visibility",null),a.callback_manager.run(c)}.bind(a))}.bind(a))}function Ba(){Aa(this,"before_svg_export","after_svg_export","svg")}function Ca(){Aa(this,"before_png_export","after_png_export","png")}function Da(){if(this.callback_manager.run("before_convert_map"),!this.has_cobra_model())throw Error("No COBRA model loaded.");var a,b=this.cobra_model,c={},d=["name","gene_reaction_rule","genes"],e={},f=["name"];for(var g in this.reactions){var h=this.reactions[g];a=!1;for(var i in b.reactions){var j=b.reactions[i];j.bigg_id==h.bigg_id&&(d.forEach(function(a){h[a]=j[a]}),a=!0)}a||(c[g]=!0)}for(var k in this.nodes){var l=this.nodes[k];if("metabolite"==l.node_type){a=!1;for(var m in b.metabolites){var n=b.metabolites[m];n.bigg_id==l.bigg_id&&(f.forEach(function(a){l[a]=n[a]}),a=!0)}a||(e[k]=!0)}}var o=Object.keys(c).length,p=Object.keys(e).length,q=3e3;0===o&&0===p?this.set_status("Successfully converted attributes.",q):0===p?(this.set_status("Converted attributes, but count not find "+o+" reactions in the model.",q),this.settings.set_conditional("highlight_missing",!0)):0===o?(this.set_status("Converted attributes, but count not find "+p+" metabolites in the model.",q),this.settings.set_conditional("highlight_missing",!0)):(this.set_status("Converted attributes, but count not find "+o+" reactions and "+p+" metabolites in the model.",q),this.settings.set_conditional("highlight_missing",!0)),this.draw_everything(),this.callback_manager.run("after_convert_map")}var Ea=a("./utils"),Fa=a("./Draw"),Ga=a("./Behavior"),Ha=a("./Scale"),Ia=a("./build"),Ja=a("./UndoStack"),Ka=a("./CallbackManager"),La=a("./KeyManager"),Ma=a("./Canvas"),Na=a("./data_styles"),Oa=a("./SearchIndex"),Pa=(a("baconjs"),a("underscore")),Qa=a("d3-selection").select,Ra=Ea.make_class();Ra.from_data=e,Ra.prototype={init:d,setup_containers:f,reset_containers:g,set_status:h,clear_map:i,select_all:K,select_none:L,invert_selection:M,select_selectable:O,select_metabolite_with_id:N,select_single_node:P,deselect_nodes:Q,select_text_label:R,deselect_text_labels:S,new_reaction_from_scratch:$,extend_nodes:_,extend_reactions:aa,new_reaction_for_metabolite:ca,cycle_primary_node:da,toggle_selected_node_primary:ea,add_label_to_search_index:ga,new_text_label:ha,edit_text_label:ia,delete_selected:T,delete_selectable:U,delete_node_data:V,delete_segment_data:W,delete_reaction_data:X,delete_text_label_data:Y,get_selected_node_ids:G,get_selected_nodes:H,get_selected_text_label_ids:I,get_selected_text_labels:J,segments_and_reactions_for_nodes:fa,draw_everything:k,draw_all_reactions:l,draw_these_reactions:m,clear_deleted_reactions:n,draw_all_nodes:o,draw_these_nodes:p,clear_deleted_nodes:q,draw_all_text_labels:r,draw_these_text_labels:s,clear_deleted_text_labels:t,draw_all_beziers:u,draw_these_beziers:v,clear_deleted_beziers:w,toggle_beziers:z,hide_beziers:y,show_beziers:x,has_cobra_model:j,apply_reaction_data_to_map:A,apply_metabolite_data_to_map:B,apply_gene_data_to_map:C,get_data_statistics:D,calc_data_stats:F,zoom_extent_nodes:ja,zoom_extent_canvas:ka,_zoom_extent:la,get_size:ma,zoom_to_reaction:na,zoom_to_node:oa,zoom_to_text_label:pa,highlight_reaction:qa,highlight_node:ra,highlight_text_label:sa,highlight:ta,listen_for_full_screen:va,unlisten_for_full_screen:wa,full_screen:xa,save:ya,map_for_export:za,save_svg:Ba,save_png:Ca,convert_map:Da},b.exports=Ra},{"./Behavior":1,"./CallbackManager":5,"./Canvas":6,"./Draw":10,"./KeyManager":11,"./Scale":15,"./SearchIndex":18,"./UndoStack":24,"./build":26,"./data_styles":28,"./utils":33,baconjs:34,"d3-selection":47,underscore:56}],13:[function(a,b,c){function d(a,b,c){this.div=a,this.map=b,this.displacement=void 0===c?{x:0,y:0}:c,this.visible=!0,this.hide()}function e(){return this.visible}function f(a){this.div.style("display",null);var b=this.map.zoom_container.window_translate,c=this.map.zoom_container.window_scale,d=this.map.get_size(),e=Math.max(20,Math.min(d.width-270,c*a.x+b.x-this.displacement.x)),f=Math.max(20,Math.min(d.height-40,c*a.y+b.y-this.displacement.y));this.div.style("position","absolute").style("display","block").style("left",e+"px").style("top",f+"px"),this.visible=!0}function g(){this.visible&&(this.div.style("display","none"),this.visible=!1)}var h=a("./utils"),i=h.make_class();i.prototype={init:d,is_visible:e,place:f,hide:g},b.exports=i},{"./utils":33}],14:[function(a,b,c){function d(a,b){var c=a.append("select").attr("id","quick-jump-menu").attr("class","form-control");this.selector=c;var d=g.parse_url_components(window),e="map_name"in d?d.map_name:null,f="quick_jump_path"in d?d.quick_jump_path:null,h="quick_jump"in d?d.quick_jump:[],i="— Jump to map —",j=[i].concat(h);null!==e&&(j=j.filter(function(a){return a!=e}));var k=function(a){b(a,f,function(b){b?this.replace_state_for_map_name(a):this.reset_selection()}.bind(this))}.bind(this);if(j.length>1){var l=c.selectAll("option").data(j);l.enter().append("option").merge(l).text(function(a){return a.split(".").slice(-1)[0]}),c.on("change",function(){var a=this.options[this.selectedIndex].__data__;k(a)})}else c.style("display","none")}function e(){this.selector.node().selectedIndex=0}function f(a){var b=window.location.href.replace(/(map_name=)([^&]+)(&|$)/,"$1"+a+"$3");window.history.replaceState("Not implemented","",b)}var g=a("./utils"),h=g.make_class();h.prototype={init:d,reset_selection:e,replace_state_for_map_name:f},b.exports=h},{"./utils":33}],15:[function(a,b,c){function d(){this.x=g(),this.y=g(),this.x_size=g(),this.y_size=g(),this.size=g(),this.reaction_color=g().clamp(!0),this.reaction_size=g().clamp(!0),this.metabolite_color=g().clamp(!0),this.metabolite_size=g().clamp(!0),this.scale_path=function(a){var b=this.x,c=this.y,d=h(".2f"),a=a.replace(/(M|L)([0-9-.]+),?\s*([0-9-.]+)/g,function(a,e,f,g){return e+[d(b(parseFloat(f))),d(c(parseFloat(g)))].join(", ")}),e=/C([0-9-.]+),?\s*([0-9-.]+)\s*([0-9-.]+),?\s*([0-9-.]+)\s*([0-9-.]+),?\s*([0-9-.]+)/g;return a=a.replace(e,function(a,e,f,g,h,i,j){return"C"+d(b(parseFloat(e)))+","+d(c(parseFloat(f)))+" "+d(b(parseFloat(g)))+","+d(c(parseFloat(h)))+" "+[d(b(parseFloat(i)))+","+d(c(parseFloat(j)))]})}.bind(this),this.scale_decimals=function(a,b,c){var d=h("."+String(c)+"f");return a=a.replace(/([0-9.]+)/g,function(a,c){return d(b(parseFloat(c)))})}}function e(a,b,c){function d(a,b){var c=a.map(function(a){var c;if(a.type in b)c=b[a.type];else{if("value"!=a.type)throw new Error("Bad domain type "+a.type);c=a.value}return{v:c,color:a.color,size:a.size}}).sort(function(a,b){return a.v-b.v});return{domain:c.map(function(a){return a.v}),color_range:c.map(function(a){return a.color}),size_range:c.map(function(a){return a.size})}}var e=function(a){var b=d(a,c().reaction);this.reaction_color.domain(b.domain),this.reaction_size.domain(b.domain),this.reaction_color.range(b.color_range),this.reaction_size.range(b.size_range)}.bind(this),f=function(a){var b=d(a,c().metabolite);this.metabolite_color.domain(b.domain),this.metabolite_size.domain(b.domain),this.metabolite_color.range(b.color_range),this.metabolite_size.range(b.size_range)}.bind(this);a.streams.reaction_scale.onValue(e),a.streams.metabolite_scale.onValue(f),b.callback_manager.set("calc_data_stats__reaction",function(b){b&&e(a.get_option("reaction_scale"))}),b.callback_manager.set("calc_data_stats__metabolite",function(b){b&&f(a.get_option("metabolite_scale"))})}var f=a("./utils"),g=a("d3-scale").scaleLinear,h=a("d3-format").format,i=f.make_class();i.prototype={init:d,connect_to_settings:e},b.exports=i},{"./utils":33,"d3-format":43,"d3-scale":46}],16:[function(a,b,c){function d(a,b,c,d){var e="grad"+b+this.unique_string;this.w=400,this.h=30,this.x=20,this.input_width=90,this.input_height=24;var f=a.append("div").attr("class","scale-editor");this.data_not_loaded=f.append("div").attr("class","data-not-loaded").text(("reaction"===b?"Reaction and gene":"Metabolite")+" data not loaded"),this.input_label_group=f.append("div").attr("class","input-label-group");var g=f.append("div").style("top",3*this.input_height+56+10+"px").attr("class","no-data");g.append("span").text("Styles for "+b+"s with no data").attr("class","no-data-heading"),this.no_data_container=g.append("div");var h=f.append("div").attr("class","centered");this.add_group=h.append("div"),this.trash_group=h.append("div").attr("class","trash-container");var i=h.append("svg").attr("class","scale-svg");this.input_group=h.append("div").attr("class","input-container"),this.gradient=i.append("defs").append("linearGradient").attr("id",e),i.append("rect").attr("class","rect").attr("fill","url(#"+e+")").attr("width",this.w+"px").attr("height",this.h+"px").attr("x",this.x+"px"),this.pickers_group=i.append("g"),this.type=b,this.settings=c,this.get_data_statistics=d;var j=this.settings.get_option("unique_map_id");this.unique_string=null===j?"":"."+j,this.no_data={};var k=["color","size"];k.forEach(function(a){this.no_data[a]=null,this.settings.streams[this.type+"_no_data_"+a].onValue(function(b){this.no_data[a]=b,this.update_no_data()}.bind(this))}.bind(this)),this.settings.streams[b+"_scale"].onValue(function(a){this.scale=a,this.update()}.bind(this))}function e(){var a=this.scale,b=this.get_data_statistics()[this.type],c=14,d=35,e=this.x,f=this._data_not_loaded();f&&(a=[{type:"min",color:null,size:null},{type:"max",color:null,size:null}],b={min:0,max:1});var g=i().domain([0,this.w]).range([b.min,b.max]),h=i().domain([0,this.w]).range([0,b.max-b.min]),n=function(a,b){this.input_group.selectAll(".input-set").each(function(b){l(this).classed("selected-set",a===b)})}.bind(this),o=function(a){return"value"===a.type?a.value:b[a.type]},p=function(a){this.settings.set_conditional(this.type+"_scale",a),this.scale=a,this.update()}.bind(this),q=a.map(function(a){var c=b.max===b.min?"min"===a.type?0:-1:(o(a)-b.min)/(b.max-b.min);return{frac:c,color:a.color}}).filter(function(a){return a.frac>=0&&a.frac<=1}).sort(function(a,b){return a.frac-b.frac}),r=this.gradient.selectAll("stop").data(q);r.enter().append("stop").merge(r).attr("offset",function(a){return 100*a.frac+"%"}).style("stop-color",function(a){return null===a.color?"#F1ECFA":a.color}),r.exit().remove(),this.data_not_loaded.style("visibility",f?null:"hidden");var s=this.w,t=0,u=a.sort(function(a,b){return o(a)-o(b)}).map(function(a,d){var f,h=o(a),i=c+2;return f="value"===a.type&&h<=b.min?g.invert(b.min)-c/2+e-i:"value"===a.type&&h>=b.max?g.invert(b.max)-c/2+e+i:g.invert(h)-c/2+e,"min"!==a.type&&"max"!==a.type&&(f=Math.min(Math.max(f,t+i),s-2)),t=f,Object.assign({},a,{adjusted_x:f})}.bind(this)),v=this.pickers_group.selectAll(".picker").data(u),w=k().on("start",n).on("drag",function(d,e){-1===["value","min","max"].indexOf(a[e].type)&&(a[e].value=o(d),a[e].type="value");var f=a[e].value+h(m.event.dx),g=h(c+2);f>b.max-g&&(f=b.max-g),f<b.min+g&&(f=b.min+g),f=Math.floor(100*f)/100,a[e].value=f,this.settings.set_conditional(this.type+"_scale",a),this.scale=a,this.update()}.bind(this));v.enter().append("g").attr("class","picker").style("cursor","pointer").append("rect").merge(v).select("rect").attr("x",function(a,b){return a.adjusted_x}).attr("width",c+"px").attr("height",d+"px").call(w),v.exit().remove();var x=this.trash_group.selectAll("span").data(u);x.enter().append("span").merge(x).attr("class",function(a,b){return"min"===a.type||"max"===a.type?null:"trash glyphicon glyphicon-trash"}).style("left",function(a){return a.adjusted_x+"px"}).on("click",function(b,c){"min"!==b.type&&"max"!==b.type&&(a=a.slice(0,c).concat(a.slice(c+1)),this.settings.set_conditional(this.type+"_scale",a),this.scale=a,this.update())}.bind(this)),x.exit().remove();var y=this.add_group.selectAll(".add").data(["add"]);y.enter().append("span").attr("class","add glyphicon glyphicon-plus").merge(y).on("click",function(d){if(!f){for(var e=(b.max+b.min)/2,g=h(c+2),i=0,j=0,k=a.length;k>j;j++){var l=o(a[j]);Math.abs(l-e)<g&&(e+=g,e>b.max-g&&(e=b.max-g),e<b.min+g&&(e=b.min+g)),e>l&&(i=j)}a.push({type:"value",value:e,color:a[i].color,size:a[i].size}),p(a)}}.bind(this)),y.exit().remove();var z=this.input_label_group.selectAll(".row-label").data(["Value:","Color:","Size:"]);z.enter().append("div").attr("class","row-label").style("height",this.input_height+"px").style("line-height",this.input_height+"px").merge(z).style("top",function(a,b){return 56+b*this.input_height+"px"}.bind(this)).text(function(a){return a}),z.exit().remove();var A=this.input_group.selectAll(".input-set").data(u),B=A.enter().append("div").attr("class","input-set");B.append("input").attr("class","domain-input").style("width",this.input_width+"px"),B.append("select").attr("class","domain-type-picker"),B.append("input").attr("class","color-input").style("width",this.input_width+"px"),B.append("input").attr("type","color").style("visibility",function(){return"text"==this.type?"hidden":null}).attr("class","color-picker"),B.append("input").attr("class","size-input").style("width",this.input_width+"px");var C=B.merge(A);C.style("height",3*this.input_height+"px").style("width",this.input_width+"px").style("left",function(a){var b=a.adjusted_x;return b+this.input_width>this.w+this.x&&(b=b-this.input_width+c/2),b+"px"}.bind(this)).on("mousedown",n);var D=j(".4g");C.select(".domain-input").style("height",this.input_height+"px").each(function(a,b){"value"==a.type?(this.value=o(a),this.disabled=!1):(this.value=a.type+" ("+D(o(a))+")",this.disabled=!0)}).on("change",function(b,d){var e=(h(c+2),parseFloat(this.value));a[d].value=e,p(a)});var E=C.select(".domain-type-picker"),F=["value"].concat(Object.keys(b)).filter(function(a){return"min"!==a&&"max"!==a}),G=E.selectAll("option").data(F);G.enter().append("option").merge(G).attr("value",function(a){return a}).text(function(a){return a}),G.exit().remove(),E.style("visibility",function(a){return"min"==a.type||"max"==a.type?"hidden":null}).style("left",this.input_width-20+"px").style("width","20px").each(function(a,b){var c=0;l(this).selectAll("option").each(function(b,d){this.value==a.type&&(c=d)}),this.selectedIndex=c}).on("change",function(c,d){"value"==this.value&&(a[d].value=b[c.type]),a[d].type=this.value,p(a)}),C.select(".color-input").style("height",this.input_height+"px").style("top",this.input_height+"px").each(function(a,b){this.value=null===a.color?"":a.color,this.disabled=null===a.color}).on("change",function(b,c){a[c].color=this.value,p(a)}),C.select(".color-picker").style("left",this.input_width-this.input_height+"px").style("top",this.input_height+"px").style("width",this.input_height+"px").style("height",this.input_height+"px").each(function(a,b){this.value=null===a.color?"#dddddd":a.color,this.disabled=null===a.color}).on("change",function(b,c){a[c].color=this.value,p(a)}),C.select(".size-input").style("height",this.input_height+"px").style("top",2*this.input_height+"px").each(function(a,b){this.value=null===a.size?"":a.size,this.disabled=null===a.size}).on("change",function(b,c){a[c].size=parseFloat(this.value),p(a)}),A.exit().remove()}function f(){var a=this.no_data,b=this._data_not_loaded(),c=40,d=this.no_data_container.selectAll(".input-group").data([["color","Color:"],["size","Size:"]]),e=d.enter().append("div").attr("class","input-group");e.append("span"),e.append("input"),e.append("input").attr("type","color").style("visibility",function(a){return"text"===this.type||"color"!==a[0]?"hidden":null}).attr("class","color-picker");var f=e.merge(d);f.select("span").text(function(a){return a[1]}).style("height",this.input_height+"px").style("line-height",this.input_height+"px").style("left",function(a,b){return(c+this.input_width+10)*b+"px"}.bind(this));(function(a){return this.settings.get_option(this.type+"_no_data_"+a)}).bind(this);f.select("input").style("left",function(a,b){return c+(c+this.input_width+10)*b+"px"}.bind(this)).style("height",this.input_height+"px").style("width",this.input_width+"px").each(function(c){this.value=b?"":a[c[0]],this.disabled=b}).on("change",function(a){var b=m.event.target.value;"size"===a[0]&&(b=parseFloat(b)),this.no_data[a[0]]=b,this.settings.set_conditional(this.type+"_no_data_"+a[0],b),this.update_no_data()}.bind(this)),f.select(".color-picker").style("left",function(a,b){return(c+this.input_width)*(b+1)-this.input_height+"px"}.bind(this)).style("width",this.input_height+"px").style("height",this.input_height+"px").each(function(c,d){this.value=b?"#dddddd":a[c[0]],this.disabled=b}).on("change",function(a,b){var c=m.event.target.value;this.no_data[a[0]]=c,this.settings.set_conditional(this.type+"_no_data_"+a[0],c),this.update_no_data()}.bind(this)),d.exit().remove()}function g(){var a=this.get_data_statistics()[this.type];return null===a.max||null===a.min}var h=a("./utils"),i=(a("baconjs"),a("d3-scale").scaleLinear),j=a("d3-format").format,k=a("d3-drag").drag,l=a("d3-selection").select,m=a("d3-selection"),n=h.make_class();n.prototype={init:d,update:e,update_no_data:f,_data_not_loaded:g},b.exports=n},{"./utils":33,baconjs:34,"d3-drag":40,"d3-format":43,"d3-scale":46,"d3-selection":47}],17:[function(a,b,c){function d(a,b,c){var d=a.attr("class","search-container").style("display","none");this.input=d.append("input").attr("class","search-bar");var f=d.append("div").attr("class","btn-group btn-group-sm");f.append("button").attr("class","btn btn-default").on("click",this.previous.bind(this)).append("span").attr("class","glyphicon glyphicon-chevron-left"),f.append("button").attr("class","btn btn-default").on("click",this.next.bind(this)).append("span").attr("class","glyphicon glyphicon-chevron-right"),this.counter=d.append("div").attr("class","search-counter"),d.append("button").attr("class","btn btn-sm btn-default close-button").on("click",function(){this.toggle(!1)}.bind(this)).append("span").attr("class","glyphicon glyphicon-remove"),this.callback_manager=new l,this.selection=d,this.map=c,this.search_index=b,this.current=1,this.results=null;var g=function(a){this.current=1,this.results=e(this.search_index.find(a.value)),this.update()}.bind(this,this.input.node());this.input.on("input",k.debounce(g,200))}function e(a){return m.uniq(a,function(a){var b=o[a.type];return b[0]+a[b[1]]})}function f(){return"none"!==this.selection.style("display")}function g(a){void 0===a?this.is_active=!this.is_active:this.is_active=a,this.is_active?(this.selection.style("display",null),this.counter.text(""),this.input.node().value="",this.input.node().focus(),this.clear_escape=this.map.key_manager.add_escape_listener(function(){this.toggle(!1)}.bind(this),!0),this.clear_next=this.map.key_manager.add_key_listener(["enter","ctrl+g"],function(){this.next()}.bind(this),!1),this.clear_previous=this.map.key_manager.add_key_listener(["shift+enter","shift+ctrl+g"],function(){this.previous()}.bind(this),!1),this.callback_manager.run("show")):(this.map.highlight(null),this.selection.style("display","none"),this.results=null,this.clear_escape&&this.clear_escape(),this.clear_escape=null,this.clear_next&&this.clear_next(),this.clear_next=null,this.clear_previous&&this.clear_previous(),this.clear_previous=null,this.callback_manager.run("hide"))}function h(){if(null===this.results)this.counter.text(""),this.map.highlight(null);else if(0===this.results.length)this.counter.text("0 / 0"),this.map.highlight(null);else{this.counter.text(this.current+" / "+this.results.length);var a=this.results[this.current-1];if("reaction"==a.type)this.map.zoom_to_reaction(a.reaction_id),this.map.highlight_reaction(a.reaction_id);else if("metabolite"==a.type)this.map.zoom_to_node(a.node_id),this.map.highlight_node(a.node_id);else{if("text_label"!=a.type)throw new Error("Bad search index data type: "+a.type);this.map.zoom_to_text_label(a.text_label_id),this.map.highlight_text_label(a.text_label_id)}}}function i(){null!==this.results&&(this.current===this.results.length?this.current=1:this.current+=1,this.update())}function j(){null!==this.results&&(1===this.current?this.current=this.results.length:this.current-=1,this.update())}var k=a("./utils"),l=a("./CallbackManager"),m=a("underscore"),n=k.make_class();n.prototype={init:d,is_visible:f,toggle:g,update:h,next:i,previous:j},b.exports=n;var o={metabolite:["m","node_id"],reaction:["r","reaction_id"],text_label:["t","text_label_id"]}},{"./CallbackManager":5,"./utils":33,underscore:56}],18:[function(a,b,c){function d(){this.index={}}function e(a,b,c,d){if(!c&&a in this.index)throw new Error("id is already in the index");if(d&&!("name"in b&&"data"in b))throw new Error("malformed record");this.index[a]=b}function f(a){return a in this.index?(delete this.index[a],!0):!1}function g(a){var b=RegExp(a,"i"),c=[];for(var d in this.index){var e=this.index[d];b.exec(e.name)&&c.push(e.data)}return c}var h=a("./utils"),i=h.make_class();i.prototype={init:d,insert:e,remove:f,find:g},b.exports=i},{"./utils":33}],19:[function(a,b,c){function d(a,b,c){this.set_option=a,this.get_option=b,this.status_bus=new m.Bus,this.force_update_bus=new m.Bus,m.Observable.prototype.convert_to_conditional_stream=e,m.Observable.prototype.force_update_with_bus=f,this.busses={},this.streams={};for(var d=0,h=c.length;h>d;d++){var i=c[d],j=g(i,b(i),a,this.status_bus,this.force_update_bus);this.busses[i]=j.bus,this.streams[i]=j.stream}}function e(a){var b=a.map(function(a){return"hold"==a}).not().toProperty(!0),c=a.scan(!1,function(a,b){return 0==a&&("accepted"==b||"rejected"==b)}).not(),d=a.scan(!1,function(a,b){return 0==a&&"hold"==b}).not(),e=m.combineAsArray(this,a),f=e.scan([],function(a,b){if("hold"==b[1])return a.push(b[0]),a;if("accept"==b[1])return a;if("reject"==b[1])return[];if("rejected"==b[1]||"accepted"==b[1])return[b[0]];throw Error("bad status "+b[1])}).filter(b).filter(c).filter(d).flatMap(function(a){return m.fromArray(a)}),g=this.filter(b);return g.merge(f)}function f(a){return m.combineAsArray(this,a.toProperty(!1)).map(function(a){return a[0]})}function g(a,b,c,d,e){var f=new m.Bus,g=f.convert_to_conditional_stream(d).force_update_with_bus(e);return g.onValue(function(b){c(a,b)}),f.push(b),{bus:f,stream:g}}function h(a,b){if(!(a in this.busses))throw new Error("Invalid setting name");this.busses[a].push(b)}function i(){this.status_bus.push("hold")}function j(){this.status_bus.push("reject"),this.status_bus.push("rejected"),this.force_update_bus.push(!0)}function k(){this.status_bus.push("accept"),this.status_bus.push("accepted")}var l=a("./utils"),m=a("baconjs"),n=l.make_class();n.prototype={init:d,set_conditional:h,hold_changes:i,abandon_changes:j,accept_changes:k},b.exports=n},{"./utils":33,baconjs:34}],20:[function(a,b,c){function d(a,b,c,d){this.sel=a,this.settings=b,this.draw=!1;var e=this.settings.get_option("unique_map_id");this.unique_string=null===e?"":"."+e;var f=a.append("div").attr("class","settings-box-background").style("display","none"),g=f.append("div").attr("class","settings-box-container").style("display","none");g.append("button").attr("class","btn btn-sm btn-default settings-button").on("click",function(){this.accept_changes()}.bind(this)).append("span").attr("class","glyphicon glyphicon-ok"),g.append("button").attr("class","btn btn-sm btn-default settings-button settings-button-close").on("click",function(){this.abandon_changes()}.bind(this)).append("span").attr("class","glyphicon glyphicon-remove");var h=g.append("div").attr("class","settings-box");h.append("div").text("Tip: Hover over an option to see more details about it.").classed("settings-tip",!0),h.append("hr"),h.append("div").text("View and build options").attr("class","settings-section-heading-large"),this.view_gui(h.append("div")),h.append("hr"),h.append("div").text("Reactions").attr("class","settings-section-heading-large");var i=new n(h.append("div"),"reaction",this.settings,c.get_data_statistics.bind(c));c.callback_manager.set("calc_data_stats__reaction",function(a){a&&(i.update(),i.update_no_data())}),h.append("div").text("Reaction or Gene data").attr("class","settings-section-heading"),this.style_gui(h.append("div"),"reaction",function(a){d&&(d("reaction",a),i.update(),i.update_no_data())}),h.append("hr"),h.append("div").text("Metabolites").attr("class","settings-section-heading-large");var j=new n(h.append("div"),"metabolite",this.settings,c.get_data_statistics.bind(c));c.callback_manager.set("calc_data_stats__metabolite",function(a){a&&(j.update(),j.update_no_data())}),h.append("div").text("Metabolite data").attr("class","settings-section-heading"),this.style_gui(h.append("div"),"metabolite",function(a){d&&(d("metabolite",a),j.update(),j.update_no_data())}),this.callback_manager=new m,this.map=c,this.selection=g,this.background=f}function e(){return"none"!=this.selection.style("display")}function f(a){void 0===a&&(a=!this.is_visible()),a?(this.hold_changes(),this.selection.style("display","inline-block"),this.background.style("display","block"),this.selection.select("input").node().focus(),this.clear_escape=this.map.key_manager.add_escape_listener(function(){this.abandon_changes()}.bind(this),!0),this.clear_enter=this.map.key_manager.add_enter_listener(function(){this.accept_changes()}.bind(this),!0),this.callback_manager.run("show")):(this.draw&&this.map.draw_everything(),this.selection.style("display","none"),this.background.style("display","none"),this.clear_escape&&this.clear_escape(),this.clear_escape=null,this.clear_enter&&this.clear_enter(),this.clear_enter=null,this.callback_manager.run("hide"))}function g(){this.settings.hold_changes()}function h(){this.draw=!1,this.settings.abandon_changes(),this.toggle(!1)}function i(){this.sel.selectAll("input").each(function(a){this.blur()}),this.draw=!0,this.settings.accept_changes(),this.toggle(!1)}function j(a,b,c){var d=a.append("table").attr("class","settings-table"),e=this.settings;d.append("tr").call(function(a){a.append("td").text("Options:").attr("class","options-label").attr("title","Options for "+b+" data.");
var d=a.append("td"),f=[["Absolute value","abs","If checked, use the absolute value when calculating colors and sizes of "+b+"s on the map"],["Size","size","If checked, then size the "+("metabolite"==b?"radius of metabolite circles ":"thickness of reaction lines ")+"according to the value of the "+b+" data"],["Color","color","If checked, then color the "+("metabolite"==b?"metabolite circles ":"reaction lines ")+"according to the value of the "+b+" data"],["Text (Show data in label)","text","If checked, then show data values in the "+b+" labels"]],g=d.selectAll(".option-group").data(f),h=g.enter().append("label").attr("class","option-group"),i=function(){var a=[];return d.selectAll("input").each(function(b){this.checked&&a.push(b[1])}),a};h.append("input").attr("type","checkbox").on("change",function(a){e.set_conditional(b+"_styles",i()),"abs"==a[1]&&c(this.checked)}).each(function(a){e.streams[b+"_styles"].onValue(function(b){this.checked=-1!=b.indexOf(a[1])}.bind(this))}),h.append("span").text(function(a){return a[0]}).attr("title",function(a){return a[2]})}),d.append("tr").call(function(a){a.append("td").text("Comparison:").attr("class","options-label").attr("title","The function that will be used to compare datasets, when paired data is loaded");var c=a.append("td").attr("title","The function that will be used to compare datasets, when paired data is loaded"),d=[["Fold Change","fold"],["Log2(Fold Change)","log2_fold"],["Difference","diff"]],f=c.selectAll(".option-group").data(d),g=f.enter().append("label").attr("class","option-group");g.append("input").attr("type","radio").attr("name",b+"_compare_style"+this.unique_string).attr("value",function(a){return a[1]}).on("change",function(){this.checked&&e.set_conditional(b+"_compare_style",this.value)}).each(function(){e.streams[b+"_compare_style"].onValue(function(a){this.checked=this.value==a}.bind(this))}),g.append("span").text(function(a){return a[0]})}.bind(this)),"reaction"===b&&a.append("table").attr("class","settings-table").attr("title","The function that will be used to evaluate AND connections in gene reaction rules (AND connections generally connect components of an enzyme complex)").append("tr").call(function(a){a.append("td").text("Method for evaluating AND:").attr("class","options-label-wide");var b=a.append("td"),c=[["Mean","mean"],["Min","min"]],d=b.selectAll(".option-group").data(c),f=d.enter().append("label").attr("class","option-group"),g="and_method_in_gene_reaction_rule";f.append("input").attr("type","radio").attr("name",g+this.unique_string).attr("value",function(a){return a[1]}).on("change",function(){this.checked&&e.set_conditional(g,this.value)}).each(function(){e.streams[g].onValue(function(a){this.checked=this.value==a}.bind(this))}),f.append("span").text(function(a){return a[0]})}.bind(this))}function k(a,b,c,d){var e=this.settings,f=a.append("table").attr("class","settings-table");f.append("tr").call(function(a){a.attr("title","The identifiers that are show in the reaction, gene, and metabolite labels on the map."),a.append("td").text("Identifiers:").attr("class","options-label");var b=a.append("td"),c=[["ID's","bigg_id"],["Descriptive names","name"]],d=b.selectAll(".option-group").data(c),f=d.enter().append("label").attr("class","option-group"),g="identifiers_on_map";f.append("input").attr("type","radio").attr("name",g+this.unique_string).attr("value",function(a){return a[1]}).on("change",function(){this.checked&&e.set_conditional(g,this.value)}).each(function(){e.streams[g].onValue(function(a){this.checked=this.value==a}.bind(this))}),f.append("span").text(function(a){return a[0]})}.bind(this));var g=[["scroll_behavior","Scroll to zoom (instead of scroll to pan)","If checked, then the scroll wheel and trackpad will control zoom rather than pan.",{zoom:!0,pan:!1}],["hide_secondary_metabolites","Hide secondary metabolites","If checked, then only the primary metabolites will be displayed."],["show_gene_reaction_rules","Show gene reaction rules","If checked, then gene reaction rules will be displayed below each reaction label. (Gene reaction rules are always shown when gene data is loaded.)"],["hide_all_labels","Hide reaction, gene, and metabolite labels","If checked, hide all reaction, gene, and metabolite labels"],["allow_building_duplicate_reactions","Allow duplicate reactions","If checked, then allow duplicate reactions during model building."],["highlight_missing","Highlight reactions not in model","If checked, then highlight in red all the reactions on the map that are not present in the loaded model."],["enable_tooltips","Show tooltips","Show tooltips when hovering over reactions, metabolites, and genes"]],h=a.append("div").attr("class","settings-container").selectAll(".option-group").data(g),i=h.enter().append("label").attr("class","option-group full-line");i.append("input").attr("type","checkbox"),i.append("span");var j=i.merge(h);j.attr("title",function(a){return a[2]}),j.select("input").on("change",function(a){if(a.length>=4){for(var b in a[3])if(a[3][b]==this.checked){e.set_conditional(a[0],b);break}}else e.set_conditional(a[0],this.checked)}).each(function(a){e.streams[a[0]].onValue(function(b){a.length>=4?this.checked=a[3][b]:this.checked=b}.bind(this))}),j.select("span").text(function(a){return a[1]}),h.exit().remove(),a.append("div").style("margin-top","16px").classed("settings-tip",!0).text("Tip: To increase map performance, turn off text boxes (i.e. labels and gene reaction rules).")}var l=a("./utils"),m=a("./CallbackManager"),n=a("./ScaleEditor"),o=l.make_class();o.prototype={init:d,is_visible:e,toggle:f,hold_changes:g,abandon_changes:h,accept_changes:i,style_gui:j,view_gui:k},b.exports=o},{"./CallbackManager":5,"./ScaleEditor":16,"./utils":33}],21:[function(a,b,c){function d(a,b,c){var d=a.append("div").attr("id","text-edit-input");this.placed_div=m(d,b),this.placed_div.hide(),this.input=d.append("input"),this.map=b,this.setup_map_callbacks(b),this.zoom_container=c,this.setup_zoom_callbacks(c),this.is_new=!1}function e(a){a.callback_manager.set("edit_text_label.text_edit_input",function(a,b){this.show(a,b)}.bind(this)),a.callback_manager.set("new_text_label.text_edit_input",function(a){null!==this.active_target&&this._accept_changes(this.active_target.target),this.hide(),this._add_and_edit(a)}.bind(this)),a.callback_manager.set("hide_text_label_editor.text_edit_input",function(){this.hide()}.bind(this))}function f(a){a.callback_manager.set("zoom.text_edit_input",function(){this.active_target&&this._accept_changes(this.active_target.target),this.hide()}.bind(this)),a.callback_manager.set("go_to.text_edit_input",function(){this.active_target&&this._accept_changes(this.active_target.target),this.hide()}.bind(this))}function g(){return this.placed_div.is_visible()}function h(a,b){this.active_target&&this._accept_changes(this.active_target.target),this.active_target={target:a,coords:b},a.each(function(a){this.input.node().value=a.text}.bind(this)),this.placed_div.place(b),this.input.node().focus(),this.clear_escape=this.map.key_manager.add_escape_listener(function(){this._accept_changes(a),this.hide()}.bind(this),!0),this.clear_enter=this.map.key_manager.add_enter_listener(function(a){this._accept_changes(a),this.hide()}.bind(this,a),!0)}function i(){this.is_new=!1,this.placed_div.hide(),this.input.attr("value",""),this.active_target=null,this.clear_escape&&this.clear_escape(),this.clear_escape=null,this.clear_enter&&this.clear_enter(),this.clear_enter=null}function j(a){if(""===this.input.node().value)a.each(function(a){var b={};b[a.text_label_id]=this.map.text_labels[a.text_label_id],this.map.delete_selectable({},b,!0)}.bind(this));else{var b=[];a.each(function(a){this.map.edit_text_label(a.text_label_id,this.input.node().value,!0,this.is_new),b.push(a.text_label_id)}.bind(this))}}function k(a){this.is_new=!0;var b=this.map.new_text_label(a,""),c=this.map.sel.select("#text-labels").selectAll(".text-label").filter(function(a){return a.text_label_id===b});c.select("text").classed("edit-text-cursor",!0),this.show(c,a)}var l=a("./utils"),m=a("./PlacedDiv"),n=(a("./build"),l.make_class());n.prototype={init:d,setup_map_callbacks:e,setup_zoom_callbacks:f,is_visible:g,show:h,hide:i,_accept_changes:j,_add_and_edit:k},b.exports=n},{"./PlacedDiv":13,"./build":26,"./utils":33}],22:[function(a,b,c){function d(a,b){return"metabolite"===b?f.decompartmentalize(a)[0]:a}function e(a){return null===a?a:a.charAt(0).toUpperCase()+a.slice(1)}var f=a("./utils"),g=a("tinier"),h=g.createComponent,i=(g.createInterface,g.interfaceTypes,g.createElement),j=g.render,k=(a("underscore"),{"min-width":"270px","min-height":"100px","border-radius":"2px",border:"1px solid #b58787",padding:"7px","background-color":"#fff","text-align":"left","font-size":"16px","font-family":"sans-serif",color:"#111","box-shadow":"4px 6px 20px 0px rgba(0, 0, 0, 0.4)"}),l={"font-size":"18px","font-weight":"bold"},m={"border-radius":"3px","background-color":"#eee",border:"1px solid #ddd","margin-top":"4px"},n={position:"absolute",top:"4px",right:"4px",color:"#d27066","background-color":"#ffeded","border-radius":"2px","font-size":"14px","text-align":"right",padding:"0px 5px"},o=h({displayName:"DefaultTooltip",init:function(){return{biggId:"",name:"",loc:{x:0,y:0},data:null,type:null}},reducers:{setContainerData:function(a){return Object.assign({},a.state,{biggId:a.biggId,name:a.name,loc:a.loc,data:a.data,type:a.type})}},methods:{openBigg:function(a){var b=a.state.type,c=a.state.biggId,e="http://bigg.ucsd.edu/",f="gene"===b?e+"search?query="+c:e+"universal/"+b+"s/"+d(c,b);window.open(f)}},render:function(a){var b=d(a.state.biggId,a.state.type),c="Open "+b+" in BiGG Models.";return j(a.el,i("div",{style:k},i("span",{style:l},a.state.biggId),i("br"),"name: "+a.state.name,i("br"),"data: "+(a.state.data&&"(nd)"!==a.state.data?a.state.data:"no data"),i("br"),i("button",{style:m,onClick:a.methods.openBigg},c),i("div",{style:n},e(a.state.type))))}});b.exports={DefaultTooltip:o}},{"./utils":33,tinier:55,underscore:56}],23:[function(a,b,c){function d(a,b,c,d){var e=a.append("div").attr("id","tooltip-container");this.placed_div=m(e,b),e.on("mouseover",this.cancel_hide_tooltip.bind(this)),e.on("mouseleave",this.hide.bind(this)),this.map=b,this.setup_map_callbacks(b),this.zoom_container=d,this.setup_zoom_callbacks(d),this.tooltip_component=c,this.tooltip_function=o.isFunction(c)?function(a){c({state:a,el:e.node()})}:null,this.tinier_tooltip=n.checkType(n.COMPONENT,c)?n.run(c,e.node()):null,this.delay_hide_timeout=null}function e(a){a.callback_manager.set("show_tooltip.tooltip_container",function(b,c){a.settings.get_option("enable_tooltips")&&this.show(b,c)}.bind(this)),a.callback_manager.set("hide_tooltip.tooltip_container",this.hide.bind(this)),a.callback_manager.set("delay_hide_tooltip.tooltip_container",this.delay_hide.bind(this))}function f(a){a.callback_manager.set("zoom.tooltip_container",function(){this.is_visible()&&this.hide()}.bind(this)),a.callback_manager.set("go_to.tooltip_container",function(){this.is_visible()&&this.hide()}.bind(this))}function g(){return this.placed_div.is_visible()}function h(a,b){if(this.cancel_hide_tooltip(),!o.contains(["reaction_label","node_label","gene_label"],a))throw new Error("Tooltip not supported for object type "+a);var c={x:b.label_x,y:b.label_y+10};this.placed_div.place(c);const d={biggId:b.bigg_id,name:b.name,loc:c,data:b.data_string,type:a.replace("_label","").replace("node","metabolite")};null!==this.tooltip_function?this.tooltip_function(d):this.tinier_tooltip&&this.tinier_tooltip.reducers.setContainerData(d)}function i(){this.placed_div.hide()}function j(){this.delay_hide_timeout=setTimeout(function(){this.hide()}.bind(this),100)}function k(){null!==this.delay_hide_timeout&&clearTimeout(this.delay_hide_timeout)}var l=a("./utils"),m=a("./PlacedDiv"),n=a("tinier"),o=a("underscore"),p=l.make_class();p.prototype={init:d,setup_map_callbacks:e,setup_zoom_callbacks:f,is_visible:g,show:h,hide:i,delay_hide:j,cancel_hide_tooltip:k},b.exports=p},{"./PlacedDiv":13,"./utils":33,tinier:55,underscore:56}],24:[function(a,b,c){function d(){var a=40;this.stack=Array(a),this.current=-1,this.oldest=-1,this.newest=-1,this.end_of_stack=!0,this.top_of_stack=!0}function e(a,b){return a+1>b-1?0:a+1}function f(a,b){return 0>a-1?b-1:a-1}function g(a,b){this.current=e(this.current,this.stack.length),this.end_of_stack?this.oldest=this.current:this.oldest==this.current&&(this.oldest=e(this.oldest,this.stack.length)),this.stack[this.current]={undo:a,redo:b},this.newest=this.current,this.top_of_stack=!0,this.end_of_stack=!1}function h(){return this.end_of_stack?console.warn("End of stack."):(this.stack[this.current].undo(),this.current==this.oldest?this.end_of_stack=!0:this.current=f(this.current,this.stack.length),void(this.top_of_stack=!1))}function i(){return this.top_of_stack?console.warn("Top of stack."):(this.end_of_stack||(this.current=e(this.current,this.stack.length)),this.stack[this.current].redo(),this.current==this.newest&&(this.top_of_stack=!0),void(this.end_of_stack=!1))}var j=a("./utils"),k=j.make_class();k.prototype={init:d,push:g,undo:h,redo:i},b.exports=k},{"./utils":33}],25:[function(a,b,c){function d(a,b,c,d){a.classed("escher-container",!0),a.on("touchstart touchmove",function(){y.event.stopPropagation()}),d&&(x("html").classed("fill-screen",!0),x("body").classed("fill-screen",!0),a.classed("fill-screen-div",!0));var e=a.append("div").attr("class","escher-zoom-container"),f=e.append("div").attr("class","escher-3d-transform-container"),g=f.append("svg").attr("class","escher-svg").attr("xmlns","http://www.w3.org/2000/svg");g.select(".zoom-g").remove();var h=g.append("g").attr("class","zoom-g");this.selection=a,this.zoom_container=e,this.css3_transform_container=f,this.svg=g,this.zoomed_sel=h,this.window_translate={x:0,y:0},this.window_scale=1,this._scroll_behavior=b,this._use_3d_transform=c,this._pan_drag_on=!0,this._zoom_behavior=null,this._zoom_timeout=null,this._svg_scale=this.window_scale,this._svg_translate=this.window_translate,this.callback_manager=new t,this._update_scroll()}function e(a){this._scroll_behavior=a,this._update_scroll()}function f(a){this._use_3d_transform=a}function g(a){u.isUndefined(a)?this._pan_drag_on=!this._pan_drag_on:this._pan_drag_on=a,this._pan_drag_on?this.zoomed_sel.classed("cursor-grab",!0).classed("cursor-grabbing",!1):this.zoomed_sel.style("cursor",null).classed("cursor-grab",!1).classed("cursor-grabbing",!1),this._update_scroll()}function h(){if(!u.contains(["zoom","pan","none"],this._scroll_behavior))throw Error("Bad value for scroll_behavior: "+this._scroll_behavior);if(this.zoom_container.on("mousewheel.zoom",null).on("DOMMouseScroll.zoom",null).on("wheel.zoom",null).on("dblclick.zoom",null).on("mousewheel.escher",null).on("DOMMouseScroll.escher",null).on("wheel.escher",null).on("mousedown.zoom",null).on("touchstart.zoom",null).on("touchmove.zoom",null).on("touchend.zoom",null),this._zoom_behavior=v().on("start",function(){y.event.sourceEvent&&"mousedown"===y.event.sourceEvent.type&&this.zoomed_sel.classed("cursor-grab",!1).classed("cursor-grabbing",!0),null!==y.event.sourceEvent&&(y.event.sourceEvent.stopPropagation(),y.event.sourceEvent.preventDefault())}.bind(this)).on("zoom",function(){this._go_to_callback(y.event.transform.k,{x:y.event.transform.x,y:y.event.transform.y})}.bind(this)).on("end",function(){y.event.sourceEvent&&"mouseup"===y.event.sourceEvent.type&&this.zoomed_sel.classed("cursor-grab",!0).classed("cursor-grabbing",!1)}.bind(this)),this.zoom_container.call(this._zoom_behavior),this.zoom_container.on("dblclick.zoom",null),this._pan_drag_on||this.zoom_container.on("mousedown.zoom",null).on("touchstart.zoom",null).on("touchmove.zoom",null).on("touchend.zoom",null),"zoom"!==this._scroll_behavior&&this.zoom_container.on("mousewheel.zoom",null).on("DOMMouseScroll.zoom",null).on("wheel.zoom",null),"pan"===this._scroll_behavior){var a=function(){var a=y.event,b=.5;a.stopPropagation(),a.preventDefault(),a.returnValue=!1;var c=function(a,c){var d=u.isUndefined(a)?c:-a/1.5;return d*b},d={x:this.window_translate.x-c(a.wheelDeltaX,a.deltaX),y:this.window_translate.y-c(a.wheelDeltaY,a.deltaY)};this.go_to(this.window_scale,d)}.bind(this);this.zoom_container.on("mousewheel.escher",a),this.zoom_container.on("DOMMouseScroll.escher",a),this.zoom_container.on("wheel.escher",a)}this.go_to(this.window_scale,this.window_translate)}function i(a,b){if(s.check_undefined(arguments,["scale","translate"]),!a)throw new Error("Bad scale value");if(!b||!("x"in b)||!("y"in b)||u.isNaN(b.x)||u.isNaN(b.y))throw new Error("Bad translate value");var c=w.translate(b.x,b.y).scale(a);this.zoom_container.call(this._zoom_behavior.transform,c)}function j(a,b){this.window_scale=a,this.window_translate=b;var c=this._use_3d_transform;c?(u.isNull(this._zoom_timeout)||clearTimeout(this._zoom_timeout),this._go_to_3d(a,b,this._svg_scale,this._svg_translate),this._zoom_timeout=u.delay(function(){this._go_to_svg(a,b)}.bind(this),100)):this._go_to_svg(a,b),this.callback_manager.run("go_to")}function k(a,b,c,d){var e=a/c,f=s.c_minus_c(b,s.c_times_scalar(d,e)),g="translate("+f.x+"px,"+f.y+"px) scale("+e+")";this.css3_transform_container.style("transform",g),this.css3_transform_container.style("-webkit-transform",g),this.css3_transform_container.style("transform-origin","0 0"),this.css3_transform_container.style("-webkit-transform-origin","0 0")}function l(){this.css3_transform_container.style("transform",null),this.css3_transform_container.style("-webkit-transform",null),this.css3_transform_container.style("transform-origin",null),this.css3_transform_container.style("-webkit-transform-origin",null)}function m(a,b,c){this.callback_manager.run("svg_start"),u.defer(function(){this._clear_3d(),this.zoomed_sel.attr("transform","translate("+b.x+","+b.y+") scale("+a+")"),this._svg_scale=a,this._svg_translate=b,u.defer(function(){this.callback_manager.run("svg_finish"),u.isUndefined(c)||c()}.bind(this))}.bind(this))}function n(a){var b=this.get_size(),c={x:b.width/2-((b.width/2-this.window_translate.x)*a+this.window_translate.x),y:b.height/2-((b.height/2-this.window_translate.y)*a+this.window_translate.y)};this.go_to(this.window_scale*a,s.c_plus_c(this.window_translate,c))}function o(){this.zoom_by(1.5)}function p(){this.zoom_by(.667)}function q(){var a=parseInt(this.selection.style("width"),10),b=parseInt(this.selection.style("height"),10);if(u.isNaN(a)||u.isNaN(b))throw new Error("Size not defined for ZoomContainer element.");return{width:a,height:b}}function r(a){var b=120,c=this.get_size(),d={x:{min:-this.window_translate.x/this.window_scale+b/this.window_scale,max:-this.window_translate.x/this.window_scale+(c.width-b)/this.window_scale},y:{min:-this.window_translate.y/this.window_scale+b/this.window_scale,max:-this.window_translate.y/this.window_scale+(c.height-b)/this.window_scale}};a.x<d.x.min?(this.window_translate.x=this.window_translate.x-(a.x-d.x.min)*this.window_scale,this.go_to(this.window_scale,this.window_translate)):a.x>d.x.max&&(this.window_translate.x=this.window_translate.x-(a.x-d.x.max)*this.window_scale,this.go_to(this.window_scale,this.window_translate)),a.y<d.y.min?(this.window_translate.y=this.window_translate.y-(a.y-d.y.min)*this.window_scale,this.go_to(this.window_scale,this.window_translate)):a.y>d.y.max&&(this.window_translate.y=this.window_translate.y-(a.y-d.y.max)*this.window_scale,this.go_to(this.window_scale,this.window_translate))}var s=a("./utils"),t=a("./CallbackManager"),u=a("underscore"),v=a("d3-zoom").zoom,w=(a("d3-zoom").zoomTransform,a("d3-zoom").zoomIdentity),x=a("d3-selection").select,y=a("d3-selection"),z=s.make_class();z.prototype={init:d,set_scroll_behavior:e,set_use_3d_transform:f,_update_scroll:h,toggle_pan_drag:g,go_to:i,_go_to_callback:j,_go_to_3d:k,_clear_3d:l,_go_to_svg:m,zoom_by:n,zoom_in:o,zoom_out:p,get_size:q,translate_off_screen:r},b.exports=z},{"./CallbackManager":5,"./utils":33,"d3-selection":47,"d3-zoom":52,underscore:56}],26:[function(a,b,c){function d(a){if(Math.abs(a)>Math.PI)throw new Error("Angle must be between -PI and PI");return Math.abs(a)<Math.PI/7||Math.abs(a-Math.PI)<Math.PI/7?{x:-50,y:-40}:a>0?{x:15*(1-Math.abs(a-Math.PI/2)/(Math.PI/2)),y:10+50*(a-Math.PI/2)}:{x:15*(1-Math.abs(a+Math.PI/2)/(Math.PI/2)),y:10-50*(Math.abs(a)-Math.PI/2)}}function e(a,b,c,d,e,f){var g=18*e.length,h=b-(b>f)-c/2>=-1;return Math.abs(a)<Math.PI/7?d||h?{x:.3*-g,y:40}:{x:.3*-g,y:-20}:Math.abs(a-Math.PI)<Math.PI/7?d||!h?{x:.3*-g,y:40}:{x:.3*-g,y:-20}:d?{x:25-38*Math.abs(Math.abs(a)-Math.PI/2),y:(Math.abs(a)-Math.PI/2)*(2*(a>0)-1)*50}:0>a&&h||a>0&&!h?{x:15,y:0}:{x:.5*-g,y:30}}function f(a,b,c,f,h,i,j,k){k=Math.PI/180*k;var m=String(++i.reactions),n={x:h.x,y:h.y},o=350,p=[n,r.c_plus_c(n,{x:o,y:0})],s={x:(p[0].x+p[1].x)/2,y:(p[0].y+p[1].y)/2},t=d(k),u=20,v={name:b.name,bigg_id:b.bigg_id,reversibility:b.reversibility,gene_reaction_rule:b.gene_reaction_rule,genes:r.clone(b.genes),metabolites:r.clone(b.metabolites)};r.extend(v,{label_x:s.x+t.x,label_y:s.y+t.y,segments:{}});var w=[],x=[],y=0,z=0,A=!1;for(var B in v.metabolites){var C=c[B],D=v.metabolites[B],E=C.formula,F={coefficient:D,bigg_id:B,name:C.name};if(0>D){F.index=y;var G=/C([0-9]+)/.exec(E);h.bigg_id===F.bigg_id?w.push([F.index,1/0]):G&&-1===j.indexOf(r.decompartmentalize(F.bigg_id)[0])&&w.push([F.index,parseInt(G[1])]),y++}else{F.index=z;var G=/C([0-9]+)/.exec(E);h.bigg_id===F.bigg_id?(x.push([F.index,1/0]),A=!0):G&&-1===j.indexOf(r.decompartmentalize(F.bigg_id)[0])&&x.push([F.index,parseInt(G[1])]),z++}v.metabolites[B]=F}var H=function(a,b){return b[1]>a[1]?b:a},I=w.reduce(H,[0,0])[0],J=x.reduce(H,[0,0])[0];for(var B in v.metabolites){var C=v.metabolites[B];C.coefficient<0?(C.is_primary=C.index===I,C.count=y):(C.is_primary=C.index===J,C.count=z)}var K={},L=[{node_type:"anchor_reactants",dis:{x:u*(A?1:-1),y:0}},{node_type:"center",dis:{x:0,y:0}},{node_type:"anchor_products",dis:{x:u*(A?-1:1),y:0}}],M={};L.map(function(a){var b=String(++i.nodes),c="center"===a.node_type?"midmarker":"multimarker";K[b]={node_type:c,x:s.x+a.dis.x,y:s.y+a.dis.y,connected_segments:[],name:null,bigg_id:null,label_x:null,label_y:null,node_is_primary:null,data:null},M[a.node_type]=b});var N=[[M.anchor_reactants,M.center,"reactants"],[M.anchor_products,M.center,"products"]];N.map(function(a){var b=a[0],c=a[1],d=String(++i.segments),e=0===y&&"reactants"===a[2]&&v.reversibility||0===z&&"products"===a[2];v.segments[d]={b1:null,b2:null,from_node_id:b,to_node_id:c,from_node_coefficient:null,to_node_coefficient:null,reversibility:v.reversibility,data:v.data,reverse_flux:v.reverse_flux,unconnected_segment_with_arrow:e},K[b].connected_segments.push({segment_id:d,reaction_id:m}),K[c].connected_segments.push({segment_id:d,reaction_id:m})});var O=K;for(var B in v.metabolites){var P,Q,C=v.metabolites[B];C.coefficient<0?(P=I,Q=M.anchor_reactants):(P=J,Q=M.anchor_products);var R=l(C,P,p,s,o,A);if(h.bigg_id===C.bigg_id){var S=String(++i.segments);v.segments[S]={b1:R.b1,b2:R.b2,from_node_id:Q,to_node_id:f,from_node_coefficient:null,to_node_coefficient:C.coefficient,reversibility:v.reversibility},h.connected_segments.push({segment_id:S,reaction_id:m}),O[Q].connected_segments.push({segment_id:S,reaction_id:m})}else{var S=String(++i.segments),T=String(++i.nodes);v.segments[S]={b1:R.b1,b2:R.b2,from_node_id:Q,to_node_id:T,from_node_coefficient:null,to_node_coefficient:C.coefficient,reversibility:v.reversibility};var U=e(k,C.index,C.count,C.is_primary,C.bigg_id,P);O[T]={connected_segments:[{segment_id:S,reaction_id:m}],x:R.circle.x,y:R.circle.y,node_is_primary:C.is_primary,label_x:R.circle.x+U.x,label_y:R.circle.y+U.y,name:C.name,bigg_id:C.bigg_id,node_type:"metabolite"},O[Q].connected_segments.push({segment_id:S,reaction_id:m})}}var V=[];for(var a in v.metabolites)V.push({bigg_id:a,coefficient:v.metabolites[a].coefficient});v.metabolites=V;var W={};W[m]=v;var X=q(W);return O[f]=h,g(O,W,X,k,n),{new_reactions:W,new_beziers:X,new_nodes:O}}function g(a,b,c,d,e){var f=function(a){return null===a?null:r.rotate_coords(a,d,e)},g=[],h=[];for(var j in a){var k=a[j],l=f({x:k.x,y:k.y}),m=i(k,b,l);k.connected_segments.map(function(a){var d=b[a.reaction_id];if(void 0!==d){var e=a.segment_id,g=d.segments[e];if(g.to_node_id==j&&g.b2){var h=f(g.b2),i=n(e,"b2");g.b2=r.c_plus_c(g.b2,h),c[i].x=g.b2.x,c[i].y=g.b2.y}else if(g.from_node_id==j&&g.b1){var h=f(g.b1),i=n(e,"b1");g.b1=r.c_plus_c(g.b1,h),c[i].x=g.b1.x,c[i].y=g.b1.y}}}),h=r.unique_concat([h,m.reaction_ids]),g.push(j)}return{node_ids:g,reaction_ids:h}}function h(a,b,c,d,e){var f=i(a,c,e);return a.connected_segments.map(function(a){var g=c[a.reaction_id];if(!s.isUndefined(g)){var h=a.segment_id,i=g.segments[h],j=[["b1","from_node_id"],["b2","to_node_id"]];j.forEach(function(a){var c=a[0],f=a[1];if(i[f]===b&&i[c]){i[c]=r.c_plus_c(i[c],e);var g=d[n(h,c)];g.x=i[c].x,g.y=i[c].y}}),f.reaction_ids.indexOf(a.reaction_id)<0&&f.reaction_ids.push(a.reaction_id)}}),f}function i(a,b,c){a.x=a.x+c.x,a.y=a.y+c.y,a.label_x=a.label_x+c.x,a.label_y=a.label_y+c.y;var d=[];return a.connected_segments.map(function(e){var f=b[e.reaction_id];d.indexOf(e.reaction_id)<0&&(d.push(e.reaction_id),"midmarker"==a.node_type&&(f.label_x=f.label_x+c.x,f.label_y=f.label_y+c.y))}),{reaction_ids:d}}function j(a,b,c){var d=Math.floor(c/2);return a*(b-d+(b>=d))}function k(a,b,c,d){var e=Math.floor(d/2);return b+Math.abs(c-e+(c>=e))*a}function l(a,b,c,d,e,f){var g=c[0];c=[r.c_minus_c(c[0],g),r.c_minus_c(c[1],g)],d=r.c_minus_c(d,g);var h,i,l=80,m=.4,n=.25,o=.3*l,p=50,q=20,s=a.count-1;a.is_primary?h=20:(h=10,i=a.index>b?a.index-1:a.index);var t,u,v,w,x=e-h,y=[{x:h,y:0},{x:x,y:0}];return a.coefficient<0!==f&&a.is_primary?(t={x:y[0].x,y:y[0].y},v={x:d.x*(1-m)+y[0].x*m,y:d.y*(1-m)+y[0].y*m},w={x:d.x*n+t.x*(1-n),y:d.y*n+t.y*(1-n)},u={x:c[0].x,y:c[0].y}):a.coefficient<0!==f?(t={x:y[0].x+k(q,p,i,s),y:y[0].y+j(o,i,s)},v={x:d.x*(1-m)+y[0].x*m,y:d.y*(1-m)+y[0].y*m},w={x:d.x*n+t.x*(1-n),y:d.y*n+t.y*(1-n)},u={x:c[0].x+k(q,p,i,s),y:c[0].y+j(l,i,s)}):a.coefficient>0!==f&&a.is_primary?(t={x:y[1].x,y:y[1].y},v={x:d.x*(1-m)+y[1].x*m,y:d.y*(1-m)+y[1].y*m},w={x:d.x*n+t.x*(1-n),y:d.y*n+t.y*(1-n)},u={x:c[1].x,y:c[1].y}):a.coefficient>0!==f&&(t={x:y[1].x-k(q,p,i,s),y:y[1].y+j(o,i,s)},v={x:d.x*(1-m)+y[1].x*m,y:d.y*(1-m)+y[1].y*m},w={x:d.x*n+t.x*(1-n),y:d.y*n+t.y*(1-n)},u={x:c[1].x-k(q,p,i,s),y:c[1].y+j(l,i,s)}),{b1:r.c_plus_c(g,v),b2:r.c_plus_c(g,w),circle:r.c_plus_c(g,u)}}function m(a,b,c){var d=String(++a.text_labels),e={text:b,x:c.x,y:c.y};return{id:d,label:e}}function n(a,b){return a+"_"+b}function o(a){var b=[];for(var c in a){var d=a[c];for(var e in d.segments){var f=d.segments[e],g=["b1","b2"];g.forEach(function(a){var c=f[a];null!==c&&b.push(n(e,a))})}}return b}function p(a,b){var c={};for(var d in a){var e=a[d];["b1","b2"].forEach(function(a){var f=e[a];if(null!==f){var g=n(d,a);c[g]={bezier:a,x:f.x,y:f.y,reaction_id:b,segment_id:d}}})}return c}function q(a){var b={};for(var c in a){var d=a[c],e=p(d.segments,c);r.extend(b,e)}return b}var r=a("./utils"),s=a("underscore");b.exports={get_met_label_loc:e,new_reaction:f,rotate_nodes:g,move_node_and_dependents:h,new_text_label:m,bezier_id_for_segment_id:n,bezier_ids_for_reaction_ids:o,new_beziers_for_segments:p,new_beziers_for_reactions:q}},{"./utils":33,underscore:56}],27:[function(a,b,c){var d=a("./utils");b.exports=function(a,b){function c(a){return void 0===m&&(m=document.createElement("span"),m.style.visibility="hidden",m.style.position="fixed",m.style.outline="0",m.style.margin="0",m.style.padding="0",m.style.border="0",m.style.left="0",m.style.whiteSpace="pre",m.style.fontSize=b.fontSize,m.style.fontFamily=b.fontFamily,m.style.fontWeight="normal",document.body.appendChild(m)),m.innerHTML=String(a).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),m.getBoundingClientRect().right}document=d.get_document(a),window=d.get_window(a),b=b||{},b.fontSize=b.fontSize||"13px",b.fontFamily=b.fontFamily||"sans-serif",b.promptInnerHTML=b.promptInnerHTML||"",b.color=b.color||"#333",b.hintColor=b.hintColor||"#aaa",b.backgroundColor=b.backgroundColor||"#fff",b.dropDownBorderColor=b.dropDownBorderColor||"#aaa",b.dropDownZIndex=b.dropDownZIndex||"100",b.dropDownOnHoverBackgroundColor=b.dropDownOnHoverBackgroundColor||"#ddd";var e=document.createElement("input");e.type="text",e.spellcheck=!1,e.style.fontSize=b.fontSize,e.style.fontFamily=b.fontFamily,e.style.color=b.color,e.style.backgroundColor=b.backgroundColor,e.style.width="100%",e.style.outline="0",e.style.border="0",e.style.margin="0",e.style.padding="0";var f=e.cloneNode();f.disabled="",f.style.position="absolute",f.style.top="0",f.style.left="0",f.style.borderColor="transparent",f.style.boxShadow="none",f.style.color=b.hintColor,e.style.backgroundColor="transparent",e.style.verticalAlign="top",e.style.position="relative";var g=document.createElement("div");g.style.position="relative",g.style.outline="0",g.style.border="0",g.style.margin="0",g.style.padding="0";var h=document.createElement("div");if(h.style.position="absolute",h.style.outline="0",h.style.margin="0",h.style.padding="0",h.style.border="0",h.style.fontSize=b.fontSize,h.style.fontFamily=b.fontFamily,h.style.color=b.color,h.style.backgroundColor=b.backgroundColor,h.style.top="0",h.style.left="0",h.style.overflow="hidden",h.innerHTML=b.promptInnerHTML,h.style.background="transparent",void 0===document.body)throw"document.body is undefined. The library was wired up incorrectly.";document.body.appendChild(h);var i=h.getBoundingClientRect().right;g.appendChild(h),h.style.visibility="visible",h.style.left="-"+i+"px",g.style.marginLeft=i+"px",g.appendChild(f),g.appendChild(e);var j=document.createElement("div");j.style.position="absolute",j.style.visibility="hidden",j.style.outline="0",j.style.margin="0",j.style.padding="0",j.style.textAlign="left",j.style.fontSize=b.fontSize,j.style.fontFamily=b.fontFamily,j.style.backgroundColor=b.backgroundColor,j.style.zIndex=b.dropDownZIndex,j.style.cursor="default",j.style.borderStyle="solid",j.style.borderWidth="1px",j.style.borderColor=b.dropDownBorderColor,j.style.overflowX="hidden",j.style.whiteSpace="pre",j.style.overflowY="scroll";var k=function(a){var c=[],d=0,e=-1,f=null,g=function(){this.style.outline="1px solid #ddd"},h=function(){this.style.outline="0"},i=function(a){a.preventDefault(),j.onmouseselection(this.id)},j={hide:function(){a.style.visibility="hidden"},refresh:function(e,f){a.style.visibility="hidden",d=0,a.innerHTML="";var k=window.innerHeight||document.documentElement.clientHeight,l=a.parentNode.getBoundingClientRect(),m=l.top-6,n=k-l.bottom-6;c=[];for(var o=0;o<f.length;o++){var q=f[o].matches.filter(function(a){return 0==a.toLowerCase().indexOf(e.toLowerCase())});if(0!=q.length){var r=document.createElement("div");if(r.style.color=b.color,r.onmouseover=g,r.onmouseout=h,r.onmousedown=function(a){a.preventDefault()},r.ondblclick=i,r.__hint=q[0],r.id=f[o].id,r.innerHTML=f[o].html,c.push(r),a.appendChild(r),c.length>=p.display_limit){var s=document.createElement("div");s.innerHTML=" "+(f.length-c.length)+" more",c.push(s),a.appendChild(s);break}}}0!==c.length&&(j.highlight(0),m>3*n?(a.style.maxHeight=m+"px",a.style.top="",a.style.bottom="100%"):(a.style.top="100%",a.style.bottom="",a.style.maxHeight=n+"px"),a.style.visibility="visible")},highlight:function(a){-1!=e&&c[e]&&(c[e].style.backgroundColor=b.backgroundColor),c[a].style.backgroundColor=b.dropDownOnHoverBackgroundColor,e=a,f=c[a]},move:function(b){return"hidden"===a.style.visibility?"":d+b===-1||d+b===c.length?c[d].__hint:(d+=b,j.highlight(d),c[d].__hint)},onmouseselection:function(){},get_current_row:function(){return f}};return j},l=k(j);l.onmouseselection=function(a){p.onEnter(a),p.input.focus()},g.appendChild(j),a.appendChild(g);var m,n,o,p={get_hint:function(a){return a},display_limit:1e3,onArrowDown:function(){},onArrowUp:function(){},onEnter:function(){},onTab:function(){},
onChange:function(){p.repaint()},startFrom:0,options:[],wrapper:g,input:e,hint:f,dropDown:j,prompt:h,setText:function(a){f.value=a,e.value=a},getText:function(){return e.value},hideDropDown:function(){l.hide()},repaint:function(){var a=e.value,b=p.startFrom,d=p.options,g=d.length,h=a.substring(b);n=a.substring(0,b),f.value="";for(var i=0;g>i;i++){var k=d[i].matches.filter(function(a){return 0==a.toLowerCase().indexOf(h.toLowerCase())});if(0!=k.length){f.value=p.get_hint(k[0]);break}}j.style.left=c(n)+"px",l.refresh(h,p.options)}},q=function(a,b){o=a.value;var c=function(){var c=a.value;o!==c&&(o=c,b(c))};a.addEventListener("input",c,!1),a.addEventListener("keyup",c,!1),a.addEventListener("change",c,!1)};q(e,function(a){p.onChange(a),p.repaint()});var r=function(a){a=a||window.event;var b=a.keyCode;if(33!=b&&34!=b)if(39!=b&&35!=b&&9!=b){if(13==b){var c=l.get_current_row().id;return void p.onEnter(c)}if(40==b){var d=l.move(1);return""==d&&p.onArrowDown(),void(f.value=p.get_hint(d))}if(38==b){var d=l.move(-1);return""==d&&p.onArrowUp(),f.value=p.get_hint(d),a.preventDefault(),void a.stopPropagation()}f.value=""}else if(9==b&&(a.preventDefault(),a.stopPropagation(),0==f.value.length&&p.onTab()),f.value.length>0){e.value=f.value;var g=o!=e.value;o=e.value,g&&p.onChange(e.value)}};return e.addEventListener("keydown",r,!1),p}},{"./utils":33}],28:[function(a,b,c){function d(a,b){var c={},d=[null];for(var e in a){d=a[e].map(function(){return null});break}for(var f in b){var g=b[f],h=g.bigg_id,i={};g.genes.forEach(function(b){["bigg_id","name"].forEach(function(c){var e=a[b[c]]||r.clone(d),f=i[b.bigg_id];if("undefined"==typeof f)i[b.bigg_id]=e;else for(var g=0;g<e.length;g++){var h=e[g];null!==h&&(f[g]=h)}})}),c[h]=i}return c}function e(a,b,c){if(null===a)return null;if(-1===["reaction_data","metabolite_data","gene_data"].indexOf(b))throw new Error("Invalid name argument: "+b);a instanceof Array||(a=[a]);var e=function(){return null===a?null:1===a.length?null:2===a.length?null:console.warn("Bad data style: "+b)};if(e(),a=r.array_to_object(a),"gene_data"===b){if(void 0===c)throw new Error("Must pass all_reactions argument for gene_data");a=d(a,c)}return a}function f(a,b,c){function d(a){return isFinite(a)?a:null}function e(a,b){return b?Math.abs(a):a}function f(a,b,c){return c?Math.abs(b-a):b-a}function g(a,b,c){if(0==a||0==b)return null;var d=b>=a?b/a:-a/b;return c?Math.abs(d):d}function h(a,b,c){if(0==a)return null;if(0>b/a)return null;var d=Math.log(b/a)/Math.log(2);return c?Math.abs(d):d}if(null===a)return null;var i=-1!=b.indexOf("abs");if(1==a.length){var j=q(a[0]);return null===j?null:e(j,i)}if(2!=a.length)throw new Error("Data array must be of length 1 or 2");var k=a.map(q);if(null===k[0]||null===k[1])return null;if("diff"==c)return f(k[0],k[1],i);if("fold"==c)return d(g(k[0],k[1],i));if("log2_fold"==c)return d(h(k[0],k[1],i));throw new Error("Bad data compare_style: "+c)}function g(a){return null===a||null===a[0]?!1:a[0]<0}function h(a,b,c,d,e,g){function h(a,b){return null===a?"nd":b(a)}var i=a,j=null===b,k={};c.forEach(function(a){var c=a.bigg_id;if(!(c in k))if(k[c]=!0,j)i=m(i,c,c+"\n");else{if(!(c in b))return;var e=b[c],l=f(e,d,g),n=null===l?u:t(".3g");if(1===e.length)i=m(i,c,c+" ("+h(e[0],n)+")\n");else if(2===e.length){var o,p=s.any(e,function(a){return null!==q(a)});o=p?c+" ("+h(e[0],n)+", "+h(e[1],n)+": "+h(l,n)+")\n":c+" ("+h(e[0],n)+", "+h(e[1],n)+")\n",i=m(i,c,o)}}}),i=i.replace(w,"\n").replace(x,"$1");var l=i.split("\n").map(function(a){for(var b=0,d=c.length;d>b;b++){var f=c[b];if(-1!==a.indexOf(f.bigg_id))return"name"===e&&(a=m(a,f.bigg_id,f.name)),{bigg_id:f.bigg_id,name:f.name,text:a}}return{bigg_id:null,name:null,text:a}});return l}function i(a,b){function c(a,b){return null===a?"(nd)":b(a)}if(null===a)return c(null);if(1===a.length){var d=null===b?u:t(".3g");return c(a[0],d)}if(2===a.length){var d=null===b?u:t(".3g"),e=c(a[0],d);return e+=", "+c(a[1],d),e+=": "+c(b,d)}return""}function j(a){var b=a[0].length,c=[];if(2>b||b>3)throw new Error("CSV file must have 2 or 3 columns");for(var d=1;b>d;d++)c[d-1]={};return a.slice(1).forEach(function(a){for(var b=1,d=a.length;d>b;b++)c[b-1][a[0]]=a[b]}),c}function k(a){var b=a.replace(y,"$1$2").replace(z,"").split(" ").filter(function(a){return""!=a});return r.unique_strings_array(b)}function l(a,b,c){var d=[null],e=1;for(var f in b){d=b[f].map(function(){return null}),e=d.length;break}if(""==a)return r.clone(d);for(var g=[],h=0;e>h;h++){var i=a,j=!0;for(var f in b){var k=q(b[f][h]);null===k?k=0:j=!1,i=m(i,f,k)}if(j)g.push(null);else{for(;;){var l=i;if(l=l.replace(A," $1 "),l=l.replace(D,function(a,b,c,d){var e=c.split(B).map(parseFloat),f=e.reduce(function(a,b){return a+b});return b+f+d}),l=l.replace(E,function(a,b,d,e){var f=d.split(C).map(parseFloat),g="min"==c?Math.min.apply(null,f):f.reduce(function(a,b){return a+b})/f.length;return b+g+e}),l==i)break;i=l}var n=Number(i);isNaN(n)?(console.warn("Could not evaluate "+a),g.push(null)):g.push(n)}}return g}function m(a,b,c){function d(a){return a.replace(v,"\\$1")}var e="(^|[\\s\\(\\)])",f="([\\s\\(\\)]|$)",g=e+d(b)+f;return a.replace(new RegExp(g,"g"),"$1"+c+"$2")}function n(a,b,c,d,e){s.isUndefined(e)&&(e=Object.keys(a));var h,j,k;return null===b?(e.map(function(b){h=a[b],h.data=null,h.data_string="";for(j in h.segments)k=h.segments[j],k.data=null;h.gene_string=null}),!1):(e.map(function(e){h=a[e];var l=b[h.bigg_id]||b[h.name]||null,m=f(l,c,d),n=g(l),o=i(l,m);h.data=m,h.data_string=o,h.reverse_flux=n,h.gene_string=null;for(j in h.segments)k=h.segments[j],k.data=h.data,k.reverse_flux=h.reverse_flux}),!0)}function o(a,b,c,d,e){s.isUndefined(e)&&(e=Object.keys(a));return null===b?(e.map(function(b){a[b].data=null,a[b].data_string=""}),!1):(e.map(function(e){var g=a[e],h=b[g.bigg_id]||b[g.name]||null,j=f(h,c,d),k=i(h,j);g.data=j,g.data_string=k}),!0)}function p(a,b,c,d,e,j,k){if(s.isUndefined(k)&&(k=Object.keys(a)),null===b)return k.map(function(b){var c=a[b];c.data=null,c.data_string="",c.reverse_flux=!1;for(var d in c.segments){var e=c.segments[d];e.data=null}c.gene_string=null}),!1;var m=[null];for(var n in b){for(var o in b[n]){m=b[n][o].map(function(){return null});break}break}return k.map(function(k){var n,o,p=a[k],q=p.gene_reaction_rule,t=b[p.bigg_id];s.isUndefined(t)?(o={},n=r.clone(m)):(o=t,n=l(q,o,j));var u=f(n,c,e),v=g(n),w=i(n,u);p.data=u,p.data_string=w,p.reverse_flux=v;for(var x in p.segments){var y=p.segments[x];y.data=p.data,y.reverse_flux=p.reverse_flux}p.gene_string=h(q,o,p.genes,c,d,e)}),!0}function q(a){var b=Number(a);return isNaN(b)||parseFloat(a)!=b?null:b}var r=a("./utils"),s=a("underscore"),t=a("d3-format").format;b.exports={import_and_check:e,text_for_data:i,float_for_data:f,reverse_flux_for_data:g,gene_string_for_data:h,csv_converter:j,genes_for_gene_reaction_rule:k,evaluate_gene_reaction_rule:l,replace_gene_in_rule:m,apply_reaction_data_to_reactions:n,apply_metabolite_data_to_nodes:o,apply_gene_data_to_reactions:p};var u=function(a){return a},v=/([.*+?^=!:${}()|\[\]\/\\])/g,w=/\n\s*\n/g,x=/\n\s*(\)*)\s*$/,y=/([\(\) ])(?:and|or)([\)\( ])/gi,z=/[\(\)]/g,A=/\(\s*(\S+)\s*\)/g,B=/\s+or\s+/i,C=/\s+and\s+/i,D=/(^|\()(\s*-?[0-9.]+\s+(?:or\s+-?[0-9.]+\s*)+)(\)|$)/gi,E=/(^|\(|or\s)(\s*-?[0-9.]+\s+(?:and\s+-?[0-9.]+\s*)+)(\sor|\)|$)/gi},{"./utils":33,"d3-format":43,underscore:56}],29:[function(a,b,c){b.exports={version:"1.6.0-beta.4",builder_embed:"svg.escher-svg .gene-label,svg.escher-svg .label{text-rendering:optimizelegibility;cursor:default}svg.escher-svg #mouse-node{fill:none}svg.escher-svg #canvas{stroke:#ccc;stroke-width:7px;fill:#fff}svg.escher-svg .resize-rect{fill:#000;opacity:0;stroke:none}svg.escher-svg .label{font-family:sans-serif;font-style:italic;font-weight:700;font-size:8px;fill:#000;stroke:none}svg.escher-svg .reaction-label{font-size:30px;fill:#202078;text-rendering:optimizelegibility}svg.escher-svg .node-label{font-size:20px}svg.escher-svg .gene-label{font-size:18px;fill:#202078}svg.escher-svg .text-label .label,svg.escher-svg .text-label-input{font-size:50px}svg.escher-svg .node-circle{stroke-width:2px}svg.escher-svg .midmarker-circle,svg.escher-svg .multimarker-circle{fill:#fff;fill-opacity:.2;stroke:#323232}svg.escher-svg g.selected .node-circle{stroke-width:6px;stroke:#1471c7}svg.escher-svg g.selected .label{fill:#1471c7}svg.escher-svg .metabolite-circle{stroke:#a24510;fill:#e0865b}svg.escher-svg g.selected .metabolite-circle{stroke:#050200}svg.escher-svg .segment{stroke:#334E75;stroke-width:10px;fill:none}svg.escher-svg .arrowhead{fill:#334E75}svg.escher-svg .stoichiometry-label-rect{fill:#fff;opacity:.5}svg.escher-svg .stoichiometry-label{fill:#334E75;font-size:17px}svg.escher-svg .membrane{fill:none;stroke:#fb0}svg.escher-svg .brush .extent{fill-opacity:.1;fill:#000;stroke:#fff;shape-rendering:crispEdges}svg.escher-svg #brush-container .background{fill:none}svg.escher-svg .bezier-circle{fill:#fff}svg.escher-svg .bezier-circle.b1{stroke:red}svg.escher-svg .bezier-circle.b2{stroke:#00f}svg.escher-svg .connect-line{stroke:#c8c8c8}svg.escher-svg .direction-arrow{stroke:#000;stroke-width:1px;fill:#fff;opacity:.3}svg.escher-svg .start-reaction-cursor{cursor:pointer}svg.escher-svg .start-reaction-target{stroke:#646464;fill:none;opacity:.5}svg.escher-svg .rotation-center-line{stroke:red;stroke-width:5px}svg.escher-svg .highlight{fill:#D97000;text-decoration:underline}svg.escher-svg .cursor-grab{cursor:grab;cursor:-webkit-grab}svg.escher-svg .cursor-grabbing{cursor:grabbing;cursor:-webkit-grabbing}svg.escher-svg .edit-text-cursor{cursor:text}"}},{}],30:[function(a,b,c){b.exports={version:a("./inline").version,Builder:a("./Builder"),Map:a("./Map"),Behavior:a("./Behavior"),KeyManager:a("./KeyManager"),DataMenu:a("./DataMenu"),UndoStack:a("./UndoStack"),CobraModel:a("./CobraModel"),utils:a("./utils"),SearchIndex:a("./SearchIndex"),Settings:a("./Settings"),data_styles:a("./data_styles"),ui:a("./ui"),"static":a("./static"),ZoomContainer:a("./ZoomContainer"),libs:{_:a("underscore"),underscore:a("underscore"),tinier:a("tinier"),baconjs:a("baconjs"),mousetrap:a("mousetrap"),vkbeautify:a("vkbeautify"),d3_selection:a("d3-selection"),d3_select:a("d3-selection").select,d3_json:a("d3-request").json}}},{"./Behavior":1,"./Builder":4,"./CobraModel":7,"./DataMenu":8,"./KeyManager":11,"./Map":12,"./SearchIndex":18,"./Settings":19,"./UndoStack":24,"./ZoomContainer":25,"./data_styles":28,"./inline":29,"./static":31,"./ui":32,"./utils":33,baconjs:34,"d3-request":45,"d3-selection":47,mousetrap:54,tinier:55,underscore:56,vkbeautify:57}],31:[function(a,b,c){function d(a,b,c,d,h){var i=f.parse_url_components(window,d),j=function(a){a(null)},k=function(a){a(null)};if(i.map_name){var l=e("map",i.map_name,c,a);l&&(j=function(a){g(l,function(b,c){b&&console.warn(b),a(c)})})}if(i.model_name){var m=e("model",i.model_name,c,b);m&&(k=function(a){g(m,function(b,c){b&&console.warn(b),a(c)})})}i.hasOwnProperty("enable_editing")&&(d.enable_editing="true"===i.enable_editing.toLowerCase()),j(function(a){k(function(b){h(a,b,d)})})}function e(a,b,c,d){var e=c[a+"s"].filter(function(c){return c[a+"_name"]==b});if(0==e.length)throw new Error("Bad "+a+" "+b);return d+encodeURIComponent(e[0].organism)+"/"+encodeURIComponent(e[0][a+"_name"])+".json"}var f=a("./utils"),g=a("d3-request").json;b.exports={load_map_model_from_url:d}},{"./utils":33,"d3-request":45}],32:[function(a,b,c){function d(a,b){var c=b.ignore_bootstrap||!1;a.attr("class","btn btn-default simple-button");var d=a.append("span"),e=d.append("span");"id"in b&&a.attr("id",b.id),"text"in b&&e.text(b.text),"icon"in b&&!c&&d.classed(b.icon,!0),c||e.attr("class","hidden"),"key"in b&&i(a,b.key),"key_text"in b&&"tooltip"in b&&null!==b.key_text?a.attr("title",b.tooltip+b.key_text):"tooltip"in b&&a.attr("title",b.tooltip)}function e(a,b){var c=a.append("button");d(c,b)}function f(a){var b=a.append("li").attr("class","btn-group-vertical").attr("data-toggle","buttons");return{button:function(a){var c=(a.ignore_bootstrap||!1,b.append("label"));return c.append("input").attr("type","radio"),d(c,a),this}}}function g(a){var b=a.attr("class","btn-group-vertical");return{button:function(a){var c=b.append("button");return d(c,a),this}}}function h(a,b,c){void 0===c&&(c=!1);var d=a.append("li").attr("class","dropdown");d.append("button").text(b+" ").attr("class","btn btn-link btn-sm dropdown-button").attr("data-toggle","dropdown").append("b").attr("class","caret");var e=d.append("ul").attr("class","dropdown-menu").classed("pull-right",c).attr("role","menu").attr("aria-labelledby","dLabel");return{dropdown:d,button:function(a){var b=e.append("li").attr("role","presentation").datum(a),c=b.append("a").attr("href","#"),d=c.append("span").attr("class","dropdown-button-icon"),f=c.append("span").attr("class","dropdown-button-text");if("id"in a&&b.attr("id",a.id),"key_text"in a&&"text"in a&&null!==a.key_text?f.text(" "+a.text+a.key_text):"text"in a&&f.text(" "+a.text),"icon"in a&&d.classed(a.icon,!0),"key"in a)i(c,a.key);else if("input"in a){var g=a.input,h=g.accept_csv?k(c,b,g.pre_fn,g.fn,g.failure_fn):j(c,b,g.pre_fn,g.fn,g.failure_fn);"assign"in g&&"key"in g&&(g.assign[g.key]=h)}return this},divider:function(){return e.append("li").attr("role","presentation").attr("class","divider"),this}}}function i(a,b){a.on("click",function(){b.fn.call(b.target)})}function j(a,b,c,d,e){var f=b.append("input").attr("type","file").style("display","none").on("change",function(){l.load_json(this.files[0],function(a,b){d(a,b),this.value=""}.bind(this),c,e)});return a.on("click",function(a){f.node().click()}),function(){f.node().click()}}function k(a,b,c,d,e){var f=b.append("input").attr("type","file").style("display","none").on("change",function(){l.load_json_or_csv(this.files[0],m.csv_converter,function(a,b){d(a,b),this.value=""}.bind(this),c,e)});return a.on("click",function(a){f.node().click()}),function(){f.node().click()}}var l=a("./utils"),m=a("./data_styles");b.exports={individual_button:e,radio_button_group:f,button_group:g,dropdown_menu:h,set_json_input_button:j,set_json_or_csv_input_button:k}},{"./data_styles":28,"./utils":33}],33:[function(a,b,c){function d(){try{!!new Blob}catch(a){alert("Blob not supported")}}function e(a,b,c){if(void 0===a||null===a)return b;var d={};for(var e in b){var f=e in a&&null!==a[e]&&void 0!==a[e],g=f?a[e]:b[e];c&&e in c&&(g=parseFloat(g),isNaN(g)&&(f?(console.warn("Bad float for option "+e),g=parseFloat(b[e]),isNaN(g)&&(console.warn("Bad float for default "+e),g=null)):(console.warn("Bad float for default "+e),g=null))),d[e]=g}return d}function f(a){for(var b=a.node();b.hasChildNodes();)b.removeChild(b.lastChild)}function g(a,b){var c="";return a&&da(a,function(a,d){a&&console.warn(a),c=d,b(c)}),!1}function h(a,b){return-1!==a.indexOf(b,a.length-b.length)}function i(a,b,c,d){return d?(b&&console.warn("File "+b+" overridden by value."),void c.call(a,null,d)):b?void(h(b,"json")?ca(b,function(b,d){c.call(a,b,d)}):h(b,"css")?da(b,function(b,d){c.call(a,b,d)}):c.call(a,"Unrecognized file type",null)):void c.call(a,"No filename",null)}function j(a,b,c){0===b.length&&c.call(a);for(var d=-1,e=b.length;++d<b.length;)i(a,b[d].file,function(b,d){this.call(a,b,d),--e||c.call(a)}.bind(b[d].callback),b[d].value)}function k(){var a,b=function(c){if(!(this instanceof b)){a=!0;var d=new b(arguments);return a=!1,d}"function"==typeof this.init&&this.init.apply(this,a?c:arguments)};return b}function l(a,b){a.select("defs").remove();var c=a.append("defs"),d=c.node();return d.parentNode.insertBefore(d,d.parentNode.firstChild),c.append("style").attr("type","text/css").text(b),c}function m(a,b,c,d,e,f,g,h){var i={};for(var j in d)void 0===d[j]?console.warn("Undefined value for id "+j+" in object. Ignoring."):i[j]=d[j];var k=a.select(b).selectAll(c).data(p(i,e),function(a){return a[e]}),l=f?f(k.enter()).merge(k):k;g&&l.call(g),h&&k.exit().call(h)}function n(a,b,c,d,e,f,g){var h=a.selectAll(b).data(function(a){return p(a[c],d)},function(a){return a[d]}),i=e?e(h.enter()).merge(h):h;f&&i.call(f),g&&h.exit().call(g)}function o(a,b){var c=[];for(var d in a){var e=s(a[d]);e[b]=d,c.push(e)}return c}function p(a,b){var c=[];for(var d in a){var e=a[d];e[b]=d,c.push(e)}return c}function q(a,b){if(!a||!b)return!1;if(a.length!=b.length)return!1;for(var c=0,d=a.length;d>c;c++)if(a[c]!=b[c])return!1;return!0}function r(a){for(var b={},c=0,d=a.length;d>c;c++)for(var e=a[c],f=Object.keys(e),g=0,h=f.length;h>g;g++){var i=f[g];if(i in b)b[i][c]=e[i];else{for(var j=[],k=0;d>k;k++)j[k]=null;j[c]=e[i],b[i]=j}}return b}function s(a){return ba.isArray(a)?ba.map(a,function(a){return s(a)}):ba.isObject(a)?ba.mapObject(a,function(a,b){return s(a)}):a}function t(a,b,c){void 0===c&&(c=!1);for(var d in b){if(d in a&&!c)throw new Error("Attribute "+d+" already in object.");a[d]=b[d]}}function u(a){var b=[];return a.forEach(function(a){a.forEach(function(a){b.indexOf(a)<0&&b.push(a)})}),b}function v(a){for(var b=[],c=0,d=a.length;d>c;c++)-1===b.indexOf(a[c])&&b.push(a[c]);return b}function w(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}}function x(a,b){for(var c={},d=-1;++d<b.length;)c[b[d]]=s(a[b[d]]);return b.length!==Object.keys(c).length&&console.warn("did not find correct reaction subset"),c}function y(a,b){for(var c={},d=-1;++d<b.length;)c[b[d]]=a[b[d]];return b.length!==Object.keys(c).length&&console.warn("did not find correct reaction subset"),c}function z(a,b){return null===a||null===b||void 0===a||void 0===b?null:{x:a.x+b.x,y:a.y+b.y}}function A(a,b){return null===a||null===b||void 0===a||void 0===b?null:{x:a.x-b.x,y:a.y-b.y}}function B(a,b){return{x:a.x*b,y:a.y*b}}function C(a,b){d();var c=JSON.stringify(a),e=new Blob([c],{type:"application/json"});ga(e,b+".json")}function D(a,b,c,d){window.File&&window.FileReader&&window.FileList&&window.Blob||b("The File APIs are not fully supported in this browser.",null);var e=new window.FileReader;if(e.onload=function(a){var c,d=a.target.result;try{c=JSON.parse(d)}catch(e){return void b(e,null)}b(null,c)},void 0!==c&&null!==c)try{c()}catch(f){console.warn(f)}e.onabort=function(a){try{d()}catch(b){console.warn(b)}},e.onerror=function(a){try{d()}catch(b){console.warn(b)}},e.readAsText(a)}function E(a,b,c,d,e,f){var g=function(a){var d,e,f=a.target.result;try{d=JSON.parse(f)}catch(g){e="JSON error: "+g;try{d=b(ea(f))}catch(g){return void c(e+"\nCSV error: "+g,null)}}c(null,d)};if(void 0!==f&&null!==f)return console.warn("Debugging load_json_or_csv"),g(f);window.File&&window.FileReader&&window.FileList&&window.Blob||c("The File APIs are not fully supported in this browser.",null);var h=new window.FileReader;if(void 0!==d&&null!==d)try{d()}catch(i){console.warn(i)}h.onabort=function(a){try{e()}catch(b){console.warn(b)}},h.onerror=function(a){try{e()}catch(b){console.warn(b)}},h.onload=g,h.readAsText(a)}function F(a,b,c){d();var e=(new XMLSerializer).serializeToString(b.node());c&&(e=aa.xml(e)),e='<?xml version="1.0" encoding="utf-8"?>\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"\n "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n'+e;var f=new Blob([e],{type:"image/svg+xml"});ga(f,a+".svg")}function G(a,b,c){d();var e=(new XMLSerializer).serializeToString(b.node());c&&(e=aa.xml(e)),e='<?xml version="1.0" encoding="utf-8"?>\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"\n "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n'+e;var f=document.createElement("canvas"),g=f.getContext("2d"),h=b.node().getBBox(),i=h.width+h.x,j=h.height+h.y;1e4>i&&1e4>j?(f.width=i,f.height=j):f.width>f.height?(f.width=1e4,f.height=1e4*(j/i)):(f.width=1e4*(i/j),f.height=1e4);var k=new Image;k.src="data:image/svg+xml;base64,"+btoa(e),k.onload=function(){g.fillStyle="#FFF",g.fillRect(0,0,f.width,f.height),g.drawImage(k,0,0,f.width,f.height),f.toBlob(function(b){ga(b,a+".png")})}}function H(a,b,c){return a.map(function(a){return I(a,b,c)})}function I(a,b,c){var d=Math.cos(-b)*(a.x-c.x)+Math.sin(-b)*(a.y-c.y)+c.x-a.x,e=-Math.sin(-b)*(a.x-c.x)+Math.cos(-b)*(a.y-c.y)+c.y-a.y;return{x:d,y:e}}function J(a){var b=a[1].x-a[0].x,c=a[1].y-a[0].y;return 0===b&&c>=0?Math.PI/2:0===b&&0>c?3*Math.PI/2:b>=0&&c>=0?Math.atan(c/b):b>=0?Math.atan(c/b)+2*Math.PI:Math.atan(c/b)+Math.PI}function K(a){return 180*a/Math.PI}function L(a,b,c){var d=Math.atan2(b.x-c.x,c.y-b.y),e=Math.atan2(b.x-c.x+a.x,c.y-b.y-a.y),f=e-d;return f}function M(a,b){return Math.sqrt(Math.pow(b.y-a.y,2)+Math.pow(b.x-a.x,2))}function N(a,b){b.map(function(c,d){void 0===a[d]&&console.error("Argument is undefined: "+String(b[d]))})}function O(a,b){return a+"_"+b}function P(a){var b=/(.*)_([a-z0-9]{1,2})$/,c=b.exec(a);return null!==c?c.slice(1,3):[a,null]}function Q(a){var b=a.reduce(function(a,b){return a+b}),c=b/a.length;return c}function R(a){a.sort(function(a,b){return a-b});var b=Math.floor(a.length/2);return a.length%2==1?a[b]:(a[b-1]+a[b])/2}function S(a){a.sort(function(a,b){return a-b});var b=Math.floor(a.length/2);return 1===a.length?[a[0],a[0],a[0]]:a.length%2===1?[R(a.slice(0,b)),a[b],R(a.slice(b+1))]:[R(a.slice(0,b)),(a[b-1]+a[b])/2,R(a.slice(b))]}function T(a){for(var b="",c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",d=0;a>d;d++)b+=c.charAt(Math.floor(Math.random()*c.length));return b}function U(){return T(12)}function V(a,b){for(a instanceof fa&&(a=a.node());null!==a.parentNode;)if(a=a.parentNode,void 0!==a.tagName&&a.tagName.toLowerCase()===b.toLowerCase())return!0;return!1}function W(a,b){return void 0!==b&&null!==b&&(b=b.replace(/^\/|\/$/g,""),a=[b,a].join("/")),a.replace(/^\/|\/$/g,"")+".json"}function X(a,b){ba.isUndefined(b)&&(b={});for(var c=a.location.search.substring(1),d=c.split("&"),e=0,f=d.length;f>e;e++){var g=d[e].split("="),h=decodeURIComponent(g[1]);if(g[0].indexOf("[]")===g[0].length-2){var i=g[0].replace("[]","");i in b||(b[i]=[]),b[i].push(h)}else b[g[0]]=h}return b}function Y(a){return a.ownerDocument}function Z(a){return Y(a).defaultView}function $(a){if(-1!==a.indexOf("skew")||-1!==a.indexOf("matrix"))throw new Error("d3_transform_catch does not work with skew or matrix");var b=/translate\s*\(\s*([0-9.-]+)\s*,\s*([0-9.-]+)\s*\)/.exec(a),c=ba.isNull(b),d=c?0:Number(b[1]),e=c?0:Number(b[2]),f=/rotate\s*\(\s*([0-9.-]+)\s*\)/.exec(a),g=ba.isNull(f),h=g?0:Number(f[1]),i=/scale\s*\(\s*([0-9.-]+)\s*\)/.exec(a),j=ba.isNull(i),k=j?0:Number(i[1]);return{translate:[d,e],rotate:h,scale:k}}function _(a){var b=function(){var a,b=navigator.userAgent,c=b.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(c[1])?(a=/\brv[ :]+(\d+)/g.exec(b)||[],"IE "+(a[1]||"")):"Chrome"===c[1]&&(a=b.match(/\b(OPR|Edge)\/(\d+)/),null!=a)?a.slice(1).join(" ").replace("OPR","Opera"):(c=c[2]?[c[1],c[2]]:[navigator.appName,navigator.appVersion,"-?"],null!==(a=b.match(/version\/(\d+)/i))&&c.splice(1,1,a[1]),c.join(" "))};try{return b().toLowerCase().indexOf(a)>-1}catch(c){return!1}}var aa=a("vkbeautify"),ba=a("underscore"),ca=a("d3-request").json,da=a("d3-request").text,ea=a("d3-dsv").csvParseRows,fa=a("d3-selection").selection;try{var ga=a("file-saver").saveAs}catch(ha){console.warn("Not a browser, so FileSaver.js not available.")}b.exports={set_options:e,remove_child_nodes:f,load_css:g,load_files:j,load_the_file:i,make_class:k,setup_defs:l,draw_an_object:m,draw_a_nested_object:n,make_array:o,make_array_ref:p,compare_arrays:q,array_to_object:r,clone:s,extend:t,unique_concat:u,unique_strings_array:v,debounce:w,object_slice_for_ids:x,object_slice_for_ids_ref:y,c_plus_c:z,c_minus_c:A,c_times_scalar:B,download_json:C,load_json:D,load_json_or_csv:E,download_svg:F,download_png:G,rotate_coords_recursive:H,rotate_coords:I,get_angle:J,to_degrees:K,angle_for_event:L,distance:M,check_undefined:N,compartmentalize:O,decompartmentalize:P,mean:Q,median:R,quartiles:S,random_characters:T,generate_map_id:U,check_for_parent_tag:V,name_to_url:W,parse_url_components:X,get_document:Y,get_window:Z,d3_transform_catch:$,check_browser:_}},{"d3-dsv":41,"d3-request":45,"d3-selection":47,"file-saver":53,underscore:56,vkbeautify:57}],34:[function(b,c,d){(function(b){(function(){function d(a,b){var c=arguments.length<=2||void 0===arguments[2]?!1:arguments[2];this.obs=a,this.sync=b,this.lazy=c,this.queue=[]}function e(){d.apply(this,arguments)}function f(a){d.call(this,a,!0)}function g(a,b,c){this.context=a,this.method=b,this.args=c}function h(a){this.value=a}function i(){this.id=++da}function j(a,b){return this instanceof j?(i.call(this),void(!b&&M.isFunction(a)||(null!=a?a._isNext:void 0)?(this.valueF=a,this.valueInternal=void 0):(this.valueF=void 0,this.valueInternal=a))):new j(a,b)}function k(a,b){return this instanceof k?void j.call(this,a,b):new k(a,b)}function l(){return this instanceof l?void i.call(this):new l}function m(a){return this instanceof m?(this.error=a,void i.call(this)):new m(a)}function n(a){this.desc=a,this.id=++ia,this.initialDesc=this.desc}function o(){var a=arguments.length<=0||void 0===arguments[0]?[]:arguments[0];this.unsubscribe=M.bind(this.unsubscribe,this),this.unsubscribed=!1,this.subscriptions=[],this.starting=[];for(var b,c=0;c<a.length;c++)b=a[c],this.add(b)}function p(a,b){this._subscribe=a,this._handleEvent=b,this.subscribe=M.bind(this.subscribe,this),this.handleEvent=M.bind(this.handleEvent,this),this.pushing=!1,this.ended=!1,this.prevError=void 0,this.unsubSrc=void 0,this.subscriptions=[],this.queue=[]}function q(a,b,c){return this instanceof q?(M.isFunction(a)&&(c=b,b=a,a=g.empty),n.call(this,a),F(b),this.dispatcher=new p(b,c),void ja(this)):new q(a,b,c)}function r(a,b,c){p.call(this,b,c),this.property=a,this.subscribe=M.bind(this.subscribe,this),this.current=ba,this.currentValueRootId=void 0,this.propertyEnded=!1}function s(a,b,c){n.call(this,a),F(b),this.dispatcher=new r(this,b,c),ja(this)}function t(){return this instanceof t?(this.unsubAll=M.bind(this.unsubAll,this),this.subscribeAll=M.bind(this.subscribeAll,this),this.guardedSink=M.bind(this.guardedSink,this),this.sink=void 0,this.subscriptions=[],this.ended=!1,void q.call(this,new w.Desc(w,"Bus",[]),this.subscribeAll)):new t}function u(a){return[a,ga()]}var v=Array.prototype.slice,w={toString:function(){return"Bacon"}};w.version="0.7.89";var x=("undefined"!=typeof b&&null!==b?b:this).Error,y=function(){},z=function(a,b){return a},A=function(a){return a.slice(0)},B=function(a,b){if(!b)throw new x(a)},C=function(a){if((null!=a?a._isObservable:void 0)&&!(null!=a?a._isProperty:void 0))throw new x("Observable is not a Property : "+a)},D=function(a){if(!(null!=a?a._isEventStream:void 0))throw new x("not an EventStream : "+a)},E=function(a){if(!(null!=a?a._isObservable:void 0))throw new x("not an Observable : "+a)},F=function(a){return B("not a function : "+a,M.isFunction(a))},G=Array.isArray||function(a){return a instanceof Array},H=function(a){return a&&a._isObservable},I=function(a){if(!G(a))throw new x("not an array : "+a)},J=function(a){return B("no arguments supported",0===a.length)},K=function(a){for(var b=arguments.length,c=1;b>1?b>c:c>b;b>1?c++:c--)for(var d in arguments[c])a[d]=arguments[c][d];return a},L=function(a,b){var c={}.hasOwnProperty,d=function(){};d.prototype=b.prototype,a.prototype=new d;for(var e in b)c.call(b,e)&&(a[e]=b[e]);return a},M={indexOf:function(){return Array.prototype.indexOf?function(a,b){return a.indexOf(b)}:function(a,b){for(var c,d=0;d<a.length;d++)if(c=a[d],b===c)return d;return-1}}(),indexWhere:function(a,b){for(var c,d=0;d<a.length;d++)if(c=a[d],b(c))return d;return-1},head:function(a){return a[0]},always:function(a){return function(){return a}},negate:function(a){return function(b){return!a(b)}},empty:function(a){return 0===a.length},tail:function(a){return a.slice(1,a.length)},filter:function(a,b){for(var c,d=[],e=0;e<b.length;e++)c=b[e],a(c)&&d.push(c);return d},map:function(a,b){return function(){for(var c,d=[],e=0;e<b.length;e++)c=b[e],d.push(a(c));return d}()},each:function(a,b){for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=a[c];b(c,d)}},toArray:function(a){return G(a)?a:[a]},contains:function(a,b){return-1!==M.indexOf(a,b)},id:function(a){return a},last:function(a){return a[a.length-1]},all:function(a){for(var b,c=arguments.length<=1||void 0===arguments[1]?M.id:arguments[1],d=0;d<a.length;d++)if(b=a[d],!c(b))return!1;return!0},any:function(a){for(var b,c=arguments.length<=1||void 0===arguments[1]?M.id:arguments[1],d=0;d<a.length;d++)if(b=a[d],c(b))return!0;return!1},without:function(a,b){return M.filter(function(b){return b!==a},b)},remove:function(a,b){var c=M.indexOf(b,a);return c>=0?b.splice(c,1):void 0},fold:function(a,b,c){for(var d,e=0;e<a.length;e++)d=a[e],b=c(b,d);return b},flatMap:function(a,b){return M.fold(b,[],function(b,c){return b.concat(a(c))})},cached:function(a){var b=ba;return function(){return("undefined"!=typeof b&&null!==b?b._isNone:void 0)&&(b=a(),a=void 0),b}},bind:function(a,b){return function(){return a.apply(b,arguments)}},isFunction:function(a){return"function"==typeof a},toString:function(a){var b,c,d,e={}.hasOwnProperty;try{return N++,null==a?"undefined":M.isFunction(a)?"function":G(a)?N>5?"[..]":"["+M.map(M.toString,a).toString()+"]":null!=(null!=a?a.toString:void 0)&&a.toString!==Object.prototype.toString?a.toString():"object"==typeof a?N>5?"{..}":(b=function(){var b=[];for(c in a)e.call(a,c)&&(d=function(){var b;try{return a[c]}catch(b){return b}}(),b.push(M.toString(c)+":"+M.toString(d)));return b}(),"{"+b+"}"):a}finally{N--}}},N=0;w._=M;var O=w.UpdateBarrier=function(){var a,b=[],c={},d=[],e=0,f={},g=function(b){return a?d.push(b):b()},h=function(d,e){if(a){var f=c[d.id];return"undefined"==typeof f||null===f?(f=c[d.id]=[e],b.push(d)):f.push(e)}return e()},i=function(){for(;b.length>0;)j(0,!0);f={}},j=function(a,d){var e=b[a],f=e.id,g=c[f];b.splice(a,1),delete c[f],d&&b.length>0&&k(e);for(var h,i=0;i<g.length;i++)(h=g[i])()},k=function(a){if(!f[a.id]){for(var d,e=a.internalDeps(),g=0;g<e.length;g++)if(d=e[g],k(d),c[d.id]){var h=M.indexOf(b,d);j(h,!1)}f[a.id]=!0}},l=function(b,c,f,g){if(a)return f.apply(c,g);a=b;try{var h=f.apply(c,g);i()}finally{for(a=void 0;e<d.length;){var j=d[e];e++,j()}e=0,d=[]}return h},m=function(){return a?a.id:void 0},n=function(a,b){var c=!1,d=!1,e=function(){return d=!0},f=function(){return c=!0,e()};return e=a.dispatcher.subscribe(function(a){return g(function(){if(!c){var d=b(a);if(d===w.noMore)return f()}})}),d&&e(),f},o=function(){return b.length>0};return{whenDoneWith:h,hasWaiters:o,inTransaction:l,currentEventId:m,wrappedSubscribe:n,afterTransaction:g}}();K(d.prototype,{_isSource:!0,subscribe:function(a){return this.obs.dispatcher.subscribe(a)},toString:function(){return this.obs.toString()},markEnded:function(){return this.ended=!0,!0},consume:function(){return this.lazy?{value:M.always(this.queue[0])}:this.queue[0]},push:function(a){return this.queue=[a],[a]},mayHave:function(){return!0},hasAtLeast:function(){return this.queue.length},flatten:!0}),L(e,d),K(e.prototype,{consume:function(){return this.queue.shift()},push:function(a){return this.queue.push(a)},mayHave:function(a){return!this.ended||this.queue.length>=a},hasAtLeast:function(a){return this.queue.length>=a},flatten:!1}),L(f,d),K(f.prototype,{consume:function(){var a=this.queue;return this.queue=[],{value:function(){return a}}},push:function(a){return this.queue.push(a.value())},hasAtLeast:function(){return!0}}),d.isTrigger=function(a){return(null!=a?a._isSource:void 0)?a.sync:null!=a?a._isEventStream:void 0},d.fromObservable=function(a){return(null!=a?a._isSource:void 0)?a:(null!=a?a._isProperty:void 0)?new d(a,!1):new e(a,!0)},K(g.prototype,{_isDesc:!0,deps:function(){return this.cached||(this.cached=R([this.context].concat(this.args))),this.cached},toString:function(){return M.toString(this.context)+"."+M.toString(this.method)+"("+M.map(M.toString,this.args)+")"}});var P=function(a,b){var c=a||b;if(c&&c._isDesc)return a||b;for(var d=arguments.length,e=Array(d>2?d-2:0),f=2;d>f;f++)e[f-2]=arguments[f];
return new g(a,b,e)},Q=function(a,b){return b.desc=a,b},R=function(a){return G(a)?M.flatMap(R,a):H(a)?[a]:("undefined"!=typeof a&&null!==a?a._isSource:void 0)?[a.obs]:[]};w.Desc=g,w.Desc.empty=new w.Desc("","",[]);var S=function(a){return function(b){for(var c=arguments.length,d=Array(c>1?c-1:0),e=1;c>e;e++)d[e-1]=arguments[e];if("object"==typeof b&&d.length){var f=b,g=d[0];b=function(){return f[g].apply(f,arguments)},d=d.slice(1)}return a.apply(void 0,[b].concat(d))}},T=function(a){return a=Array.prototype.slice.call(a),Y.apply(void 0,a)},U=function(a,b){return function(){for(var c=arguments.length,d=Array(c),e=0;c>e;e++)d[e]=arguments[e];return a.apply(void 0,b.concat(d))}},V=function(a){return function(b){return function(c){if("undefined"!=typeof c&&null!==c){var d=c[b];return M.isFunction(d)?d.apply(c,a):d}}}},W=function(a,b){var c=a.slice(1).split("."),d=M.map(V(b),c);return function(a){for(var b,c=0;c<d.length;c++)b=d[c],a=b(a);return a}},X=function(a){return"string"==typeof a&&a.length>1&&"."===a.charAt(0)},Y=S(function(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;b>d;d++)c[d-1]=arguments[d];return M.isFunction(a)?c.length?U(a,c):a:X(a)?W(a,c):M.always(a)}),Z=function(a,b){return Y.apply(void 0,[a].concat(b))},$=function(a,b,c,d){if("undefined"!=typeof b&&null!==b?b._isProperty:void 0){var e=b.sampledBy(a,function(a,b){return[a,b]});return d.call(e,function(a){var b=a[0];a[1];return b}).map(function(a){var b=(a[0],a[1]);return b})}return b=Z(b,c),d.call(a,b)},_=function(a){if(M.isFunction(a))return a;if(X(a)){var b=aa(a);return function(a,c){return a[b](c)}}throw new x("not a function or a field key: "+a)},aa=function(a){return a.slice(1)};K(h.prototype,{_isSome:!0,getOrElse:function(){return this.value},get:function(){return this.value},filter:function(a){return a(this.value)?new h(this.value):ba},map:function(a){return new h(a(this.value))},forEach:function(a){return a(this.value)},isDefined:!0,toArray:function(){return[this.value]},inspect:function(){return"Some("+this.value+")"},toString:function(){return this.inspect()}});var ba={_isNone:!0,getOrElse:function(a){return a},filter:function(){return ba},map:function(){return ba},forEach:function(){},isDefined:!1,toArray:function(){return[]},inspect:function(){return"None"},toString:function(){return this.inspect()}},ca=function(a){return("undefined"!=typeof a&&null!==a?a._isSome:void 0)||("undefined"!=typeof a&&null!==a?a._isNone:void 0)?a:new h(a)};w.noMore="<no-more>",w.more="<more>";var da=0;i.prototype._isEvent=!0,i.prototype.isEvent=function(){return!0},i.prototype.isEnd=function(){return!1},i.prototype.isInitial=function(){return!1},i.prototype.isNext=function(){return!1},i.prototype.isError=function(){return!1},i.prototype.hasValue=function(){return!1},i.prototype.filter=function(){return!0},i.prototype.inspect=function(){return this.toString()},i.prototype.log=function(){return this.toString()},L(j,i),j.prototype.isNext=function(){return!0},j.prototype.hasValue=function(){return!0},j.prototype.value=function(){var a;return(null!=(a=this.valueF)?a._isNext:void 0)?(this.valueInternal=this.valueF.value(),this.valueF=void 0):this.valueF&&(this.valueInternal=this.valueF(),this.valueF=void 0),this.valueInternal},j.prototype.fmap=function(a){var b,c;return this.valueInternal?(c=this.valueInternal,this.apply(function(){return a(c)})):(b=this,this.apply(function(){return a(b.value())}))},j.prototype.apply=function(a){return new j(a)},j.prototype.filter=function(a){return a(this.value())},j.prototype.toString=function(){return M.toString(this.value())},j.prototype.log=function(){return this.value()},j.prototype._isNext=!0,L(k,j),k.prototype._isInitial=!0,k.prototype.isInitial=function(){return!0},k.prototype.isNext=function(){return!1},k.prototype.apply=function(a){return new k(a)},k.prototype.toNext=function(){return new j(this)},L(l,i),l.prototype.isEnd=function(){return!0},l.prototype.fmap=function(){return this},l.prototype.apply=function(){return this},l.prototype.toString=function(){return"<end>"},L(m,i),m.prototype.isError=function(){return!0},m.prototype.fmap=function(){return this},m.prototype.apply=function(){return this},m.prototype.toString=function(){return"<error> "+M.toString(this.error)},w.Event=i,w.Initial=k,w.Next=j,w.End=l,w.Error=m;var ea=function(a){return new k(a,!0)},fa=function(a){return new j(a,!0)},ga=function(){return new l},ha=function(a){return a&&a._isEvent?a:fa(a)},ia=0,ja=function(){};K(n.prototype,{_isObservable:!0,subscribe:function(a){return O.wrappedSubscribe(this,a)},subscribeInternal:function(a){return this.dispatcher.subscribe(a)},onValue:function(){var a=T(arguments);return this.subscribe(function(b){return b.hasValue()?a(b.value()):void 0})},onValues:function(a){return this.onValue(function(b){return a.apply(void 0,b)})},onError:function(){var a=T(arguments);return this.subscribe(function(b){return b.isError()?a(b.error):void 0})},onEnd:function(){var a=T(arguments);return this.subscribe(function(b){return b.isEnd()?a():void 0})},name:function(a){return this._name=a,this},withDescription:function(){return this.desc=P.apply(void 0,arguments),this},toString:function(){return this._name?this._name:this.desc.toString()},deps:function(){return this.desc.deps()},internalDeps:function(){return this.initialDesc.deps()}}),n.prototype.assign=n.prototype.onValue,n.prototype.forEach=n.prototype.onValue,n.prototype.inspect=n.prototype.toString,w.Observable=n,K(o.prototype,{add:function(a){var b=this;if(!this.unsubscribed){var c=!1,d=y;this.starting.push(a);var e=function(){return b.unsubscribed?void 0:(c=!0,b.remove(d),M.remove(a,b.starting))};return d=a(this.unsubscribe,e),this.unsubscribed||c?d():this.subscriptions.push(d),M.remove(a,this.starting),d}},remove:function(a){return this.unsubscribed?void 0:void 0!==M.remove(a,this.subscriptions)?a():void 0},unsubscribe:function(){if(!this.unsubscribed){this.unsubscribed=!0;for(var a=this.subscriptions,b=0;b<a.length;b++)a[b]();return this.subscriptions=[],this.starting=[],[]}},count:function(){return this.unsubscribed?0:this.subscriptions.length+this.starting.length},empty:function(){return 0===this.count()}}),w.CompositeUnsubscribe=o,p.prototype.hasSubscribers=function(){return this.subscriptions.length>0},p.prototype.removeSub=function(a){return this.subscriptions=M.without(a,this.subscriptions),this.subscriptions},p.prototype.push=function(a){return a.isEnd()&&(this.ended=!0),O.inTransaction(a,this,this.pushIt,[a])},p.prototype.pushToSubscriptions=function(a){try{for(var b=this.subscriptions,c=b.length,d=0;c>d;d++){var e=b[d],f=e.sink(a);(f===w.noMore||a.isEnd())&&this.removeSub(e)}return!0}catch(g){throw this.pushing=!1,this.queue=[],g}},p.prototype.pushIt=function(a){if(this.pushing)return this.queue.push(a),w.more;if(a!==this.prevError){for(a.isError()&&(this.prevError=a),this.pushing=!0,this.pushToSubscriptions(a),this.pushing=!1;this.queue.length;)a=this.queue.shift(),this.push(a);return this.hasSubscribers()?w.more:(this.unsubscribeFromSource(),w.noMore)}},p.prototype.handleEvent=function(a){return this._handleEvent?this._handleEvent(a):this.push(a)},p.prototype.unsubscribeFromSource=function(){this.unsubSrc&&this.unsubSrc(),this.unsubSrc=void 0},p.prototype.subscribe=function(a){var b;return this.ended?(a(ga()),y):(F(a),b={sink:a},this.subscriptions.push(b),1===this.subscriptions.length&&(this.unsubSrc=this._subscribe(this.handleEvent),F(this.unsubSrc)),function(a){return function(){return a.removeSub(b),a.hasSubscribers()?void 0:a.unsubscribeFromSource()}}(this))},w.Dispatcher=p,L(q,n),K(q.prototype,{_isEventStream:!0,toProperty:function(a){var b=0===arguments.length?ba:ca(function(){return a}),c=this.dispatcher,d=new w.Desc(this,"toProperty",[a]);return new s(d,function(a){var d=!1,e=!1,f=y,g=w.more,i=function(){return d?void 0:b.forEach(function(b){return d=!0,g=a(new k(b)),g===w.noMore?(f(),f=y,y):void 0})};return f=c.subscribe(function(c){return c.hasValue()?c.isInitial()&&!e?(b=new h(function(){return c.value()}),w.more):(c.isInitial()||i(),d=!0,b=new h(c),a(c)):(c.isEnd()&&(g=i()),g!==w.noMore?a(c):void 0)}),e=!0,i(),f})},toEventStream:function(){return this},withHandler:function(a){return new q(new w.Desc(this,"withHandler",[a]),this.dispatcher.subscribe,a)}}),w.EventStream=q,w.never=function(){return new q(P(w,"never"),function(a){return a(ga()),y})},w.when=function(){if(0===arguments.length)return w.never();var a=arguments.length,b="when: expecting arguments in the form (Observable+,function)+";B(b,a%2===0);for(var c=[],e=[],f=0,g=[];a>f;){g[f]=arguments[f],g[f+1]=arguments[f+1];for(var h,i=M.toArray(arguments[f]),j=la(arguments[f+1]),k={f:j,ixs:[]},l=!1,m=0;m<i.length;m++){h=i[m];var n=M.indexOf(c,h);l||(l=d.isTrigger(h)),0>n&&(c.push(h),n=c.length-1);for(var o,p=0;p<k.ixs.length;p++)o=k.ixs[p],o.index===n&&o.count++;k.ixs.push({index:n,count:1})}B("At least one EventStream required",l||!i.length),i.length>0&&e.push(k),f+=2}if(!c.length)return w.never();c=M.map(d.fromObservable,c);var r=M.any(c,function(a){return a.flatten})&&ka(M.map(function(a){return a.obs},c)),s=new w.Desc(w,"when",g),t=new q(s,function(a){var b=[],d=!1,f=function(a){for(var b,d=0;d<a.ixs.length;d++)if(b=a.ixs[d],!c[b.index].hasAtLeast(b.count))return!1;return!0},g=function(a){return!a.sync||a.ended},h=function(a){for(var b,d=0;d<a.ixs.length;d++)if(b=a.ixs[d],!c[b.index].mayHave(b.count))return!0},i=function(a){return!a.source.flatten},j=function(j){return function(k){var l=function(){return O.whenDoneWith(t,n)},m=function(){if(!(b.length>0))return w.more;for(var d,g=w.more,h=b.pop(),j=0;j<e.length;j++)if(d=e[j],f(d)){var k=function(){for(var a,b=[],e=0;e<d.ixs.length;e++)a=d.ixs[e],b.push(c[a.index].consume());return b}();return g=a(h.e.apply(function(){var a,b=function(){for(var a,b=[],c=0;c<k.length;c++)a=k[c],b.push(a.value());return b}();return(a=d).f.apply(a,b)})),b.length&&(b=M.filter(i,b)),g===w.noMore?g:m()}},n=function(){var b=m();return d&&(M.all(c,g)||M.all(e,h))&&(b=w.noMore,a(ga())),b===w.noMore&&k(),b};return j.subscribe(function(c){if(c.isEnd())d=!0,j.markEnded(),l();else if(c.isError())var e=a(c);else j.push(c),j.sync&&(b.push({source:j,e:c}),r||O.hasWaiters()?l():n());return e===w.noMore&&k(),e||w.more})}};return new w.CompositeUnsubscribe(function(){for(var a,b=[],d=0;d<c.length;d++)a=c[d],b.push(j(a));return b}()).unsubscribe});return t};var ka=function(a){var b=arguments.length<=1||void 0===arguments[1]?[]:arguments[1],c=function(a){if(M.contains(b,a))return!0;var d=a.internalDeps();return d.length?(b.push(a),M.any(d,c)):(b.push(a),!1)};return M.any(a,c)},la=function(a){return M.isFunction(a)?a:M.always(a)};w.groupSimultaneous=function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];1===b.length&&G(b[0])&&(b=b[0]);var d=function(){for(var a,c=[],d=0;d<b.length;d++)a=b[d],c.push(new f(a));return c}();return Q(new w.Desc(w,"groupSimultaneous",b),w.when(d,function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];return b}))},L(r,p),K(r.prototype,{push:function(a){return a.isEnd()&&(this.propertyEnded=!0),a.hasValue()&&(this.current=new h(a),this.currentValueRootId=O.currentEventId()),p.prototype.push.call(this,a)},maybeSubSource:function(a,b){return b===w.noMore?y:this.propertyEnded?(a(ga()),y):p.prototype.subscribe.call(this,a)},subscribe:function(a){var b=this,c=w.more;if(this.current.isDefined&&(this.hasSubscribers()||this.propertyEnded)){var d=O.currentEventId(),e=this.currentValueRootId;return!this.propertyEnded&&e&&d&&d!==e?(O.whenDoneWith(this.property,function(){return b.currentValueRootId===e?a(ea(b.current.get().value())):void 0}),this.maybeSubSource(a,c)):(O.inTransaction(void 0,this,function(){return c=a(ea(this.current.get().value()))},[]),this.maybeSubSource(a,c))}return this.maybeSubSource(a,c)}}),L(s,n),K(s.prototype,{_isProperty:!0,changes:function(){var a=this;return new q(new w.Desc(this,"changes",[]),function(b){return a.dispatcher.subscribe(function(a){return a.isInitial()?void 0:b(a)})})},withHandler:function(a){return new s(new w.Desc(this,"withHandler",[a]),this.dispatcher.subscribe,a)},toProperty:function(){return J(arguments),this},toEventStream:function(){var a=this;return new q(new w.Desc(this,"toEventStream",[]),function(b){return a.dispatcher.subscribe(function(a){return a.isInitial()&&(a=a.toNext()),b(a)})})}}),w.Property=s,w.constant=function(a){return new s(new w.Desc(w,"constant",[a]),function(b){return b(ea(a)),b(ga()),y})},w.fromBinder=function(a){var b=arguments.length<=1||void 0===arguments[1]?M.id:arguments[1],c=new w.Desc(w,"fromBinder",[a,b]);return new q(c,function(c){var d=!1,e=!1,f=function(){return d?void 0:"undefined"!=typeof g&&null!==g?(g(),d=!0):e=!0},g=a(function(){for(var a,d=arguments.length,e=Array(d),g=0;d>g;g++)e[g]=arguments[g];var h=b.apply(this,e);G(h)&&(null!=(a=M.last(h))?a._isEvent:void 0)||(h=[h]);for(var i,j=w.more,k=0;k<h.length;k++)if(i=h[k],j=c(i=ha(i)),j===w.noMore||i.isEnd())return f(),j;return j});return e&&f(),f})},w.Observable.prototype.map=function(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;b>d;d++)c[d-1]=arguments[d];return $(this,a,c,function(a){return Q(new w.Desc(this,"map",[a]),this.withHandler(function(b){return this.push(b.fmap(a))}))})};var ma=function(a){return G(a[0])?a[0]:Array.prototype.slice.call(a)},na=function(a){return M.isFunction(a[0])?[ma(Array.prototype.slice.call(a,1)),a[0]]:[ma(Array.prototype.slice.call(a,0,a.length-1)),M.last(a)]};w.combineAsArray=function(){var a=ma(arguments);if(a.length){for(var b=[],c=0;c<a.length;c++){var e=H(a[c])?a[c]:w.constant(a[c]);b.push(new d(e,!0))}return Q(new w.Desc(w,"combineAsArray",a),w.when(b,function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];return b}).toProperty())}return w.constant([])},w.onValues=function(){return w.combineAsArray(Array.prototype.slice.call(arguments,0,arguments.length-1)).onValues(arguments[arguments.length-1])},w.combineWith=function(){var a=na(arguments),b=a[0],c=a[1],d=new w.Desc(w,"combineWith",[c].concat(b));return Q(d,w.combineAsArray(b).map(function(a){return c.apply(void 0,a)}))},w.Observable.prototype.combine=function(a,b){var c=_(b),d=new w.Desc(this,"combine",[a,b]);return Q(d,w.combineAsArray(this,a).map(function(a){return c(a[0],a[1])}))},w.Observable.prototype.withStateMachine=function(a,b){var c=a,d=new w.Desc(this,"withStateMachine",[a,b]);return Q(d,this.withHandler(function(a){var d=b(c,a),e=d[0],f=d[1];c=e;for(var g,h=w.more,i=0;i<f.length;i++)if(g=f[i],h=this.push(g),h===w.noMore)return h;return h}))};var oa=function(a,b){return a===b},pa=function(a){return"undefined"!=typeof a&&null!==a?a._isNone:!1};w.Observable.prototype.skipDuplicates=function(){var a=arguments.length<=0||void 0===arguments[0]?oa:arguments[0],b=new w.Desc(this,"skipDuplicates",[]);return Q(b,this.withStateMachine(ba,function(b,c){return c.hasValue()?c.isInitial()||pa(b)||!a(b.get(),c.value())?[new h(c.value()),[c]]:[b,[]]:[b,[c]]}))},w.Observable.prototype.awaiting=function(a){var b=new w.Desc(this,"awaiting",[a]);return Q(b,w.groupSimultaneous(this,a).map(function(a){return 0===a[1].length}).toProperty(!1).skipDuplicates())},w.Observable.prototype.not=function(){return Q(new w.Desc(this,"not",[]),this.map(function(a){return!a}))},w.Property.prototype.and=function(a){return Q(new w.Desc(this,"and",[a]),this.combine(a,function(a,b){return a&&b}))},w.Property.prototype.or=function(a){return Q(new w.Desc(this,"or",[a]),this.combine(a,function(a,b){return a||b}))},w.scheduler={setTimeout:function(a,b){return setTimeout(a,b)},setInterval:function(a,b){return setInterval(a,b)},clearInterval:function(a){return clearInterval(a)},clearTimeout:function(a){return clearTimeout(a)},now:function(){return(new Date).getTime()}},w.EventStream.prototype.bufferWithTime=function(a){return Q(new w.Desc(this,"bufferWithTime",[a]),this.bufferWithTimeOrCount(a,Number.MAX_VALUE))},w.EventStream.prototype.bufferWithCount=function(a){return Q(new w.Desc(this,"bufferWithCount",[a]),this.bufferWithTimeOrCount(void 0,a))},w.EventStream.prototype.bufferWithTimeOrCount=function(a,b){var c=function(c){return c.values.length===b?c.flush():void 0!==a?c.schedule():void 0},d=new w.Desc(this,"bufferWithTimeOrCount",[a,b]);return Q(d,this.buffer(a,c,c))},w.EventStream.prototype.buffer=function(a){var b=arguments.length<=1||void 0===arguments[1]?y:arguments[1],c=arguments.length<=2||void 0===arguments[2]?y:arguments[2],d={scheduled:null,end:void 0,values:[],flush:function(){if(this.scheduled&&(w.scheduler.clearTimeout(this.scheduled),this.scheduled=null),this.values.length>0){var a=this.values;this.values=[];var b=this.push(fa(a));if(null!=this.end)return this.push(this.end);if(b!==w.noMore)return c(this)}else if(null!=this.end)return this.push(this.end)},schedule:function(){var b=this;return this.scheduled?void 0:this.scheduled=a(function(){return b.flush()})}},e=w.more;if(!M.isFunction(a)){var f=a;a=function(a){return w.scheduler.setTimeout(a,f)}}return Q(new w.Desc(this,"buffer",[]),this.withHandler(function(a){var c=this;return d.push=function(a){return c.push(a)},a.isError()?e=this.push(a):a.isEnd()?(d.end=a,d.scheduled||d.flush()):(d.values.push(a.value()),b(d)),e}))},w.Observable.prototype.filter=function(a){C(a);for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;b>d;d++)c[d-1]=arguments[d];return $(this,a,c,function(a){return Q(new w.Desc(this,"filter",[a]),this.withHandler(function(b){return b.filter(a)?this.push(b):w.more}))})},w.once=function(a){return new q(new g(w,"once",[a]),function(b){return b(ha(a)),b(ga()),y})},w.EventStream.prototype.concat=function(a){var b=this;return new q(new w.Desc(b,"concat",[a]),function(c){var d=y,e=b.dispatcher.subscribe(function(b){return b.isEnd()?d=a.dispatcher.subscribe(c):c(b)});return function(){return e(),d()}})},w.Observable.prototype.flatMap=function(){return sa(this,qa(arguments))},w.Observable.prototype.flatMapFirst=function(){return sa(this,qa(arguments),!0)};var qa=function(a){return 1===a.length&&H(a[0])?M.always(a[0]):T(a)},ra=function(a){return H(a)?a:w.once(a)},sa=function(a,b,c,d){var e=[a],f=[],g=new w.Desc(a,"flatMap"+(c?"First":""),[b]),h=new q(g,function(e){var g=new o,h=[],i=function(a){var c=ra(b(a.value()));return f.push(c),g.add(function(a,b){return c.dispatcher.subscribe(function(d){if(d.isEnd())return M.remove(c,f),j(),k(b),w.noMore;("undefined"!=typeof d&&null!==d?d._isInitial:void 0)&&(d=d.toNext());var g=e(d);return g===w.noMore&&a(),g})})},j=function(){var a=h.shift();return a?i(a):void 0},k=function(a){return a(),g.empty()?e(ga()):void 0};return g.add(function(b,f){return a.dispatcher.subscribe(function(a){return a.isEnd()?k(f):a.isError()?e(a):c&&g.count()>1?w.more:g.unsubscribed?w.noMore:d&&g.count()>d?h.push(a):i(a)})}),g.unsubscribe});return h.internalDeps=function(){return f.length?e.concat(f):e},h};w.Observable.prototype.flatMapWithConcurrencyLimit=function(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;b>d;d++)c[d-1]=arguments[d];var e=new w.Desc(this,"flatMapWithConcurrencyLimit",[a].concat(c));return Q(e,sa(this,qa(c),!1,a))},w.Observable.prototype.flatMapConcat=function(){var a=new w.Desc(this,"flatMapConcat",Array.prototype.slice.call(arguments,0));return Q(a,this.flatMapWithConcurrencyLimit.apply(this,[1].concat(v.call(arguments))))},w.later=function(a,b){return Q(new w.Desc(w,"later",[a,b]),w.fromBinder(function(c){var d=function(){return c([b,ga()])},e=w.scheduler.setTimeout(d,a);return function(){return w.scheduler.clearTimeout(e)}}))},w.Observable.prototype.bufferingThrottle=function(a){var b=new w.Desc(this,"bufferingThrottle",[a]);return Q(b,this.flatMapConcat(function(b){return w.once(b).concat(w.later(a).filter(!1))}))},w.Property.prototype.bufferingThrottle=function(){return w.Observable.prototype.bufferingThrottle.apply(this,arguments).toProperty()},L(t,q),K(t.prototype,{unsubAll:function(){for(var a,b=this.subscriptions,c=0;c<b.length;c++)a=b[c],"function"==typeof a.unsub&&a.unsub()},subscribeAll:function(a){if(this.ended)a(ga());else{this.sink=a;for(var b,c=A(this.subscriptions),d=0;d<c.length;d++)b=c[d],this.subscribeInput(b)}return this.unsubAll},guardedSink:function(a){var b=this;return function(c){return c.isEnd()?(b.unsubscribeInput(a),w.noMore):b.sink(c)}},subscribeInput:function(a){return a.unsub=a.input.dispatcher.subscribe(this.guardedSink(a.input)),a.unsub},unsubscribeInput:function(a){for(var b,c=this.subscriptions,d=0;d<c.length;d++)if(b=c[d],b.input===a)return"function"==typeof b.unsub&&b.unsub(),void this.subscriptions.splice(d,1)},plug:function(a){var b=this;if(E(a),!this.ended){var c={input:a};return this.subscriptions.push(c),"undefined"!=typeof this.sink&&this.subscribeInput(c),function(){return b.unsubscribeInput(a)}}},end:function(){return this.ended=!0,this.unsubAll(),"function"==typeof this.sink?this.sink(ga()):void 0},push:function(a){return this.ended||"function"!=typeof this.sink?void 0:this.sink(fa(a))},error:function(a){return"function"==typeof this.sink?this.sink(new m(a)):void 0}}),w.Bus=t;var ta=function(a,b){return S(function(c){for(var d=U(b,[function(a,b){return c.apply(void 0,a.concat([b]))}]),e=arguments.length,f=Array(e>1?e-1:0),g=1;e>g;g++)f[g-1]=arguments[g];return Q(new w.Desc(w,a,[c].concat(f)),w.combineAsArray(f).flatMap(d))})};w.fromCallback=ta("fromCallback",function(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;b>d;d++)c[d-1]=arguments[d];return w.fromBinder(function(b){return Z(a,c)(b),y},function(a){return[a,ga()]})}),w.fromNodeCallback=ta("fromNodeCallback",function(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;b>d;d++)c[d-1]=arguments[d];return w.fromBinder(function(b){return Z(a,c)(b),y},function(a,b){return a?[new m(a),ga()]:[b,ga()]})}),w.combineTemplate=function(a){function b(a){return a[a.length-1]}function c(a,c,d){return b(a)[c]=d,d}function d(a,b){return function(d,e){return c(d,a,e[b])}}function e(a,b){return function(d){return c(d,a,b)}}function f(a){return G(a)?[]:{}}function g(a,b){return function(d){var e=f(b);return c(d,a,e),d.push(e)}}function h(a,b){if(H(b))return l.push(b),k.push(d(a,l.length-1));if(!b||b.constructor!=Object&&b.constructor!=Array)return k.push(e(a,b));var c=function(a){return a.pop()};return k.push(g(a,b)),j(b),k.push(c)}function i(b){for(var c,d=f(a),e=[d],g=0;g<k.length;g++)(c=k[g])(e,b);return d}function j(a){return M.each(a,h)}var k=[],l=[];return j(a),Q(new w.Desc(w,"combineTemplate",[a]),w.combineAsArray(l).map(i))};var ua=function(a,b){var c=new q(P(a,"justInitValue"),function(b){var d=void 0,e=a.dispatcher.subscribe(function(a){return a.isEnd()||(d=a),w.noMore});return O.whenDoneWith(c,function(){return"undefined"!=typeof d&&null!==d&&b(d),b(ga())}),e});return c.concat(b).toProperty()};w.Observable.prototype.mapEnd=function(){var a=T(arguments);return Q(new w.Desc(this,"mapEnd",[a]),this.withHandler(function(b){return b.isEnd()?(this.push(fa(a(b))),this.push(ga()),w.noMore):this.push(b)}))},w.Observable.prototype.skipErrors=function(){return Q(new w.Desc(this,"skipErrors",[]),this.withHandler(function(a){return a.isError()?w.more:this.push(a)}))},w.EventStream.prototype.takeUntil=function(a){var b={};return Q(new w.Desc(this,"takeUntil",[a]),w.groupSimultaneous(this.mapEnd(b),a.skipErrors()).withHandler(function(a){if(a.hasValue()){var c=a.value(),d=c[0],e=c[1];if(e.length)return this.push(ga());for(var f,g=w.more,h=0;h<d.length;h++)f=d[h],g=f===b?this.push(ga()):this.push(fa(f));return g}return this.push(a)}))},w.Property.prototype.takeUntil=function(a){var b=this.changes().takeUntil(a);return Q(new w.Desc(this,"takeUntil",[a]),ua(this,b))},w.Observable.prototype.flatMapLatest=function(){var a=qa(arguments),b=this.toEventStream();return Q(new w.Desc(this,"flatMapLatest",[a]),b.flatMap(function(c){return ra(a(c)).takeUntil(b)}))},w.Property.prototype.delayChanges=function(a,b){return Q(a,ua(this,b(this.changes())))},w.EventStream.prototype.delay=function(a){return Q(new w.Desc(this,"delay",[a]),this.flatMap(function(b){return w.later(a,b)}))},w.Property.prototype.delay=function(a){return this.delayChanges(new w.Desc(this,"delay",[a]),function(b){return b.delay(a)})},w.EventStream.prototype.debounce=function(a){return Q(new w.Desc(this,"debounce",[a]),this.flatMapLatest(function(b){return w.later(a,b)}))},w.Property.prototype.debounce=function(a){return this.delayChanges(new w.Desc(this,"debounce",[a]),function(b){return b.debounce(a)})},w.EventStream.prototype.debounceImmediate=function(a){return Q(new w.Desc(this,"debounceImmediate",[a]),this.flatMapFirst(function(b){return w.once(b).concat(w.later(a).filter(!1))}))},w.Property.prototype.debounceImmediate=function(a){return this.delayChanges(new w.Desc(this,"debounceImmediate",[a]),function(b){return b.debounceImmediate(a)})},w.Observable.prototype.decode=function(a){return Q(new w.Desc(this,"decode",[a]),this.combine(w.combineTemplate(a),function(a,b){return b[a]}))},w.Observable.prototype.scan=function(a,b){var c,d=this;b=_(b);var e=ca(a),f=!1,g=function(a){var g=!1,i=y,j=w.more,l=function(){return g?void 0:e.forEach(function(b){return g=f=!0,j=a(new k(function(){return b})),j===w.noMore?(i(),i=y):void 0})};return i=d.dispatcher.subscribe(function(c){if(c.hasValue()){if(f&&c.isInitial())return w.more;c.isInitial()||l(),g=f=!0;var d=e.getOrElse(void 0),i=b(d,c.value());return e=new h(i),a(c.apply(function(){return i}))}return c.isEnd()&&(j=l()),j!==w.noMore?a(c):void 0}),O.whenDoneWith(c,l),i};return c=new s(new w.Desc(this,"scan",[a,b]),g)},w.Observable.prototype.diff=function(a,b){return b=_(b),Q(new w.Desc(this,"diff",[a,b]),this.scan([a],function(a,c){return[c,b(a[0],c)]}).filter(function(a){return 2===a.length}).map(function(a){return a[1]}))},w.Observable.prototype.doAction=function(){var a=T(arguments);return Q(new w.Desc(this,"doAction",[a]),this.withHandler(function(b){return b.hasValue()&&a(b.value()),this.push(b)}))},w.Observable.prototype.doEnd=function(){var a=T(arguments);return Q(new w.Desc(this,"doEnd",[a]),this.withHandler(function(b){return b.isEnd()&&a(),this.push(b)}))},w.Observable.prototype.doError=function(){var a=T(arguments);return Q(new w.Desc(this,"doError",[a]),this.withHandler(function(b){return b.isError()&&a(b.error),this.push(b)}))},w.Observable.prototype.doLog=function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];return Q(new w.Desc(this,"doLog",b),this.withHandler(function(a){return"undefined"!=typeof console&&null!==console&&"function"==typeof console.log&&console.log.apply(console,b.concat([a.log()])),this.push(a)}))},w.Observable.prototype.endOnError=function(a){("undefined"==typeof a||null===a)&&(a=!0);for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;b>d;d++)c[d-1]=arguments[d];return $(this,a,c,function(a){return Q(new w.Desc(this,"endOnError",[]),this.withHandler(function(b){return b.isError()&&a(b.error)?(this.push(b),this.push(ga())):this.push(b)}))})},n.prototype.errors=function(){return Q(new w.Desc(this,"errors",[]),this.filter(function(){return!1}))},w.Observable.prototype.take=function(a){return 0>=a?w.never():Q(new w.Desc(this,"take",[a]),this.withHandler(function(b){return b.hasValue()?(a--,a>0?this.push(b):(0===a&&this.push(b),this.push(ga()),w.noMore)):this.push(b)}))},w.Observable.prototype.first=function(){return Q(new w.Desc(this,"first",[]),this.take(1))},w.Observable.prototype.mapError=function(){var a=T(arguments);return Q(new w.Desc(this,"mapError",[a]),this.withHandler(function(b){return b.isError()?this.push(fa(a(b.error))):this.push(b)}))},w.Observable.prototype.flatMapError=function(a){var b=new w.Desc(this,"flatMapError",[a]);return Q(b,this.mapError(function(a){return new m(a)}).flatMap(function(b){return b instanceof m?a(b.error):w.once(b)}))},w.EventStream.prototype.sampledBy=function(a,b){return Q(new w.Desc(this,"sampledBy",[a,b]),this.toProperty().sampledBy(a,b))},w.Property.prototype.sampledBy=function(a,b){var c=!1;"undefined"!=typeof b&&null!==b?b=_(b):(c=!0,b=function(a){return a.value()});var e=new d(this,!1,c),f=new d(a,!0,c),g=w.when([e,f],b),h=a._isProperty?g.toProperty():g;return Q(new w.Desc(this,"sampledBy",[a,b]),h)},w.Property.prototype.sample=function(a){return Q(new w.Desc(this,"sample",[a]),this.sampledBy(w.interval(a,{})))},w.Observable.prototype.map=function(a){if(a&&a._isProperty)return a.sampledBy(this,z);for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;b>d;d++)c[d-1]=arguments[d];return $(this,a,c,function(a){return Q(new w.Desc(this,"map",[a]),this.withHandler(function(b){return this.push(b.fmap(a))}))})},w.Observable.prototype.fold=function(a,b){return Q(new w.Desc(this,"fold",[a,b]),this.scan(a,b).sampledBy(this.filter(!1).mapEnd().toProperty()))},n.prototype.reduce=n.prototype.fold;var va=[["addEventListener","removeEventListener"],["addListener","removeListener"],["on","off"],["bind","unbind"]],wa=function(a){for(var b,c=0;c<va.length;c++){b=va[c];var d=[a[b[0]],a[b[1]]];if(d[0]&&d[1])return d}for(var e=0;e<va.length;e++){b=va[e];var f=a[b[0]];if(f)return[f,function(){}]}throw new m("No suitable event methods in "+a)};w.fromEventTarget=function(a,b,c){var d=wa(a),e=d[0],f=d[1],g=new w.Desc(w,"fromEvent",[a,b]);return Q(g,w.fromBinder(function(c){return e.call(a,b,c),function(){return f.call(a,b,c)}},c))},w.fromEvent=w.fromEventTarget,w.fromPoll=function(a,b){var c=new w.Desc(w,"fromPoll",[a,b]);return Q(c,w.fromBinder(function(b){var c=w.scheduler.setInterval(b,a);return function(){return w.scheduler.clearInterval(c)}},b))},w.fromPromise=function(a,b){var c=arguments.length<=2||void 0===arguments[2]?u:arguments[2];return Q(new w.Desc(w,"fromPromise",[a]),w.fromBinder(function(c){var d=a.then(c,function(a){return c(new m(a))});return d&&"function"==typeof d.done&&d.done(),b?function(){return"function"==typeof a.abort?a.abort():void 0}:function(){}},c))},w.Observable.prototype.groupBy=function(a){var b=arguments.length<=1||void 0===arguments[1]?w._.id:arguments[1],c={},d=this;return d.filter(function(b){return!c[a(b)]}).map(function(e){var f=a(e),g=d.filter(function(b){return a(b)===f}),h=w.once(e).concat(g),i=b(h,e).withHandler(function(a){return this.push(a),a.isEnd()?delete c[f]:void 0});return c[f]=i,i})},w.fromArray=function(a){if(I(a),a.length){var b=0;return new q(new w.Desc(w,"fromArray",[a]),function(c){var d=!1,e=w.more,f=!1,g=!1,h=function(){if(g=!0,!f){for(f=!0;g;)if(g=!1,e!==w.noMore&&!d){var i=a[b++];e=c(ha(i)),e!==w.noMore&&(b===a.length?c(ga()):O.afterTransaction(h))}return f=!1}};return h(),function(){return d=!0}})}return Q(new w.Desc(w,"fromArray",a),w.never())},w.EventStream.prototype.holdWhen=function(a){var b=!1,c=[],d=this,e=!1;return new q(new w.Desc(this,"holdWhen",[a]),function(f){var g=new o,h=!1,i=function(a){return"function"==typeof a&&a(),g.empty()&&h?f(ga()):void 0};return g.add(function(d,g){return a.subscribeInternal(function(a){if(!a.hasValue())return a.isEnd()?i(g):f(a);if(b=a.value(),!b){var d=c;return c=[],function(){for(var a,b=[],c=0;c<d.length;c++)a=d[c],b.push(f(fa(a)));return e&&(b.push(f(ga())),g()),b}()}})}),g.add(function(a,g){return d.subscribeInternal(function(a){return b&&a.hasValue()?c.push(a.value()):a.isEnd()&&c.length?(e=!0,i(g)):f(a)})}),h=!0,i(),g.unsubscribe})},w.interval=function(a){var b=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return Q(new w.Desc(w,"interval",[a,b]),w.fromPoll(a,function(){return fa(b)}))},w.$={},w.$.asEventStream=function(a,b,c){var d=this;return M.isFunction(b)&&(c=b,b=void 0),Q(new w.Desc(this.selector||this,"asEventStream",[a]),w.fromBinder(function(c){return d.on(a,b,c),function(){return d.off(a,b,c)}},c))},"undefined"!=typeof jQuery&&jQuery&&(jQuery.fn.asEventStream=w.$.asEventStream),"undefined"!=typeof Zepto&&Zepto&&(Zepto.fn.asEventStream=w.$.asEventStream),w.Observable.prototype.last=function(){var a;return Q(new w.Desc(this,"last",[]),this.withHandler(function(b){return b.isEnd()?(a&&this.push(a),this.push(ga()),w.noMore):void(a=b)}))},w.Observable.prototype.log=function(){
for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];return this.subscribe(function(a){"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,b.concat([a.log()]))}),this},w.EventStream.prototype.merge=function(a){D(a);var b=this;return Q(new w.Desc(b,"merge",[a]),w.mergeAll(this,a))},w.mergeAll=function(){var a=ma(arguments);return a.length?new q(new w.Desc(w,"mergeAll",a),function(b){var c=0,d=function(d){return function(e){return d.dispatcher.subscribe(function(d){if(d.isEnd())return c++,c===a.length?b(ga()):w.more;var f=b(d);return f===w.noMore&&e(),f})}},e=M.map(d,a);return new w.CompositeUnsubscribe(e).unsubscribe}):w.never()},w.repeatedly=function(a,b){var c=0;return Q(new w.Desc(w,"repeatedly",[a,b]),w.fromPoll(a,function(){return b[c++%b.length]}))},w.repeat=function(a){var b=0;return w.fromBinder(function(c){function d(a){return a.isEnd()?f?e():f=!0:g=c(a)}function e(){var e;for(f=!0;f&&g!==w.noMore;)e=a(b++),f=!1,e?h=e.subscribeInternal(d):c(ga());return f=!0}var f=!1,g=w.more,h=function(){};return e(),function(){return h()}})},w.retry=function(a){if(!M.isFunction(a.source))throw new x("'source' option has to be a function");var b=a.source,c=a.retries||0,d=0,e=a.delay||function(){return 0},f=a.isRetryable||function(){return!0},g=!1,h=null;return Q(new w.Desc(w,"retry",[a]),w.repeat(function(){function a(){return b().endOnError().withHandler(function(a){return a.isError()?(h=a,f(h.error)&&(0===c||c>d)?void 0:(g=!0,this.push(a))):(a.hasValue()&&(h=null,g=!0),this.push(a))})}if(g)return null;if(h){var i={error:h.error,retriesDone:d},j=w.later(e(i)).filter(!1);return d++,j.concat(w.once().flatMap(a))}return a()}))},w.sequentially=function(a,b){var c=0;return Q(new w.Desc(w,"sequentially",[a,b]),w.fromPoll(a,function(){var a=b[c++];return c<b.length?a:c===b.length?[a,ga()]:ga()}))},w.Observable.prototype.skip=function(a){return Q(new w.Desc(this,"skip",[a]),this.withHandler(function(b){return b.hasValue()&&a>0?(a--,w.more):this.push(b)}))},w.EventStream.prototype.skipUntil=function(a){var b=a.take(1).map(!0).toProperty(!1);return Q(new w.Desc(this,"skipUntil",[a]),this.filter(b))},w.EventStream.prototype.skipWhile=function(a){C(a);for(var b=!1,c=arguments.length,d=Array(c>1?c-1:0),e=1;c>e;e++)d[e-1]=arguments[e];return $(this,a,d,function(a){return Q(new w.Desc(this,"skipWhile",[a]),this.withHandler(function(c){return!b&&c.hasValue()&&a(c.value())?w.more:(c.hasValue()&&(b=!0),this.push(c))}))})},w.Observable.prototype.slidingWindow=function(a){var b=arguments.length<=1||void 0===arguments[1]?0:arguments[1];return Q(new w.Desc(this,"slidingWindow",[a,b]),this.scan([],function(b,c){return b.concat([c]).slice(-a)}).filter(function(a){return a.length>=b}))};var xa=[],ja=function(a){if(xa.length&&!ja.running)try{ja.running=!0,xa.forEach(function(b){b(a)})}finally{delete ja.running}};w.spy=function(a){return xa.push(a)},w.Property.prototype.startWith=function(a){return Q(new w.Desc(this,"startWith",[a]),this.scan(a,function(a,b){return b}))},w.EventStream.prototype.startWith=function(a){return Q(new w.Desc(this,"startWith",[a]),w.once(a).concat(this))},w.Observable.prototype.takeWhile=function(a){C(a);for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;b>d;d++)c[d-1]=arguments[d];return $(this,a,c,function(a){return Q(new w.Desc(this,"takeWhile",[a]),this.withHandler(function(b){return b.filter(a)?this.push(b):(this.push(ga()),w.noMore)}))})},w.EventStream.prototype.throttle=function(a){return Q(new w.Desc(this,"throttle",[a]),this.bufferWithTime(a).map(function(a){return a[a.length-1]}))},w.Property.prototype.throttle=function(a){return this.delayChanges(new w.Desc(this,"throttle",[a]),function(b){return b.throttle(a)})},n.prototype.firstToPromise=function(a){var b=this;if("function"!=typeof a){if("function"!=typeof Promise)throw new x("There isn't default Promise, use shim or parameter");a=Promise}return new a(function(a,c){return b.subscribe(function(b){return b.hasValue()&&a(b.value()),b.isError()&&c(b.error),w.noMore})})},n.prototype.toPromise=function(a){return this.last().firstToPromise(a)},w["try"]=function(a){return function(b){try{return w.once(a(b))}catch(c){return new w.Error(c)}}},w.update=function(a){function b(a){return function(){for(var b=arguments.length,c=Array(b),d=0;b>d;d++)c[d]=arguments[d];return function(b){return a.apply(void 0,[b].concat(c))}}}for(var c=arguments.length,d=Array(c>1?c-1:0),e=1;c>e;e++)d[e-1]=arguments[e];for(var f=d.length-1;f>0;)d[f]instanceof Function||(d[f]=M.always(d[f])),d[f]=b(d[f]),f-=2;return Q(new w.Desc(w,"update",[a].concat(d)),w.when.apply(w,d).scan(a,function(a,b){return b(a)}))},w.zipAsArray=function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];var d=ma(b);return Q(new w.Desc(w,"zipAsArray",d),w.zipWith(d,function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];return b}))},w.zipWith=function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];var d=na(b),e=d[0],f=d[1];return e=M.map(function(a){return a.toEventStream()},e),Q(new w.Desc(w,"zipWith",[f].concat(e)),w.when(e,f))},w.Observable.prototype.zip=function(a,b){return Q(new w.Desc(this,"zip",[a]),w.zipWith([this,a],b||Array))},"undefined"!=typeof a&&null!==a&&null!=a.amd?(a([],function(){return w}),"undefined"!=typeof this&&null!==this&&(this.Bacon=w)):"undefined"!=typeof c&&null!==c&&null!=c.exports?(c.exports=w,w.Bacon=w):this.Bacon=w}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],35:[function(b,c,d){!function(b,e){"object"==typeof d&&"undefined"!=typeof c?e(d):"function"==typeof a&&a.amd?a(["exports"],e):e(b.d3=b.d3||{})}(this,function(a){"use strict";function b(a){return function(b,c){return e(a(b),c)}}function c(a,b,c){var d=Math.abs(b-a)/Math.max(0,c),e=Math.pow(10,Math.floor(Math.log(d)/Math.LN10)),f=d/e;return f>=u?e*=10:f>=v?e*=5:f>=w&&(e*=2),a>b?-e:e}function d(a){return a.length}var e=function(a,b){return b>a?-1:a>b?1:a>=b?0:NaN},f=function(a){return 1===a.length&&(a=b(a)),{left:function(b,c,d,e){for(null==d&&(d=0),null==e&&(e=b.length);e>d;){var f=d+e>>>1;a(b[f],c)<0?d=f+1:e=f}return d},right:function(b,c,d,e){for(null==d&&(d=0),null==e&&(e=b.length);e>d;){var f=d+e>>>1;a(b[f],c)>0?e=f:d=f+1}return d}}},g=f(e),h=g.right,i=g.left,j=function(a,b){return a>b?-1:b>a?1:b>=a?0:NaN},k=function(a){return null===a?NaN:+a},l=function(a,b){var c,d,e=a.length,f=0,g=0,h=-1,i=0;if(null==b)for(;++h<e;)isNaN(c=k(a[h]))||(d=c-f,f+=d/++i,g+=d*(c-f));else for(;++h<e;)isNaN(c=k(b(a[h],h,a)))||(d=c-f,f+=d/++i,g+=d*(c-f));return i>1?g/(i-1):void 0},m=function(a,b){var c=l(a,b);return c?Math.sqrt(c):c},n=function(a,b){var c,d,e,f=-1,g=a.length;if(null==b){for(;++f<g;)if(null!=(d=a[f])&&d>=d){c=e=d;break}for(;++f<g;)null!=(d=a[f])&&(c>d&&(c=d),d>e&&(e=d))}else{for(;++f<g;)if(null!=(d=b(a[f],f,a))&&d>=d){c=e=d;break}for(;++f<g;)null!=(d=b(a[f],f,a))&&(c>d&&(c=d),d>e&&(e=d))}return[c,e]},o=Array.prototype,p=o.slice,q=o.map,r=function(a){return function(){return a}},s=function(a){return a},t=function(a,b,c){a=+a,b=+b,c=(e=arguments.length)<2?(b=a,a=0,1):3>e?1:+c;for(var d=-1,e=0|Math.max(0,Math.ceil((b-a)/c)),f=new Array(e);++d<e;)f[d]=a+d*c;return f},u=Math.sqrt(50),v=Math.sqrt(10),w=Math.sqrt(2),x=function(a,b,d){var e=c(a,b,d);return t(Math.ceil(a/e)*e,Math.floor(b/e)*e+e/2,e)},y=function(a){return Math.ceil(Math.log(a.length)/Math.LN2)+1},z=function(){function a(a){var e,f,g=a.length,i=new Array(g);for(e=0;g>e;++e)i[e]=b(a[e],e,a);var j=c(i),k=j[0],l=j[1],m=d(i,k,l);Array.isArray(m)||(m=x(k,l,m));for(var n=m.length;m[0]<=k;)m.shift(),--n;for(;m[n-1]>=l;)m.pop(),--n;var o,p=new Array(n+1);for(e=0;n>=e;++e)o=p[e]=[],o.x0=e>0?m[e-1]:k,o.x1=n>e?m[e]:l;for(e=0;g>e;++e)f=i[e],f>=k&&l>=f&&p[h(m,f,0,n)].push(a[e]);return p}var b=s,c=n,d=y;return a.value=function(c){return arguments.length?(b="function"==typeof c?c:r(c),a):b},a.domain=function(b){return arguments.length?(c="function"==typeof b?b:r([b[0],b[1]]),a):c},a.thresholds=function(b){return arguments.length?(d="function"==typeof b?b:r(Array.isArray(b)?p.call(b):b),a):d},a},A=function(a,b,c){if(null==c&&(c=k),d=a.length){if((b=+b)<=0||2>d)return+c(a[0],0,a);if(b>=1)return+c(a[d-1],d-1,a);var d,e=(d-1)*b,f=Math.floor(e),g=+c(a[f],f,a),h=+c(a[f+1],f+1,a);return g+(h-g)*(e-f)}},B=function(a,b,c){return a=q.call(a,k).sort(e),Math.ceil((c-b)/(2*(A(a,.75)-A(a,.25))*Math.pow(a.length,-1/3)))},C=function(a,b,c){return Math.ceil((c-b)/(3.5*m(a)*Math.pow(a.length,-1/3)))},D=function(a,b){var c,d,e=-1,f=a.length;if(null==b){for(;++e<f;)if(null!=(d=a[e])&&d>=d){c=d;break}for(;++e<f;)null!=(d=a[e])&&d>c&&(c=d)}else{for(;++e<f;)if(null!=(d=b(a[e],e,a))&&d>=d){c=d;break}for(;++e<f;)null!=(d=b(a[e],e,a))&&d>c&&(c=d)}return c},E=function(a,b){var c,d=0,e=a.length,f=-1,g=e;if(null==b)for(;++f<e;)isNaN(c=k(a[f]))?--g:d+=c;else for(;++f<e;)isNaN(c=k(b(a[f],f,a)))?--g:d+=c;return g?d/g:void 0},F=function(a,b){var c,d=[],f=a.length,g=-1;if(null==b)for(;++g<f;)isNaN(c=k(a[g]))||d.push(c);else for(;++g<f;)isNaN(c=k(b(a[g],g,a)))||d.push(c);return A(d.sort(e),.5)},G=function(a){for(var b,c,d,e=a.length,f=-1,g=0;++f<e;)g+=a[f].length;for(c=new Array(g);--e>=0;)for(d=a[e],b=d.length;--b>=0;)c[--g]=d[b];return c},H=function(a,b){var c,d,e=-1,f=a.length;if(null==b){for(;++e<f;)if(null!=(d=a[e])&&d>=d){c=d;break}for(;++e<f;)null!=(d=a[e])&&c>d&&(c=d)}else{for(;++e<f;)if(null!=(d=b(a[e],e,a))&&d>=d){c=d;break}for(;++e<f;)null!=(d=b(a[e],e,a))&&c>d&&(c=d)}return c},I=function(a){for(var b=0,c=a.length-1,d=a[0],e=new Array(0>c?0:c);c>b;)e[b]=[d,d=a[++b]];return e},J=function(a,b){for(var c=b.length,d=new Array(c);c--;)d[c]=a[b[c]];return d},K=function(a,b){if(c=a.length){var c,d,f=0,g=0,h=a[g];for(b||(b=e);++f<c;)(b(d=a[f],h)<0||0!==b(h,h))&&(h=d,g=f);return 0===b(h,h)?g:void 0}},L=function(a,b,c){for(var d,e,f=(null==c?a.length:c)-(b=null==b?0:+b);f;)e=Math.random()*f--|0,d=a[f+b],a[f+b]=a[e+b],a[e+b]=d;return a},M=function(a,b){var c,d=0,e=a.length,f=-1;if(null==b)for(;++f<e;)(c=+a[f])&&(d+=c);else for(;++f<e;)(c=+b(a[f],f,a))&&(d+=c);return d},N=function(a){if(!(f=a.length))return[];for(var b=-1,c=H(a,d),e=new Array(c);++b<c;)for(var f,g=-1,h=e[b]=new Array(f);++g<f;)h[g]=a[g][b];return e},O=function(){return N(arguments)};a.bisect=h,a.bisectRight=h,a.bisectLeft=i,a.ascending=e,a.bisector=f,a.descending=j,a.deviation=m,a.extent=n,a.histogram=z,a.thresholdFreedmanDiaconis=B,a.thresholdScott=C,a.thresholdSturges=y,a.max=D,a.mean=E,a.median=F,a.merge=G,a.min=H,a.pairs=I,a.permute=J,a.quantile=A,a.range=t,a.scan=K,a.shuffle=L,a.sum=M,a.ticks=x,a.tickStep=c,a.transpose=N,a.variance=l,a.zip=O,Object.defineProperty(a,"__esModule",{value:!0})})},{}],36:[function(b,c,d){!function(e,f){"object"==typeof d&&"undefined"!=typeof c?f(d,b("d3-dispatch"),b("d3-drag"),b("d3-interpolate"),b("d3-selection"),b("d3-transition")):"function"==typeof a&&a.amd?a(["exports","d3-dispatch","d3-drag","d3-interpolate","d3-selection","d3-transition"],f):f(e.d3=e.d3||{},e.d3,e.d3,e.d3,e.d3,e.d3)}(this,function(a,b,c,d,e,f){"use strict";function g(){e.event.stopImmediatePropagation()}function h(a){return{type:a}}function i(){return!e.event.button}function j(){var a=this.ownerSVGElement||this;return[[0,0],[a.width.baseVal.value,a.height.baseVal.value]]}function k(a){for(;!a.__brush;)if(!(a=a.parentNode))return;return a.__brush}function l(a){return a[0][0]===a[1][0]||a[0][1]===a[1][1]}function m(a){var b=a.__brush;return b?b.dim.output(b.selection):null}function n(){return p(x)}function o(){return p(y)}function p(a){function m(b){var c=b.property("__brush",F).selectAll(".overlay").data([h("overlay")]);c.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",A.overlay).merge(c).each(function(){var a=k(this).extent;e.select(this).attr("x",a[0][0]).attr("y",a[0][1]).attr("width",a[1][0]-a[0][0]).attr("height",a[1][1]-a[0][1])}),b.selectAll(".selection").data([h("selection")]).enter().append("rect").attr("class","selection").attr("cursor",A.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var d=b.selectAll(".handle").data(a.handles,function(a){return a.type});d.exit().remove(),d.enter().append("rect").attr("class",function(a){return"handle handle--"+a.type}).attr("cursor",function(a){return A[a.type]}),b.each(n).attr("fill","none").attr("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush touchstart.brush",z)}function n(){var a=e.select(this),b=k(this).selection;b?(a.selectAll(".selection").style("display",null).attr("x",b[0][0]).attr("y",b[0][1]).attr("width",b[1][0]-b[0][0]).attr("height",b[1][1]-b[0][1]),a.selectAll(".handle").style("display",null).attr("x",function(a){return"e"===a.type[a.type.length-1]?b[1][0]-K/2:b[0][0]-K/2}).attr("y",function(a){return"s"===a.type[0]?b[1][1]-K/2:b[0][1]-K/2}).attr("width",function(a){return"n"===a.type||"s"===a.type?b[1][0]-b[0][0]+K:K}).attr("height",function(a){return"e"===a.type||"w"===a.type?b[1][1]-b[0][1]+K:K})):a.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function o(a,b){return a.__brush.emitter||new p(a,b)}function p(a,b){this.that=a,this.args=b,this.state=a.__brush,this.active=0}function z(){function b(){var a=e.mouse(P);!_||N||O||(Math.abs(a[0]-ba[0])>Math.abs(a[1]-ba[1])?O=!0:N=!0),ba=a,M=!0,s(),d()}function d(){var a;switch(K=ba[0]-aa[0],L=ba[1]-aa[1],R){case u:case t:S&&(K=Math.max(X-m,Math.min(Z-z,K)),p=m+K,F=z+K),T&&(L=Math.max(Y-q,Math.min($-H,L)),r=q+L,J=H+L);break;case v:0>S?(K=Math.max(X-m,Math.min(Z-m,K)),p=m+K,F=z):S>0&&(K=Math.max(X-z,Math.min(Z-z,K)),p=m,F=z+K),0>T?(L=Math.max(Y-q,Math.min($-q,L)),r=q+L,J=H):T>0&&(L=Math.max(Y-H,Math.min($-H,L)),r=q,J=H+L);break;case w:S&&(p=Math.max(X,Math.min(Z,m-K*S)),F=Math.max(X,Math.min(Z,z+K*S))),T&&(r=Math.max(Y,Math.min($,q-L*T)),J=Math.max(Y,Math.min($,H+L*T)))}p>F&&(S*=-1,a=m,m=z,z=a,a=p,p=F,F=a,Q in B&&ea.attr("cursor",A[Q=B[Q]])),r>J&&(T*=-1,a=q,q=H,H=a,a=r,r=J,J=a,Q in C&&ea.attr("cursor",A[Q=C[Q]])),U.selection&&(W=U.selection),N&&(p=W[0][0],F=W[1][0]),O&&(r=W[0][1],J=W[1][1]),(W[0][0]!==p||W[0][1]!==r||W[1][0]!==F||W[1][1]!==J)&&(U.selection=[[p,r],[F,J]],n.call(P),ca.brush())}function h(){if(g(),e.event.touches){if(e.event.touches.length)return;G&&clearTimeout(G),G=setTimeout(function(){G=null},500),da.on("touchmove.brush touchend.brush touchcancel.brush",null)}else c.dragEnable(e.event.view,M),fa.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);da.attr("pointer-events","all"),ea.attr("cursor",A.overlay),U.selection&&(W=U.selection),l(W)&&(U.selection=null,n.call(P)),ca.end()}function i(){switch(e.event.keyCode){case 16:_=S&&T;break;case 18:R===v&&(S&&(z=F-K*S,m=p+K*S),T&&(H=J-L*T,q=r+L*T),R=w,d());break;case 32:(R===v||R===w)&&(0>S?z=F-K:S>0&&(m=p-K),0>T?H=J-L:T>0&&(q=r-L),R=u,ea.attr("cursor",A.selection),d());break;default:return}s()}function j(){switch(e.event.keyCode){case 16:_&&(N=O=_=!1,d());break;case 18:R===w&&(0>S?z=F:S>0&&(m=p),0>T?H=J:T>0&&(q=r),R=v,d());break;case 32:R===u&&(e.event.altKey?(S&&(z=F-K*S,m=p+K*S),T&&(H=J-L*T,q=r+L*T),R=w):(0>S?z=F:S>0&&(m=p),0>T?H=J:T>0&&(q=r),R=v),ea.attr("cursor",A[Q]),d());break;default:return}s()}if(e.event.touches){if(e.event.changedTouches.length<e.event.touches.length)return s()}else if(G)return;if(I.apply(this,arguments)){var m,p,q,r,z,F,H,J,K,L,M,N,O,P=this,Q=e.event.target.__data__.type,R="selection"===(e.event.metaKey?Q="overlay":Q)?t:e.event.altKey?w:v,S=a===y?null:D[Q],T=a===x?null:E[Q],U=k(P),V=U.extent,W=U.selection,X=V[0][0],Y=V[0][1],Z=V[1][0],$=V[1][1],_=!1,aa=e.mouse(P),ba=aa,ca=o(P,arguments).beforestart();"overlay"===Q?U.selection=W=[[m=a===y?X:aa[0],q=a===x?Y:aa[1]],[z=a===y?Z:m,H=a===x?$:q]]:(m=W[0][0],q=W[0][1],z=W[1][0],H=W[1][1]),p=m,r=q,F=z,J=H;var da=e.select(P).attr("pointer-events","none"),ea=da.selectAll(".overlay").attr("cursor",A[Q]);if(e.event.touches)da.on("touchmove.brush",b,!0).on("touchend.brush touchcancel.brush",h,!0);else{var fa=e.select(e.event.view).on("keydown.brush",i,!0).on("keyup.brush",j,!0).on("mousemove.brush",b,!0).on("mouseup.brush",h,!0);c.dragDisable(e.event.view)}g(),f.interrupt(P),n.call(P),ca.start()}}function F(){var b=this.__brush||{selection:null};return b.extent=H.apply(this,arguments),b.dim=a,b}var G,H=j,I=i,J=b.dispatch(m,"start","brush","end"),K=6;return m.move=function(b,c){b.selection?b.on("start.brush",function(){o(this,arguments).beforestart().start()}).on("interrupt.brush end.brush",function(){o(this,arguments).end()}).tween("brush",function(){function b(a){f.selection=1===a&&l(i)?null:j(a),n.call(e),g.brush()}var e=this,f=e.__brush,g=o(e,arguments),h=f.selection,i=a.input("function"==typeof c?c.apply(this,arguments):c,f.extent),j=d.interpolate(h,i);return h&&i?b:b(1)}):b.each(function(){var b=this,d=arguments,e=b.__brush,g=a.input("function"==typeof c?c.apply(b,d):c,e.extent),h=o(b,d).beforestart();f.interrupt(b),e.selection=null==g||l(g)?null:g,n.call(b),h.start().brush().end()})},p.prototype={beforestart:function(){return 1===++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(){return this.starting&&(this.starting=!1,this.emit("start")),this},brush:function(){return this.emit("brush"),this},end:function(){return 0===--this.active&&(delete this.state.emitter,this.emit("end")),this},emit:function(b){e.customEvent(new r(m,b,a.output(this.state.selection)),J.apply,J,[b,this.that,this.args])}},m.extent=function(a){return arguments.length?(H="function"==typeof a?a:q([[+a[0][0],+a[0][1]],[+a[1][0],+a[1][1]]]),m):H},m.filter=function(a){return arguments.length?(I="function"==typeof a?a:q(!!a),m):I},m.handleSize=function(a){return arguments.length?(K=+a,m):K},m.on=function(){var a=J.on.apply(J,arguments);return a===J?m:a},m}var q=function(a){return function(){return a}},r=function(a,b,c){this.target=a,this.type=b,this.selection=c},s=function(){e.event.preventDefault(),e.event.stopImmediatePropagation()},t={name:"drag"},u={name:"space"},v={name:"handle"},w={name:"center"},x={name:"x",handles:["e","w"].map(h),input:function(a,b){return a&&[[a[0],b[0][1]],[a[1],b[1][1]]]},output:function(a){return a&&[a[0][0],a[1][0]]}},y={name:"y",handles:["n","s"].map(h),input:function(a,b){return a&&[[b[0][0],a[0]],[b[1][0],a[1]]]},output:function(a){return a&&[a[0][1],a[1][1]]}},z={name:"xy",handles:["n","e","s","w","nw","ne","se","sw"].map(h),input:function(a){return a},output:function(a){return a}},A={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},B={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},C={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},D={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},E={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1},F=function(){return p(z)};a.brush=F,a.brushX=n,a.brushY=o,a.brushSelection=m,Object.defineProperty(a,"__esModule",{value:!0})})},{"d3-dispatch":39,"d3-drag":40,"d3-interpolate":44,"d3-selection":47,"d3-transition":51}],37:[function(b,c,d){!function(b,e){"object"==typeof d&&"undefined"!=typeof c?e(d):"function"==typeof a&&a.amd?a(["exports"],e):e(b.d3=b.d3||{})}(this,function(a){"use strict";function b(){}function c(a,c){var d=new b;if(a instanceof b)a.each(function(a,b){d.set(b,a)});else if(Array.isArray(a)){var e,f=-1,g=a.length;if(null==c)for(;++f<g;)d.set(f,a[f]);else for(;++f<g;)d.set(c(e=a[f],f,a),e)}else if(a)for(var h in a)d.set(h,a[h]);return d}function d(){return{}}function e(a,b,c){a[b]=c}function f(){return c()}function g(a,b,c){a.set(b,c)}function h(){}function i(a,b){var c=new h;if(a instanceof h)a.each(function(a){c.add(a)});else if(a){var d=-1,e=a.length;if(null==b)for(;++d<e;)c.add(a[d]);else for(;++d<e;)c.add(b(a[d],d,a))}return c}var j="$";b.prototype=c.prototype={constructor:b,has:function(a){return j+a in this},get:function(a){return this[j+a]},set:function(a,b){return this[j+a]=b,this},remove:function(a){var b=j+a;return b in this&&delete this[b]},clear:function(){for(var a in this)a[0]===j&&delete this[a]},keys:function(){var a=[];for(var b in this)b[0]===j&&a.push(b.slice(1));return a},values:function(){var a=[];for(var b in this)b[0]===j&&a.push(this[b]);return a},entries:function(){var a=[];for(var b in this)b[0]===j&&a.push({key:b.slice(1),value:this[b]});return a},size:function(){var a=0;for(var b in this)b[0]===j&&++a;return a},empty:function(){for(var a in this)if(a[0]===j)return!1;return!0},each:function(a){for(var b in this)b[0]===j&&a(this[b],b.slice(1),this)}};var k=function(){function a(b,d,e,f){if(d>=k.length)return null!=i?i(b):null!=h?b.sort(h):b;for(var g,j,l,m=-1,n=b.length,o=k[d++],p=c(),q=e();++m<n;)(l=p.get(g=o(j=b[m])+""))?l.push(j):p.set(g,[j]);return p.each(function(b,c){f(q,c,a(b,d,e,f))}),q}function b(a,c){if(++c>k.length)return a;var d,e=l[c-1];return null!=i&&c>=k.length?d=a.entries():(d=[],a.each(function(a,e){d.push({key:e,values:b(a,c)})})),null!=e?d.sort(function(a,b){return e(a.key,b.key)}):d}var h,i,j,k=[],l=[];return j={object:function(b){return a(b,0,d,e)},map:function(b){return a(b,0,f,g)},entries:function(c){return b(a(c,0,f,g),0)},key:function(a){return k.push(a),j},sortKeys:function(a){return l[k.length-1]=a,j},sortValues:function(a){return h=a,j},rollup:function(a){return i=a,j}}},l=c.prototype;h.prototype=i.prototype={constructor:h,has:l.has,add:function(a){return a+="",this[j+a]=a,this},remove:l.remove,clear:l.clear,values:l.keys,size:l.size,empty:l.empty,each:l.each};var m=function(a){var b=[];for(var c in a)b.push(c);return b},n=function(a){var b=[];for(var c in a)b.push(a[c]);return b},o=function(a){var b=[];for(var c in a)b.push({key:c,value:a[c]});return b};a.nest=k,a.set=i,a.map=c,a.keys=m,a.values=n,a.entries=o,Object.defineProperty(a,"__esModule",{value:!0})})},{}],38:[function(b,c,d){!function(b,e){"object"==typeof d&&"undefined"!=typeof c?e(d):"function"==typeof a&&a.amd?a(["exports"],e):e(b.d3=b.d3||{})}(this,function(a){"use strict";function b(a,b){var c=Object.create(a.prototype);for(var d in b)c[d]=b[d];return c}function c(){}function d(a){var b;return a=(a+"").trim().toLowerCase(),(b=H.exec(a))?(b=parseInt(b[1],16),new i(b>>8&15|b>>4&240,b>>4&15|240&b,(15&b)<<4|15&b,1)):(b=I.exec(a))?e(parseInt(b[1],16)):(b=J.exec(a))?new i(b[1],b[2],b[3],1):(b=K.exec(a))?new i(255*b[1]/100,255*b[2]/100,255*b[3]/100,1):(b=L.exec(a))?f(b[1],b[2],b[3],b[4]):(b=M.exec(a))?f(255*b[1]/100,255*b[2]/100,255*b[3]/100,b[4]):(b=N.exec(a))?j(b[1],b[2]/100,b[3]/100,1):(b=O.exec(a))?j(b[1],b[2]/100,b[3]/100,b[4]):P.hasOwnProperty(a)?e(P[a]):"transparent"===a?new i(NaN,NaN,NaN,0):null}function e(a){return new i(a>>16&255,a>>8&255,255&a,1)}function f(a,b,c,d){return 0>=d&&(a=b=c=NaN),new i(a,b,c,d)}function g(a){return a instanceof c||(a=d(a)),a?(a=a.rgb(),new i(a.r,a.g,a.b,a.opacity)):new i}function h(a,b,c,d){return 1===arguments.length?g(a):new i(a,b,c,null==d?1:d)}function i(a,b,c,d){this.r=+a,this.g=+b,this.b=+c,this.opacity=+d}function j(a,b,c,d){return 0>=d?a=b=c=NaN:0>=c||c>=1?a=b=NaN:0>=b&&(a=NaN),new m(a,b,c,d)}function k(a){if(a instanceof m)return new m(a.h,a.s,a.l,a.opacity);if(a instanceof c||(a=d(a)),!a)return new m;if(a instanceof m)return a;a=a.rgb();var b=a.r/255,e=a.g/255,f=a.b/255,g=Math.min(b,e,f),h=Math.max(b,e,f),i=NaN,j=h-g,k=(h+g)/2;return j?(i=b===h?(e-f)/j+6*(f>e):e===h?(f-b)/j+2:(b-e)/j+4,j/=.5>k?h+g:2-h-g,i*=60):j=k>0&&1>k?0:i,new m(i,j,k,a.opacity)}function l(a,b,c,d){return 1===arguments.length?k(a):new m(a,b,c,null==d?1:d)}function m(a,b,c,d){this.h=+a,this.s=+b,this.l=+c,this.opacity=+d}function n(a,b,c){return 255*(60>a?b+(c-b)*a/60:180>a?c:240>a?b+(c-b)*(240-a)/60:b)}function o(a){if(a instanceof q)return new q(a.l,a.a,a.b,a.opacity);if(a instanceof x){var b=a.h*Q;return new q(a.l,Math.cos(b)*a.c,Math.sin(b)*a.c,a.opacity)}a instanceof i||(a=g(a));var c=u(a.r),d=u(a.g),e=u(a.b),f=r((.4124564*c+.3575761*d+.1804375*e)/T),h=r((.2126729*c+.7151522*d+.072175*e)/U),j=r((.0193339*c+.119192*d+.9503041*e)/V);return new q(116*h-16,500*(f-h),200*(h-j),a.opacity)}function p(a,b,c,d){return 1===arguments.length?o(a):new q(a,b,c,null==d?1:d)}function q(a,b,c,d){this.l=+a,this.a=+b,this.b=+c,this.opacity=+d}function r(a){return a>Z?Math.pow(a,1/3):a/Y+W}function s(a){return a>X?a*a*a:Y*(a-W)}function t(a){return 255*(.0031308>=a?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function u(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function v(a){if(a instanceof x)return new x(a.h,a.c,a.l,a.opacity);a instanceof q||(a=o(a));var b=Math.atan2(a.b,a.a)*R;return new x(0>b?b+360:b,Math.sqrt(a.a*a.a+a.b*a.b),a.l,a.opacity)}function w(a,b,c,d){return 1===arguments.length?v(a):new x(a,b,c,null==d?1:d)}function x(a,b,c,d){this.h=+a,this.c=+b,this.l=+c,this.opacity=+d}function y(a){if(a instanceof A)return new A(a.h,a.s,a.l,a.opacity);a instanceof i||(a=g(a));var b=a.r/255,c=a.g/255,d=a.b/255,e=(fa*d+da*b-ea*c)/(fa+da-ea),f=d-e,h=(ca*(c-e)-aa*f)/ba,j=Math.sqrt(h*h+f*f)/(ca*e*(1-e)),k=j?Math.atan2(h,f)*R-120:NaN;return new A(0>k?k+360:k,j,e,a.opacity)}function z(a,b,c,d){return 1===arguments.length?y(a):new A(a,b,c,null==d?1:d)}function A(a,b,c,d){this.h=+a,this.s=+b,this.l=+c,this.opacity=+d}var B=function(a,b,c){a.prototype=b.prototype=c,c.constructor=a},C=.7,D=1/C,E="\\s*([+-]?\\d+)\\s*",F="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",G="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",H=/^#([0-9a-f]{3})$/,I=/^#([0-9a-f]{6})$/,J=new RegExp("^rgb\\("+[E,E,E]+"\\)$"),K=new RegExp("^rgb\\("+[G,G,G]+"\\)$"),L=new RegExp("^rgba\\("+[E,E,E,F]+"\\)$"),M=new RegExp("^rgba\\("+[G,G,G,F]+"\\)$"),N=new RegExp("^hsl\\("+[F,G,G]+"\\)$"),O=new RegExp("^hsla\\("+[F,G,G,F]+"\\)$"),P={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};B(c,d,{displayable:function(){return this.rgb().displayable()},toString:function(){return this.rgb()+""}}),B(i,h,b(c,{brighter:function(a){return a=null==a?D:Math.pow(D,a),new i(this.r*a,this.g*a,this.b*a,this.opacity)},darker:function(a){return a=null==a?C:Math.pow(C,a),new i(this.r*a,this.g*a,this.b*a,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},toString:function(){var a=this.opacity;return a=isNaN(a)?1:Math.max(0,Math.min(1,a)),(1===a?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===a?")":", "+a+")")}})),B(m,l,b(c,{brighter:function(a){return a=null==a?D:Math.pow(D,a),new m(this.h,this.s,this.l*a,this.opacity)},darker:function(a){return a=null==a?C:Math.pow(C,a),new m(this.h,this.s,this.l*a,this.opacity)},rgb:function(){var a=this.h%360+360*(this.h<0),b=isNaN(a)||isNaN(this.s)?0:this.s,c=this.l,d=c+(.5>c?c:1-c)*b,e=2*c-d;return new i(n(a>=240?a-240:a+120,e,d),n(a,e,d),n(120>a?a+240:a-120,e,d),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var Q=Math.PI/180,R=180/Math.PI,S=18,T=.95047,U=1,V=1.08883,W=4/29,X=6/29,Y=3*X*X,Z=X*X*X;B(q,p,b(c,{brighter:function(a){return new q(this.l+S*(null==a?1:a),this.a,this.b,this.opacity)},darker:function(a){return new q(this.l-S*(null==a?1:a),this.a,this.b,this.opacity)},rgb:function(){var a=(this.l+16)/116,b=isNaN(this.a)?a:a+this.a/500,c=isNaN(this.b)?a:a-this.b/200;return a=U*s(a),b=T*s(b),c=V*s(c),new i(t(3.2404542*b-1.5371385*a-.4985314*c),t(-.969266*b+1.8760108*a+.041556*c),t(.0556434*b-.2040259*a+1.0572252*c),this.opacity)}})),B(x,w,b(c,{brighter:function(a){return new x(this.h,this.c,this.l+S*(null==a?1:a),this.opacity)},darker:function(a){return new x(this.h,this.c,this.l-S*(null==a?1:a),this.opacity)},rgb:function(){return o(this).rgb()}}));var $=-.14861,_=1.78277,aa=-.29227,ba=-.90649,ca=1.97294,da=ca*ba,ea=ca*_,fa=_*aa-ba*$;B(A,z,b(c,{brighter:function(a){return a=null==a?D:Math.pow(D,a),new A(this.h,this.s,this.l*a,this.opacity)},darker:function(a){return a=null==a?C:Math.pow(C,a),new A(this.h,this.s,this.l*a,this.opacity)},rgb:function(){var a=isNaN(this.h)?0:(this.h+120)*Q,b=+this.l,c=isNaN(this.s)?0:this.s*b*(1-b),d=Math.cos(a),e=Math.sin(a);return new i(255*(b+c*($*d+_*e)),255*(b+c*(aa*d+ba*e)),255*(b+c*(ca*d)),this.opacity)}})),a.color=d,a.rgb=h,a.hsl=l,a.lab=p,a.hcl=w,a.cubehelix=z,Object.defineProperty(a,"__esModule",{value:!0})})},{}],39:[function(b,c,d){!function(b,e){"object"==typeof d&&"undefined"!=typeof c?e(d):"function"==typeof a&&a.amd?a(["exports"],e):e(b.d3=b.d3||{})}(this,function(a){"use strict";function b(){for(var a,b=0,d=arguments.length,e={};d>b;++b){if(!(a=arguments[b]+"")||a in e)throw new Error("illegal type: "+a);e[a]=[]}return new c(e)}function c(a){this._=a}function d(a,b){return a.trim().split(/^|\s+/).map(function(a){var c="",d=a.indexOf(".");if(d>=0&&(c=a.slice(d+1),a=a.slice(0,d)),a&&!b.hasOwnProperty(a))throw new Error("unknown type: "+a);return{type:a,name:c}})}function e(a,b){for(var c,d=0,e=a.length;e>d;++d)if((c=a[d]).name===b)return c.value}function f(a,b,c){for(var d=0,e=a.length;e>d;++d)if(a[d].name===b){a[d]=g,a=a.slice(0,d).concat(a.slice(d+1));
break}return null!=c&&a.push({name:b,value:c}),a}var g={value:function(){}};c.prototype=b.prototype={constructor:c,on:function(a,b){var c,g=this._,h=d(a+"",g),i=-1,j=h.length;{if(!(arguments.length<2)){if(null!=b&&"function"!=typeof b)throw new Error("invalid callback: "+b);for(;++i<j;)if(c=(a=h[i]).type)g[c]=f(g[c],a.name,b);else if(null==b)for(c in g)g[c]=f(g[c],a.name,null);return this}for(;++i<j;)if((c=(a=h[i]).type)&&(c=e(g[c],a.name)))return c}},copy:function(){var a={},b=this._;for(var d in b)a[d]=b[d].slice();return new c(a)},call:function(a,b){if((c=arguments.length-2)>0)for(var c,d,e=new Array(c),f=0;c>f;++f)e[f]=arguments[f+2];if(!this._.hasOwnProperty(a))throw new Error("unknown type: "+a);for(d=this._[a],f=0,c=d.length;c>f;++f)d[f].value.apply(b,e)},apply:function(a,b,c){if(!this._.hasOwnProperty(a))throw new Error("unknown type: "+a);for(var d=this._[a],e=0,f=d.length;f>e;++e)d[e].value.apply(b,c)}},a.dispatch=b,Object.defineProperty(a,"__esModule",{value:!0})})},{}],40:[function(b,c,d){!function(e,f){"object"==typeof d&&"undefined"!=typeof c?f(d,b("d3-dispatch"),b("d3-selection")):"function"==typeof a&&a.amd?a(["exports","d3-dispatch","d3-selection"],f):f(e.d3=e.d3||{},e.d3,e.d3)}(this,function(a,b,c){"use strict";function d(){c.event.stopImmediatePropagation()}function e(a,b){var d=a.document.documentElement,e=c.select(a).on("dragstart.drag",null);b&&(e.on("click.drag",j,!0),setTimeout(function(){e.on("click.drag",null)},0)),"onselectstart"in d?e.on("selectstart.drag",null):(d.style.MozUserSelect=d.__noselect,delete d.__noselect)}function f(a,b,c,d,e,f,g,h,i,j){this.target=a,this.type=b,this.subject=c,this.identifier=d,this.active=e,this.x=f,this.y=g,this.dx=h,this.dy=i,this._=j}function g(){return!c.event.button}function h(){return this.parentNode}function i(a){return null==a?{x:c.event.x,y:c.event.y}:a}var j=function(){c.event.preventDefault(),c.event.stopImmediatePropagation()},k=function(a){var b=a.document.documentElement,d=c.select(a).on("dragstart.drag",j,!0);"onselectstart"in b?d.on("selectstart.drag",j,!0):(b.__noselect=b.style.MozUserSelect,b.style.MozUserSelect="none")},l=function(a){return function(){return a}};f.prototype.on=function(){var a=this._.on.apply(this._,arguments);return a===this._?this:a};var m=function(){function a(a){a.on("mousedown.drag",m).on("touchstart.drag",p).on("touchmove.drag",q).on("touchend.drag touchcancel.drag",r).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(){if(!u&&v.apply(this,arguments)){var a=s("mouse",w.apply(this,arguments),c.mouse,this,arguments);a&&(c.select(c.event.view).on("mousemove.drag",n,!0).on("mouseup.drag",o,!0),k(c.event.view),d(),t=!1,a("start"))}}function n(){j(),t=!0,y.mouse("drag")}function o(){c.select(c.event.view).on("mousemove.drag mouseup.drag",null),e(c.event.view,t),j(),y.mouse("end")}function p(){if(v.apply(this,arguments)){var a,b,e=c.event.changedTouches,f=w.apply(this,arguments),g=e.length;for(a=0;g>a;++a)(b=s(e[a].identifier,f,c.touch,this,arguments))&&(d(),b("start"))}}function q(){var a,b,d=c.event.changedTouches,e=d.length;for(a=0;e>a;++a)(b=y[d[a].identifier])&&(j(),b("drag"))}function r(){var a,b,e=c.event.changedTouches,f=e.length;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),a=0;f>a;++a)(b=y[e[a].identifier])&&(d(),b("end"))}function s(b,d,e,g,h){var i,j,k,l=e(d,b),m=z.copy();if(c.customEvent(new f(a,"beforestart",i,b,A,l[0],l[1],0,0,m),function(){return null==(c.event.subject=i=x.apply(g,h))?!1:(j=i.x-l[0]||0,k=i.y-l[1]||0,!0)}))return function n(o){var p,q=l;switch(o){case"start":y[b]=n,p=A++;break;case"end":delete y[b],--A;case"drag":l=e(d,b),p=A}c.customEvent(new f(a,o,i,b,p,l[0]+j,l[1]+k,l[0]-q[0],l[1]-q[1],m),m.apply,m,[o,g,h])}}var t,u,v=g,w=h,x=i,y={},z=b.dispatch("start","drag","end"),A=0;return a.filter=function(b){return arguments.length?(v="function"==typeof b?b:l(!!b),a):v},a.container=function(b){return arguments.length?(w="function"==typeof b?b:l(b),a):w},a.subject=function(b){return arguments.length?(x="function"==typeof b?b:l(b),a):x},a.on=function(){var b=z.on.apply(z,arguments);return b===z?a:b},a};a.drag=m,a.dragDisable=k,a.dragEnable=e,Object.defineProperty(a,"__esModule",{value:!0})})},{"d3-dispatch":39,"d3-selection":47}],41:[function(b,c,d){!function(b,e){"object"==typeof d&&"undefined"!=typeof c?e(d):"function"==typeof a&&a.amd?a(["exports"],e):e(b.d3=b.d3||{})}(this,function(a){"use strict";function b(a){return new Function("d","return {"+a.map(function(a,b){return JSON.stringify(a)+": d["+b+"]"}).join(",")+"}")}function c(a,c){var d=b(a);return function(b,e){return c(d(b),e,a)}}function d(a){var b=Object.create(null),c=[];return a.forEach(function(a){for(var d in a)d in b||c.push(b[d]=d)}),c}function e(a){function e(a,d){var e,g,h=f(a,function(a,f){return e?e(a,f-1):(g=a,void(e=d?c(a,d):b(a)))});return h.columns=g,h}function f(a,b){function c(){if(j>=i)return g;if(e)return e=!1,f;var b,c=j;if(34===a.charCodeAt(c)){for(var d=c;d++<i;)if(34===a.charCodeAt(d)){if(34!==a.charCodeAt(d+1))break;++d}return j=d+2,b=a.charCodeAt(d+1),13===b?(e=!0,10===a.charCodeAt(d+2)&&++j):10===b&&(e=!0),a.slice(c+1,d).replace(/""/g,'"')}for(;i>j;){var h=1;if(b=a.charCodeAt(j++),10===b)e=!0;else if(13===b)e=!0,10===a.charCodeAt(j)&&(++j,++h);else if(b!==l)continue;return a.slice(c,j-h)}return a.slice(c)}for(var d,e,f={},g={},h=[],i=a.length,j=0,k=0;(d=c())!==g;){for(var m=[];d!==f&&d!==g;)m.push(d),d=c();b&&null==(m=b(m,k++))||h.push(m)}return h}function g(b,c){return null==c&&(c=d(b)),[c.map(j).join(a)].concat(b.map(function(b){return c.map(function(a){return j(b[a])}).join(a)})).join("\n")}function h(a){return a.map(i).join("\n")}function i(b){return b.map(j).join(a)}function j(a){return null==a?"":k.test(a+="")?'"'+a.replace(/\"/g,'""')+'"':a}var k=new RegExp('["'+a+"\n]"),l=a.charCodeAt(0);return{parse:e,parseRows:f,format:g,formatRows:h}}var f=e(","),g=f.parse,h=f.parseRows,i=f.format,j=f.formatRows,k=e("	"),l=k.parse,m=k.parseRows,n=k.format,o=k.formatRows;a.dsvFormat=e,a.csvParse=g,a.csvParseRows=h,a.csvFormat=i,a.csvFormatRows=j,a.tsvParse=l,a.tsvParseRows=m,a.tsvFormat=n,a.tsvFormatRows=o,Object.defineProperty(a,"__esModule",{value:!0})})},{}],42:[function(b,c,d){!function(b,e){"object"==typeof d&&"undefined"!=typeof c?e(d):"function"==typeof a&&a.amd?a(["exports"],e):e(b.d3=b.d3||{})}(this,function(a){"use strict";function b(a){return+a}function c(a){return a*a}function d(a){return a*(2-a)}function e(a){return((a*=2)<=1?a*a:--a*(2-a)+1)/2}function f(a){return a*a*a}function g(a){return--a*a*a+1}function h(a){return((a*=2)<=1?a*a*a:(a-=2)*a*a+2)/2}function i(a){return 1-Math.cos(a*z)}function j(a){return Math.sin(a*z)}function k(a){return(1-Math.cos(y*a))/2}function l(a){return Math.pow(2,10*a-10)}function m(a){return 1-Math.pow(2,-10*a)}function n(a){return((a*=2)<=1?Math.pow(2,10*a-10):2-Math.pow(2,10-10*a))/2}function o(a){return 1-Math.sqrt(1-a*a)}function p(a){return Math.sqrt(1- --a*a)}function q(a){return((a*=2)<=1?1-Math.sqrt(1-a*a):Math.sqrt(1-(a-=2)*a)+1)/2}function r(a){return 1-s(1-a)}function s(a){return(a=+a)<A?J*a*a:C>a?J*(a-=B)*a+D:F>a?J*(a-=E)*a+G:J*(a-=H)*a+I}function t(a){return((a*=2)<=1?1-s(1-a):s(a-1)+1)/2}var u=3,v=function U(a){function b(b){return Math.pow(b,a)}return a=+a,b.exponent=U,b}(u),w=function V(a){function b(b){return 1-Math.pow(1-b,a)}return a=+a,b.exponent=V,b}(u),x=function W(a){function b(b){return((b*=2)<=1?Math.pow(b,a):2-Math.pow(2-b,a))/2}return a=+a,b.exponent=W,b}(u),y=Math.PI,z=y/2,A=4/11,B=6/11,C=8/11,D=.75,E=9/11,F=10/11,G=.9375,H=21/22,I=63/64,J=1/A/A,K=1.70158,L=function X(a){function b(b){return b*b*((a+1)*b-a)}return a=+a,b.overshoot=X,b}(K),M=function Y(a){function b(b){return--b*b*((a+1)*b+a)+1}return a=+a,b.overshoot=Y,b}(K),N=function Z(a){function b(b){return((b*=2)<1?b*b*((a+1)*b-a):(b-=2)*b*((a+1)*b+a)+2)/2}return a=+a,b.overshoot=Z,b}(K),O=2*Math.PI,P=1,Q=.3,R=function $(a,b){function c(c){return a*Math.pow(2,10*--c)*Math.sin((d-c)/b)}var d=Math.asin(1/(a=Math.max(1,a)))*(b/=O);return c.amplitude=function(a){return $(a,b*O)},c.period=function(b){return $(a,b)},c}(P,Q),S=function _(a,b){function c(c){return 1-a*Math.pow(2,-10*(c=+c))*Math.sin((c+d)/b)}var d=Math.asin(1/(a=Math.max(1,a)))*(b/=O);return c.amplitude=function(a){return _(a,b*O)},c.period=function(b){return _(a,b)},c}(P,Q),T=function aa(a,b){function c(c){return((c=2*c-1)<0?a*Math.pow(2,10*c)*Math.sin((d-c)/b):2-a*Math.pow(2,-10*c)*Math.sin((d+c)/b))/2}var d=Math.asin(1/(a=Math.max(1,a)))*(b/=O);return c.amplitude=function(a){return aa(a,b*O)},c.period=function(b){return aa(a,b)},c}(P,Q);a.easeLinear=b,a.easeQuad=e,a.easeQuadIn=c,a.easeQuadOut=d,a.easeQuadInOut=e,a.easeCubic=h,a.easeCubicIn=f,a.easeCubicOut=g,a.easeCubicInOut=h,a.easePoly=x,a.easePolyIn=v,a.easePolyOut=w,a.easePolyInOut=x,a.easeSin=k,a.easeSinIn=i,a.easeSinOut=j,a.easeSinInOut=k,a.easeExp=n,a.easeExpIn=l,a.easeExpOut=m,a.easeExpInOut=n,a.easeCircle=q,a.easeCircleIn=o,a.easeCircleOut=p,a.easeCircleInOut=q,a.easeBounce=s,a.easeBounceIn=r,a.easeBounceOut=s,a.easeBounceInOut=t,a.easeBack=N,a.easeBackIn=L,a.easeBackOut=M,a.easeBackInOut=N,a.easeElastic=S,a.easeElasticIn=R,a.easeElasticOut=S,a.easeElasticInOut=T,Object.defineProperty(a,"__esModule",{value:!0})})},{}],43:[function(b,c,d){!function(b,e){"object"==typeof d&&"undefined"!=typeof c?e(d):"function"==typeof a&&a.amd?a(["exports"],e):e(b.d3=b.d3||{})}(this,function(a){"use strict";function b(a,b){if((c=(a=b?a.toExponential(b-1):a.toExponential()).indexOf("e"))<0)return null;var c,d=a.slice(0,c);return[d.length>1?d[0]+d.slice(2):d,+a.slice(c+1)]}function c(a){return a=b(Math.abs(a)),a?a[1]:NaN}function d(a,b){return function(c,d){for(var e=c.length,f=[],g=0,h=a[0],i=0;e>0&&h>0&&(i+h+1>d&&(h=Math.max(1,d-i)),f.push(c.substring(e-=h,e+h)),!((i+=h+1)>d));)h=a[g=(g+1)%a.length];return f.reverse().join(b)}}function e(a,b){a=a.toPrecision(b);a:for(var c,d=a.length,e=1,f=-1;d>e;++e)switch(a[e]){case".":f=c=e;break;case"0":0===f&&(f=e),c=e;break;case"e":break a;default:f>0&&(f=0)}return f>0?a.slice(0,f)+a.slice(c+1):a}function f(a,c){var d=b(a,c);if(!d)return a+"";var e=d[0],f=d[1],g=f-(p=3*Math.max(-8,Math.min(8,Math.floor(f/3))))+1,h=e.length;return g===h?e:g>h?e+new Array(g-h+1).join("0"):g>0?e.slice(0,g)+"."+e.slice(g):"0."+new Array(1-g).join("0")+b(a,Math.max(0,c+g-1))[0]}function g(a,c){var d=b(a,c);if(!d)return a+"";var e=d[0],f=d[1];return 0>f?"0."+new Array(-f).join("0")+e:e.length>f+1?e.slice(0,f+1)+"."+e.slice(f+1):e+new Array(f-e.length+2).join("0")}function h(a){return new i(a)}function i(a){if(!(b=r.exec(a)))throw new Error("invalid format: "+a);var b,c=b[1]||" ",d=b[2]||">",e=b[3]||"-",f=b[4]||"",g=!!b[5],h=b[6]&&+b[6],i=!!b[7],j=b[8]&&+b[8].slice(1),k=b[9]||"";"n"===k?(i=!0,k="g"):q[k]||(k=""),(g||"0"===c&&"="===d)&&(g=!0,c="0",d="="),this.fill=c,this.align=d,this.sign=e,this.symbol=f,this.zero=g,this.width=h,this.comma=i,this.precision=j,this.type=k}function j(a){return a}function k(a){function b(a){function b(a){var b,g,h,j=r,q=s;if("c"===o)q=u(a)+q,a="";else{a=+a;var w=(0>a||0>1/a)&&(a*=-1,!0);if(a=u(a,n),w)for(b=-1,g=a.length,w=!1;++b<g;)if(h=a.charCodeAt(b),h>48&&58>h||"x"===o&&h>96&&103>h||"X"===o&&h>64&&71>h){w=!0;break}if(j=(w?"("===e?e:"-":"-"===e||"("===e?"":e)+j,q=q+("s"===o?t[8+p/3]:"")+(w&&"("===e?")":""),v)for(b=-1,g=a.length;++b<g;)if(h=a.charCodeAt(b),48>h||h>57){q=(46===h?i+a.slice(b+1):a.slice(b))+q,a=a.slice(0,b);break}}m&&!k&&(a=f(a,1/0));var x=j.length+a.length+q.length,y=l>x?new Array(l-x+1).join(c):"";switch(m&&k&&(a=f(y+a,y.length?l-q.length:1/0),y=""),d){case"<":return j+a+q+y;case"=":return j+y+a+q;case"^":return y.slice(0,x=y.length>>1)+j+a+q+y.slice(x)}return y+j+a+q}a=h(a);var c=a.fill,d=a.align,e=a.sign,j=a.symbol,k=a.zero,l=a.width,m=a.comma,n=a.precision,o=a.type,r="$"===j?g[0]:"#"===j&&/[boxX]/.test(o)?"0"+o.toLowerCase():"",s="$"===j?g[1]:/[%p]/.test(o)?"%":"",u=q[o],v=!o||/[defgprs%]/.test(o);return n=null==n?o?6:12:/[gprs]/.test(o)?Math.max(1,Math.min(21,n)):Math.max(0,Math.min(20,n)),b.toString=function(){return a+""},b}function e(a,d){var e=b((a=h(a),a.type="f",a)),f=3*Math.max(-8,Math.min(8,Math.floor(c(d)/3))),g=Math.pow(10,-f),i=t[8+f/3];return function(a){return e(g*a)+i}}var f=a.grouping&&a.thousands?d(a.grouping,a.thousands):j,g=a.currency,i=a.decimal;return{format:b,formatPrefix:e}}function l(b){return s=k(b),a.format=s.format,a.formatPrefix=s.formatPrefix,s}function m(a){return Math.max(0,-c(Math.abs(a)))}function n(a,b){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(c(b)/3)))-c(Math.abs(a)))}function o(a,b){return a=Math.abs(a),b=Math.abs(b)-a,Math.max(0,c(b)-c(a))+1}var p,q={"":e,"%":function(a,b){return(100*a).toFixed(b)},b:function(a){return Math.round(a).toString(2)},c:function(a){return a+""},d:function(a){return Math.round(a).toString(10)},e:function(a,b){return a.toExponential(b)},f:function(a,b){return a.toFixed(b)},g:function(a,b){return a.toPrecision(b)},o:function(a){return Math.round(a).toString(8)},p:function(a,b){return g(100*a,b)},r:g,s:f,X:function(a){return Math.round(a).toString(16).toUpperCase()},x:function(a){return Math.round(a).toString(16)}},r=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?([a-z%])?$/i;i.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+this.type};var s,t=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];l({decimal:".",thousands:",",grouping:[3],currency:["$",""]}),a.formatDefaultLocale=l,a.formatLocale=k,a.formatSpecifier=h,a.precisionFixed=m,a.precisionPrefix=n,a.precisionRound=o,Object.defineProperty(a,"__esModule",{value:!0})})},{}],44:[function(b,c,d){!function(e,f){"object"==typeof d&&"undefined"!=typeof c?f(d,b("d3-color")):"function"==typeof a&&a.amd?a(["exports","d3-color"],f):f(e.d3=e.d3||{},e.d3)}(this,function(a,b){"use strict";function c(a,b,c,d,e){var f=a*a,g=f*a;return((1-3*a+3*f-g)*b+(4-6*f+3*g)*c+(1+3*a+3*f-3*g)*d+g*e)/6}function d(a,b){return function(c){return a+c*b}}function e(a,b,c){return a=Math.pow(a,c),b=Math.pow(b,c)-a,c=1/c,function(d){return Math.pow(a+d*b,c)}}function f(a,b){var c=b-a;return c?d(a,c>180||-180>c?c-360*Math.round(c/360):c):B(isNaN(a)?b:a)}function g(a){return 1===(a=+a)?h:function(b,c){return c-b?e(b,c,a):B(isNaN(b)?c:b)}}function h(a,b){var c=b-a;return c?d(a,c):B(isNaN(a)?b:a)}function i(a){return function(c){var d,e,f=c.length,g=new Array(f),h=new Array(f),i=new Array(f);for(d=0;f>d;++d)e=b.rgb(c[d]),g[d]=e.r||0,h[d]=e.g||0,i[d]=e.b||0;return g=a(g),h=a(h),i=a(i),e.opacity=1,function(a){return e.r=g(a),e.g=h(a),e.b=i(a),e+""}}}function j(a){return function(){return a}}function k(a){return function(b){return a(b)+""}}function l(a){return"none"===a?P:(v||(v=document.createElement("DIV"),w=document.documentElement,x=document.defaultView),v.style.transform=a,a=x.getComputedStyle(w.appendChild(v),null).getPropertyValue("transform"),w.removeChild(v),a=a.slice(7,-1).split(","),Q(+a[0],+a[1],+a[2],+a[3],+a[4],+a[5]))}function m(a){return null==a?P:(y||(y=document.createElementNS("http://www.w3.org/2000/svg","g")),y.setAttribute("transform",a),(a=y.transform.baseVal.consolidate())?(a=a.matrix,Q(a.a,a.b,a.c,a.d,a.e,a.f)):P)}function n(a,b,c,d){function e(a){return a.length?a.pop()+" ":""}function f(a,d,e,f,g,h){if(a!==e||d!==f){var i=g.push("translate(",null,b,null,c);h.push({i:i-4,x:H(a,e)},{i:i-2,x:H(d,f)})}else(e||f)&&g.push("translate("+e+b+f+c)}function g(a,b,c,f){a!==b?(a-b>180?b+=360:b-a>180&&(a+=360),f.push({i:c.push(e(c)+"rotate(",null,d)-2,x:H(a,b)})):b&&c.push(e(c)+"rotate("+b+d)}function h(a,b,c,f){a!==b?f.push({i:c.push(e(c)+"skewX(",null,d)-2,x:H(a,b)}):b&&c.push(e(c)+"skewX("+b+d)}function i(a,b,c,d,f,g){if(a!==c||b!==d){var h=f.push(e(f)+"scale(",null,",",null,")");g.push({i:h-4,x:H(a,c)},{i:h-2,x:H(b,d)})}else(1!==c||1!==d)&&f.push(e(f)+"scale("+c+","+d+")")}return function(b,c){var d=[],e=[];return b=a(b),c=a(c),f(b.translateX,b.translateY,c.translateX,c.translateY,d,e),g(b.rotate,c.rotate,d,e),h(b.skewX,c.skewX,d,e),i(b.scaleX,b.scaleY,c.scaleX,c.scaleY,d,e),b=c=null,function(a){for(var b,c=-1,f=e.length;++c<f;)d[(b=e[c]).i]=b.x(a);return d.join("")}}}function o(a){return((a=Math.exp(a))+1/a)/2}function p(a){return((a=Math.exp(a))-1/a)/2}function q(a){return((a=Math.exp(2*a))-1)/(a+1)}function r(a){return function(c,d){var e=a((c=b.hsl(c)).h,(d=b.hsl(d)).h),f=h(c.s,d.s),g=h(c.l,d.l),i=h(c.opacity,d.opacity);return function(a){return c.h=e(a),c.s=f(a),c.l=g(a),c.opacity=i(a),c+""}}}function s(a,c){var d=h((a=b.lab(a)).l,(c=b.lab(c)).l),e=h(a.a,c.a),f=h(a.b,c.b),g=h(a.opacity,c.opacity);return function(b){return a.l=d(b),a.a=e(b),a.b=f(b),a.opacity=g(b),a+""}}function t(a){return function(c,d){var e=a((c=b.hcl(c)).h,(d=b.hcl(d)).h),f=h(c.c,d.c),g=h(c.l,d.l),i=h(c.opacity,d.opacity);return function(a){return c.h=e(a),c.c=f(a),c.l=g(a),c.opacity=i(a),c+""}}}function u(a){return function c(d){function e(c,e){var f=a((c=b.cubehelix(c)).h,(e=b.cubehelix(e)).h),g=h(c.s,e.s),i=h(c.l,e.l),j=h(c.opacity,e.opacity);return function(a){return c.h=f(a),c.s=g(a),c.l=i(Math.pow(a,d)),c.opacity=j(a),c+""}}return d=+d,e.gamma=c,e}(1)}var v,w,x,y,z=function(a){var b=a.length-1;return function(d){var e=0>=d?d=0:d>=1?(d=1,b-1):Math.floor(d*b),f=a[e],g=a[e+1],h=e>0?a[e-1]:2*f-g,i=b-1>e?a[e+2]:2*g-f;return c((d-e/b)*b,h,f,g,i)}},A=function(a){var b=a.length;return function(d){var e=Math.floor(((d%=1)<0?++d:d)*b),f=a[(e+b-1)%b],g=a[e%b],h=a[(e+1)%b],i=a[(e+2)%b];return c((d-e/b)*b,f,g,h,i)}},B=function(a){return function(){return a}},C=function da(a){function c(a,c){var e=d((a=b.rgb(a)).r,(c=b.rgb(c)).r),f=d(a.g,c.g),g=d(a.b,c.b),i=h(a.opacity,c.opacity);return function(b){return a.r=e(b),a.g=f(b),a.b=g(b),a.opacity=i(b),a+""}}var d=g(a);return c.gamma=da,c}(1),D=i(z),E=i(A),F=function(a,b){var c,d=b?b.length:0,e=a?Math.min(d,a.length):0,f=new Array(d),g=new Array(d);for(c=0;e>c;++c)f[c]=M(a[c],b[c]);for(;d>c;++c)g[c]=b[c];return function(a){for(c=0;e>c;++c)g[c]=f[c](a);return g}},G=function(a,b){var c=new Date;return a=+a,b-=a,function(d){return c.setTime(a+b*d),c}},H=function(a,b){return a=+a,b-=a,function(c){return a+b*c}},I=function(a,b){var c,d={},e={};(null===a||"object"!=typeof a)&&(a={}),(null===b||"object"!=typeof b)&&(b={});for(c in b)c in a?d[c]=M(a[c],b[c]):e[c]=b[c];return function(a){for(c in d)e[c]=d[c](a);return e}},J=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,K=new RegExp(J.source,"g"),L=function(a,b){var c,d,e,f=J.lastIndex=K.lastIndex=0,g=-1,h=[],i=[];for(a+="",b+="";(c=J.exec(a))&&(d=K.exec(b));)(e=d.index)>f&&(e=b.slice(f,e),h[g]?h[g]+=e:h[++g]=e),(c=c[0])===(d=d[0])?h[g]?h[g]+=d:h[++g]=d:(h[++g]=null,i.push({i:g,x:H(c,d)})),f=K.lastIndex;return f<b.length&&(e=b.slice(f),h[g]?h[g]+=e:h[++g]=e),h.length<2?i[0]?k(i[0].x):j(b):(b=i.length,function(a){for(var c,d=0;b>d;++d)h[(c=i[d]).i]=c.x(a);return h.join("")})},M=function(a,c){var d,e=typeof c;return null==c||"boolean"===e?B(c):("number"===e?H:"string"===e?(d=b.color(c))?(c=d,C):L:c instanceof b.color?C:c instanceof Date?G:Array.isArray(c)?F:isNaN(c)?I:H)(a,c)},N=function(a,b){return a=+a,b-=a,function(c){return Math.round(a+b*c)}},O=180/Math.PI,P={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},Q=function(a,b,c,d,e,f){var g,h,i;return(g=Math.sqrt(a*a+b*b))&&(a/=g,b/=g),(i=a*c+b*d)&&(c-=a*i,d-=b*i),(h=Math.sqrt(c*c+d*d))&&(c/=h,d/=h,i/=h),b*c>a*d&&(a=-a,b=-b,i=-i,g=-g),{translateX:e,translateY:f,rotate:Math.atan2(b,a)*O,skewX:Math.atan(i)*O,scaleX:g,scaleY:h}},R=n(l,"px, ","px)","deg)"),S=n(m,", ",")",")"),T=Math.SQRT2,U=2,V=4,W=1e-12,X=function(a,b){var c,d,e=a[0],f=a[1],g=a[2],h=b[0],i=b[1],j=b[2],k=h-e,l=i-f,m=k*k+l*l;if(W>m)d=Math.log(j/g)/T,c=function(a){return[e+a*k,f+a*l,g*Math.exp(T*a*d)]};else{var n=Math.sqrt(m),r=(j*j-g*g+V*m)/(2*g*U*n),s=(j*j-g*g-V*m)/(2*j*U*n),t=Math.log(Math.sqrt(r*r+1)-r),u=Math.log(Math.sqrt(s*s+1)-s);d=(u-t)/T,c=function(a){var b=a*d,c=o(t),h=g/(U*n)*(c*q(T*b+t)-p(t));return[e+h*k,f+h*l,g*c/o(T*b+t)]}}return c.duration=1e3*d,c},Y=r(f),Z=r(h),$=t(f),_=t(h),aa=u(f),ba=u(h),ca=function(a,b){for(var c=new Array(b),d=0;b>d;++d)c[d]=a(d/(b-1));return c};a.interpolate=M,a.interpolateArray=F,a.interpolateBasis=z,a.interpolateBasisClosed=A,a.interpolateDate=G,a.interpolateNumber=H,a.interpolateObject=I,a.interpolateRound=N,a.interpolateString=L,a.interpolateTransformCss=R,a.interpolateTransformSvg=S,a.interpolateZoom=X,a.interpolateRgb=C,a.interpolateRgbBasis=D,a.interpolateRgbBasisClosed=E,a.interpolateHsl=Y,a.interpolateHslLong=Z,a.interpolateLab=s,a.interpolateHcl=$,a.interpolateHclLong=_,a.interpolateCubehelix=aa,a.interpolateCubehelixLong=ba,a.quantize=ca,Object.defineProperty(a,"__esModule",{value:!0})})},{"d3-color":38}],45:[function(b,c,d){!function(e,f){"object"==typeof d&&"undefined"!=typeof c?f(d,b("d3-collection"),b("d3-dispatch"),b("d3-dsv")):"function"==typeof a&&a.amd?a(["exports","d3-collection","d3-dispatch","d3-dsv"],f):f(e.d3=e.d3||{},e.d3,e.d3,e.d3)}(this,function(a,b,c,d){"use strict";function e(a){return function(b,c){a(null==b?c:null)}}function f(a){var b=a.responseType;return b&&"text"!==b?a.response:a.responseText}function g(a,b){return function(c){return a(c.responseText,b)}}var h=function(a,d){function g(a){var b,c=n.status;if(!c&&f(n)||c>=200&&300>c||304===c){if(j)try{b=j.call(h,n)}catch(d){return void l.call("error",h,d)}else b=n;l.call("load",h,b)}else l.call("error",h,a)}var h,i,j,k,l=c.dispatch("beforesend","progress","load","error"),m=b.map(),n=new XMLHttpRequest,o=null,p=null,q=0;if("undefined"==typeof XDomainRequest||"withCredentials"in n||!/^(http(s)?:)?\/\//.test(a)||(n=new XDomainRequest),"onload"in n?n.onload=n.onerror=n.ontimeout=g:n.onreadystatechange=function(a){n.readyState>3&&g(a)},n.onprogress=function(a){l.call("progress",h,a)},h={header:function(a,b){return a=(a+"").toLowerCase(),arguments.length<2?m.get(a):(null==b?m.remove(a):m.set(a,b+""),h)},mimeType:function(a){return arguments.length?(i=null==a?null:a+"",h):i},responseType:function(a){return arguments.length?(k=a,h):k},timeout:function(a){return arguments.length?(q=+a,h):q},user:function(a){return arguments.length<1?o:(o=null==a?null:a+"",h)},password:function(a){return arguments.length<1?p:(p=null==a?null:a+"",h)},response:function(a){return j=a,h},get:function(a,b){return h.send("GET",a,b)},post:function(a,b){return h.send("POST",a,b)},send:function(b,c,d){return n.open(b,a,!0,o,p),null==i||m.has("accept")||m.set("accept",i+",*/*"),n.setRequestHeader&&m.each(function(a,b){n.setRequestHeader(b,a)}),null!=i&&n.overrideMimeType&&n.overrideMimeType(i),null!=k&&(n.responseType=k),q>0&&(n.timeout=q),null==d&&"function"==typeof c&&(d=c,c=null),null!=d&&1===d.length&&(d=e(d)),null!=d&&h.on("error",d).on("load",function(a){d(null,a)}),l.call("beforesend",h,n),n.send(null==c?null:c),h},abort:function(){return n.abort(),h},on:function(){var a=l.on.apply(l,arguments);return a===l?h:a}},null!=d){if("function"!=typeof d)throw new Error("invalid callback: "+d);return h.get(d)}return h},i=function(a,b){return function(c,d){var e=h(c).mimeType(a).response(b);if(null!=d){if("function"!=typeof d)throw new Error("invalid callback: "+d);return e.get(d)}return e}},j=i("text/html",function(a){return document.createRange().createContextualFragment(a.responseText)}),k=i("application/json",function(a){return JSON.parse(a.responseText)}),l=i("text/plain",function(a){return a.responseText}),m=i("application/xml",function(a){var b=a.responseXML;if(!b)throw new Error("parse error");return b}),n=function(a,b){return function(c,d,e){arguments.length<3&&(e=d,d=null);var f=h(c).mimeType(a);return f.row=function(a){return arguments.length?f.response(g(b,d=a)):d},f.row(d),e?f.get(e):f}},o=n("text/csv",d.csvParse),p=n("text/tab-separated-values",d.tsvParse);a.request=h,a.html=j,a.json=k,a.text=l,a.xml=m,a.csv=o,a.tsv=p,Object.defineProperty(a,"__esModule",{value:!0})})},{"d3-collection":37,"d3-dispatch":39,"d3-dsv":41}],46:[function(b,c,d){!function(e,f){"object"==typeof d&&"undefined"!=typeof c?f(d,b("d3-array"),b("d3-collection"),b("d3-interpolate"),b("d3-format"),b("d3-time"),b("d3-time-format"),b("d3-color")):"function"==typeof a&&a.amd?a(["exports","d3-array","d3-collection","d3-interpolate","d3-format","d3-time","d3-time-format","d3-color"],f):f(e.d3=e.d3||{},e.d3,e.d3,e.d3,e.d3,e.d3,e.d3,e.d3)}(this,function(a,b,c,d,e,f,g,h){"use strict";function i(a){function b(b){var c=b+"",g=d.get(c);if(!g){if(f!==R)return f;d.set(c,g=e.push(b))}return a[(g-1)%a.length]}var d=c.map(),e=[],f=R;return a=null==a?[]:Q.call(a),b.domain=function(a){if(!arguments.length)return e.slice();e=[],d=c.map();for(var f,g,h=-1,i=a.length;++h<i;)d.has(g=(f=a[h])+"")||d.set(g,e.push(f));return b},b.range=function(c){return arguments.length?(a=Q.call(c),b):a.slice()},b.unknown=function(a){return arguments.length?(f=a,b):f},b.copy=function(){return i().domain(e).range(a).unknown(f)},b}function j(){function a(){var a=f().length,e=h[1]<h[0],i=h[e-0],j=h[1-e];c=(j-i)/Math.max(1,a-l+2*m),k&&(c=Math.floor(c)),i+=(j-i-c*(a-l))*n,d=c*(1-l),k&&(i=Math.round(i),d=Math.round(d));var o=b.range(a).map(function(a){return i+c*a});return g(e?o.reverse():o)}var c,d,e=i().unknown(void 0),f=e.domain,g=e.range,h=[0,1],k=!1,l=0,m=0,n=.5;return delete e.unknown,e.domain=function(b){return arguments.length?(f(b),a()):f()},e.range=function(b){return arguments.length?(h=[+b[0],+b[1]],a()):h.slice()},e.rangeRound=function(b){return h=[+b[0],+b[1]],k=!0,a()},e.bandwidth=function(){return d},e.step=function(){return c},e.round=function(b){return arguments.length?(k=!!b,a()):k},e.padding=function(b){return arguments.length?(l=m=Math.max(0,Math.min(1,b)),a()):l},e.paddingInner=function(b){return arguments.length?(l=Math.max(0,Math.min(1,b)),a()):l},e.paddingOuter=function(b){return arguments.length?(m=Math.max(0,Math.min(1,b)),a()):m},e.align=function(b){return arguments.length?(n=Math.max(0,Math.min(1,b)),a()):n},e.copy=function(){return j().domain(f()).range(h).round(k).paddingInner(l).paddingOuter(m).align(n)},a()}function k(a){var b=a.copy;return a.padding=a.paddingOuter,delete a.paddingInner,delete a.paddingOuter,a.copy=function(){return k(b())},a}function l(){return k(j().paddingInner(1))}function m(a,b){return(b-=a=+a)?function(c){return(c-a)/b}:S(b)}function n(a){return function(b,c){var d=a(b=+b,c=+c);return function(a){return b>=a?0:a>=c?1:d(a)}}}function o(a){return function(b,c){var d=a(b=+b,c=+c);return function(a){return 0>=a?b:a>=1?c:d(a)}}}function p(a,b,c,d){var e=a[0],f=a[1],g=b[0],h=b[1];return e>f?(e=c(f,e),g=d(h,g)):(e=c(e,f),g=d(g,h)),function(a){return g(e(a))}}function q(a,c,d,e){var f=Math.min(a.length,c.length)-1,g=new Array(f),h=new Array(f),i=-1;for(a[f]<a[0]&&(a=a.slice().reverse(),c=c.slice().reverse());++i<f;)g[i]=d(a[i],a[i+1]),h[i]=e(c[i],c[i+1]);return function(c){var d=b.bisect(a,c,1,f)-1;return h[d](g[d](c))}}function r(a,b){return b.domain(a.domain()).range(a.range()).interpolate(a.interpolate()).clamp(a.clamp())}function s(a,b){function c(){return f=Math.min(i.length,j.length)>2?q:p,g=h=null,e}function e(b){return(g||(g=f(i,j,l?n(a):a,k)))(+b)}var f,g,h,i=U,j=U,k=d.interpolate,l=!1;return e.invert=function(a){return(h||(h=f(j,i,m,l?o(b):b)))(+a)},e.domain=function(a){return arguments.length?(i=P.call(a,T),c()):i.slice()},e.range=function(a){return arguments.length?(j=Q.call(a),c()):j.slice()},e.rangeRound=function(a){return j=Q.call(a),k=d.interpolateRound,c()},e.clamp=function(a){return arguments.length?(l=!!a,c()):l},e.interpolate=function(a){return arguments.length?(k=a,c()):k},c()}function t(a){var c=a.domain;return a.ticks=function(a){var d=c();return b.ticks(d[0],d[d.length-1],null==a?10:a)},a.tickFormat=function(a,b){return V(c(),a,b)},a.nice=function(d){var e=c(),f=e.length-1,g=null==d?10:d,h=e[0],i=e[f],j=b.tickStep(h,i,g);return j&&(j=b.tickStep(Math.floor(h/j)*j,Math.ceil(i/j)*j,g),e[0]=Math.floor(h/j)*j,e[f]=Math.ceil(i/j)*j,c(e)),a},a}function u(){var a=s(m,d.interpolateNumber);return a.copy=function(){return r(a,u())},t(a)}function v(){function a(a){return+a}var b=[0,1];return a.invert=a,a.domain=a.range=function(c){return arguments.length?(b=P.call(c,T),a):b.slice()},a.copy=function(){return v().domain(b)},t(a)}function w(a,b){return(b=Math.log(b/a))?function(c){return Math.log(c/a)/b}:S(b)}function x(a,b){return 0>a?function(c){return-Math.pow(-b,c)*Math.pow(-a,1-c)}:function(c){return Math.pow(b,c)*Math.pow(a,1-c)}}function y(a){return isFinite(a)?+("1e"+a):0>a?0:a}function z(a){return 10===a?y:a===Math.E?Math.exp:function(b){return Math.pow(a,b)}}function A(a){return a===Math.E?Math.log:10===a&&Math.log10||2===a&&Math.log2||(a=Math.log(a),function(b){return Math.log(b)/a})}function B(a){return function(b){return-a(-b)}}function C(){function a(){return g=A(f),h=z(f),d()[0]<0&&(g=B(g),h=B(h)),c}var c=s(w,x).domain([1,10]),d=c.domain,f=10,g=A(10),h=z(10);return c.base=function(b){return arguments.length?(f=+b,a()):f},c.domain=function(b){return arguments.length?(d(b),a()):d()},c.ticks=function(a){var c,e=d(),i=e[0],j=e[e.length-1];(c=i>j)&&(n=i,i=j,j=n);var k,l,m,n=g(i),o=g(j),p=null==a?10:+a,q=[];if(!(f%1)&&p>o-n){if(n=Math.round(n)-1,o=Math.round(o)+1,i>0){for(;o>n;++n)for(l=1,k=h(n);f>l;++l)if(m=k*l,!(i>m)){if(m>j)break;q.push(m)}}else for(;o>n;++n)for(l=f-1,k=h(n);l>=1;--l)if(m=k*l,!(i>m)){if(m>j)break;q.push(m)}}else q=b.ticks(n,o,Math.min(o-n,p)).map(h);return c?q.reverse():q},c.tickFormat=function(a,b){if(null==b&&(b=10===f?".0e":","),"function"!=typeof b&&(b=e.format(b)),a===1/0)return b;null==a&&(a=10);var d=Math.max(1,f*a/c.ticks().length);return function(a){var c=a/h(Math.round(g(a)));return f-.5>c*f&&(c*=f),d>=c?b(a):""}},c.nice=function(){return d(W(d(),{floor:function(a){return h(Math.floor(g(a)))},ceil:function(a){return h(Math.ceil(g(a)))}}))},c.copy=function(){return r(c,C().base(f))},c}function D(a,b){return 0>a?-Math.pow(-a,b):Math.pow(a,b)}function E(){function a(a,b){return(b=D(b,c)-(a=D(a,c)))?function(d){return(D(d,c)-a)/b}:S(b)}function b(a,b){return b=D(b,c)-(a=D(a,c)),function(d){return D(a+b*d,1/c)}}var c=1,d=s(a,b),e=d.domain;return d.exponent=function(a){return arguments.length?(c=+a,e(e())):c},d.copy=function(){return r(d,E().exponent(c))},t(d)}function F(){return E().exponent(.5)}function G(){function a(){var a=0,g=Math.max(1,e.length);for(f=new Array(g-1);++a<g;)f[a-1]=b.quantile(d,a/g);return c}function c(a){return isNaN(a=+a)?void 0:e[b.bisect(f,a)]}var d=[],e=[],f=[];return c.invertExtent=function(a){var b=e.indexOf(a);return 0>b?[NaN,NaN]:[b>0?f[b-1]:d[0],b<f.length?f[b]:d[d.length-1]]},c.domain=function(c){if(!arguments.length)return d.slice();d=[];for(var e,f=0,g=c.length;g>f;++f)e=c[f],null==e||isNaN(e=+e)||d.push(e);return d.sort(b.ascending),a()},c.range=function(b){return arguments.length?(e=Q.call(b),a()):e.slice()},c.quantiles=function(){return f.slice()},c.copy=function(){return G().domain(d).range(e)},c}function H(){function a(a){return a>=a?h[b.bisect(g,a,0,f)]:void 0}function c(){var b=-1;for(g=new Array(f);++b<f;)g[b]=((b+1)*e-(b-f)*d)/(f+1);return a}var d=0,e=1,f=1,g=[.5],h=[0,1];return a.domain=function(a){return arguments.length?(d=+a[0],e=+a[1],c()):[d,e]},a.range=function(a){return arguments.length?(f=(h=Q.call(a)).length-1,c()):h.slice()},a.invertExtent=function(a){var b=h.indexOf(a);return 0>b?[NaN,NaN]:1>b?[d,g[0]]:b>=f?[g[f-1],e]:[g[b-1],g[b]]},a.copy=function(){return H().domain([d,e]).range(h)},t(a)}function I(){function a(a){return a>=a?d[b.bisect(c,a,0,e)]:void 0}var c=[.5],d=[0,1],e=1;return a.domain=function(b){return arguments.length?(c=Q.call(b),e=Math.min(c.length,d.length-1),a):c.slice()},a.range=function(b){return arguments.length?(d=Q.call(b),e=Math.min(c.length,d.length-1),a):d.slice()},a.invertExtent=function(a){var b=d.indexOf(a);return[c[b-1],c[b]]},a.copy=function(){return I().domain(c).range(d)},a}function J(a){return new Date(a);
}function K(a){return a instanceof Date?+a:+new Date(+a)}function L(a,c,e,f,g,h,i,j,k){function l(b){return(i(b)<b?t:h(b)<b?u:g(b)<b?v:f(b)<b?w:c(b)<b?e(b)<b?x:y:a(b)<b?z:A)(b)}function n(c,d,e,f){if(null==c&&(c=10),"number"==typeof c){var g=Math.abs(e-d)/c,h=b.bisector(function(a){return a[2]}).right(B,g);h===B.length?(f=b.tickStep(d/ba,e/ba,c),c=a):h?(h=B[g/B[h-1][2]<B[h][2]/g?h-1:h],f=h[1],c=h[0]):(f=b.tickStep(d,e,c),c=j)}return null==f?c:c.every(f)}var o=s(m,d.interpolateNumber),p=o.invert,q=o.domain,t=k(".%L"),u=k(":%S"),v=k("%I:%M"),w=k("%I %p"),x=k("%a %d"),y=k("%b %d"),z=k("%B"),A=k("%Y"),B=[[i,1,X],[i,5,5*X],[i,15,15*X],[i,30,30*X],[h,1,Y],[h,5,5*Y],[h,15,15*Y],[h,30,30*Y],[g,1,Z],[g,3,3*Z],[g,6,6*Z],[g,12,12*Z],[f,1,$],[f,2,2*$],[e,1,_],[c,1,aa],[c,3,3*aa],[a,1,ba]];return o.invert=function(a){return new Date(p(a))},o.domain=function(a){return arguments.length?q(P.call(a,K)):q().map(J)},o.ticks=function(a,b){var c,d=q(),e=d[0],f=d[d.length-1],g=e>f;return g&&(c=e,e=f,f=c),c=n(a,e,f,b),c=c?c.range(e,f+1):[],g?c.reverse():c},o.tickFormat=function(a,b){return null==b?l:k(b)},o.nice=function(a,b){var c=q();return(a=n(a,c[0],c[c.length-1],b))?q(W(c,a)):o},o.copy=function(){return r(o,L(a,c,e,f,g,h,i,j,k))},o}function M(a){var b=a.length;return function(c){return a[Math.max(0,Math.min(b-1,Math.floor(c*b)))]}}function N(a){function b(b){var f=(b-c)/(d-c);return a(e?Math.max(0,Math.min(1,f)):f)}var c=0,d=1,e=!1;return b.domain=function(a){return arguments.length?(c=+a[0],d=+a[1],b):[c,d]},b.clamp=function(a){return arguments.length?(e=!!a,b):e},b.interpolator=function(c){return arguments.length?(a=c,b):a},b.copy=function(){return N(a).domain([c,d]).clamp(e)},t(b)}var O=Array.prototype,P=O.map,Q=O.slice,R={name:"implicit"},S=function(a){return function(){return a}},T=function(a){return+a},U=[0,1],V=function(a,c,d){var f,g=a[0],h=a[a.length-1],i=b.tickStep(g,h,null==c?10:c);switch(d=e.formatSpecifier(null==d?",f":d),d.type){case"s":var j=Math.max(Math.abs(g),Math.abs(h));return null!=d.precision||isNaN(f=e.precisionPrefix(i,j))||(d.precision=f),e.formatPrefix(d,j);case"":case"e":case"g":case"p":case"r":null!=d.precision||isNaN(f=e.precisionRound(i,Math.max(Math.abs(g),Math.abs(h))))||(d.precision=f-("e"===d.type));break;case"f":case"%":null!=d.precision||isNaN(f=e.precisionFixed(i))||(d.precision=f-2*("%"===d.type))}return e.format(d)},W=function(a,b){a=a.slice();var c,d=0,e=a.length-1,f=a[d],g=a[e];return f>g&&(c=d,d=e,e=c,c=f,f=g,g=c),a[d]=b.floor(f),a[e]=b.ceil(g),a},X=1e3,Y=60*X,Z=60*Y,$=24*Z,_=7*$,aa=30*$,ba=365*$,ca=function(){return L(f.timeYear,f.timeMonth,f.timeWeek,f.timeDay,f.timeHour,f.timeMinute,f.timeSecond,f.timeMillisecond,g.timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)])},da=function(){return L(f.utcYear,f.utcMonth,f.utcWeek,f.utcDay,f.utcHour,f.utcMinute,f.utcSecond,f.utcMillisecond,g.utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)])},ea=function(a){return a.match(/.{6}/g).map(function(a){return"#"+a})},fa=ea("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),ga=ea("393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6"),ha=ea("3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9"),ia=ea("1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5"),ja=d.interpolateCubehelixLong(h.cubehelix(300,.5,0),h.cubehelix(-240,.5,1)),ka=d.interpolateCubehelixLong(h.cubehelix(-100,.75,.35),h.cubehelix(80,1.5,.8)),la=d.interpolateCubehelixLong(h.cubehelix(260,.75,.35),h.cubehelix(80,1.5,.8)),ma=h.cubehelix(),na=function(a){(0>a||a>1)&&(a-=Math.floor(a));var b=Math.abs(a-.5);return ma.h=360*a-100,ma.s=1.5-1.5*b,ma.l=.8-.9*b,ma+""},oa=M(ea("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),pa=M(ea("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),qa=M(ea("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),ra=M(ea("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));a.scaleBand=j,a.scalePoint=l,a.scaleIdentity=v,a.scaleLinear=u,a.scaleLog=C,a.scaleOrdinal=i,a.scaleImplicit=R,a.scalePow=E,a.scaleSqrt=F,a.scaleQuantile=G,a.scaleQuantize=H,a.scaleThreshold=I,a.scaleTime=ca,a.scaleUtc=da,a.schemeCategory10=fa,a.schemeCategory20b=ga,a.schemeCategory20c=ha,a.schemeCategory20=ia,a.interpolateCubehelixDefault=ja,a.interpolateRainbow=na,a.interpolateWarm=ka,a.interpolateCool=la,a.interpolateViridis=oa,a.interpolateMagma=pa,a.interpolateInferno=qa,a.interpolatePlasma=ra,a.scaleSequential=N,Object.defineProperty(a,"__esModule",{value:!0})})},{"d3-array":35,"d3-collection":37,"d3-color":38,"d3-format":43,"d3-interpolate":44,"d3-time":49,"d3-time-format":48}],47:[function(b,c,d){!function(b,e){"object"==typeof d&&"undefined"!=typeof c?e(d):"function"==typeof a&&a.amd?a(["exports"],e):e(b.d3=b.d3||{})}(this,function(a){"use strict";function b(a){return function(){var b=this.ownerDocument,c=this.namespaceURI;return c===$&&b.documentElement.namespaceURI===$?b.createElement(a):b.createElementNS(c,a)}}function c(a){return function(){return this.ownerDocument.createElementNS(a.space,a.local)}}function d(){return new e}function e(){this._="@"+(++ca).toString(36)}function f(a,b,c){return a=g(a,b,c),function(b){var c=b.relatedTarget;c&&(c===this||8&c.compareDocumentPosition(this))||a.call(this,b)}}function g(b,c,d){return function(e){var f=a.event;a.event=e;try{b.call(this,this.__data__,c,d)}finally{a.event=f}}}function h(a){return a.trim().split(/^|\s+/).map(function(a){var b="",c=a.indexOf(".");return c>=0&&(b=a.slice(c+1),a=a.slice(0,c)),{type:a,name:b}})}function i(a){return function(){var b=this.__on;if(b){for(var c,d=0,e=-1,f=b.length;f>d;++d)c=b[d],a.type&&c.type!==a.type||c.name!==a.name?b[++e]=c:this.removeEventListener(c.type,c.listener,c.capture);++e?b.length=e:delete this.__on}}}function j(a,b,c){var d=ha.hasOwnProperty(a.type)?f:g;return function(e,f,g){var h,i=this.__on,j=d(b,f,g);if(i)for(var k=0,l=i.length;l>k;++k)if((h=i[k]).type===a.type&&h.name===a.name)return this.removeEventListener(h.type,h.listener,h.capture),this.addEventListener(h.type,h.listener=j,h.capture=c),void(h.value=b);this.addEventListener(a.type,j,c),h={type:a.type,name:a.name,value:b,listener:j,capture:c},i?i.push(h):this.__on=[h]}}function k(b,c,d,e){var f=a.event;b.sourceEvent=a.event,a.event=b;try{return c.apply(d,e)}finally{a.event=f}}function l(){}function m(){return[]}function n(a,b){this.ownerDocument=a.ownerDocument,this.namespaceURI=a.namespaceURI,this._next=null,this._parent=a,this.__data__=b}function o(a,b,c,d,e,f){for(var g,h=0,i=b.length,j=f.length;j>h;++h)(g=b[h])?(g.__data__=f[h],d[h]=g):c[h]=new n(a,f[h]);for(;i>h;++h)(g=b[h])&&(e[h]=g)}function p(a,b,c,d,e,f,g){var h,i,j,k={},l=b.length,m=f.length,o=new Array(l);for(h=0;l>h;++h)(i=b[h])&&(o[h]=j=va+g.call(i,i.__data__,h,b),j in k?e[h]=i:k[j]=i);for(h=0;m>h;++h)j=va+g.call(a,f[h],h,f),(i=k[j])?(d[h]=i,i.__data__=f[h],k[j]=null):c[h]=new n(a,f[h]);for(h=0;l>h;++h)(i=b[h])&&k[o[h]]===i&&(e[h]=i)}function q(a,b){return b>a?-1:a>b?1:a>=b?0:NaN}function r(a){return function(){this.removeAttribute(a)}}function s(a){return function(){this.removeAttributeNS(a.space,a.local)}}function t(a,b){return function(){this.setAttribute(a,b)}}function u(a,b){return function(){this.setAttributeNS(a.space,a.local,b)}}function v(a,b){return function(){var c=b.apply(this,arguments);null==c?this.removeAttribute(a):this.setAttribute(a,c)}}function w(a,b){return function(){var c=b.apply(this,arguments);null==c?this.removeAttributeNS(a.space,a.local):this.setAttributeNS(a.space,a.local,c)}}function x(a){return function(){this.style.removeProperty(a)}}function y(a,b,c){return function(){this.style.setProperty(a,b,c)}}function z(a,b,c){return function(){var d=b.apply(this,arguments);null==d?this.style.removeProperty(a):this.style.setProperty(a,d,c)}}function A(a){return function(){delete this[a]}}function B(a,b){return function(){this[a]=b}}function C(a,b){return function(){var c=b.apply(this,arguments);null==c?delete this[a]:this[a]=c}}function D(a){return a.trim().split(/^|\s+/)}function E(a){return a.classList||new F(a)}function F(a){this._node=a,this._names=D(a.getAttribute("class")||"")}function G(a,b){for(var c=E(a),d=-1,e=b.length;++d<e;)c.add(b[d])}function H(a,b){for(var c=E(a),d=-1,e=b.length;++d<e;)c.remove(b[d])}function I(a){return function(){G(this,a)}}function J(a){return function(){H(this,a)}}function K(a,b){return function(){(b.apply(this,arguments)?G:H)(this,a)}}function L(){this.textContent=""}function M(a){return function(){this.textContent=a}}function N(a){return function(){var b=a.apply(this,arguments);this.textContent=null==b?"":b}}function O(){this.innerHTML=""}function P(a){return function(){this.innerHTML=a}}function Q(a){return function(){var b=a.apply(this,arguments);this.innerHTML=null==b?"":b}}function R(){this.nextSibling&&this.parentNode.appendChild(this)}function S(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function T(){return null}function U(){var a=this.parentNode;a&&a.removeChild(this)}function V(a,b,c){var d=Ia(a),e=d.CustomEvent;e?e=new e(b,c):(e=d.document.createEvent("Event"),c?(e.initEvent(b,c.bubbles,c.cancelable),e.detail=c.detail):e.initEvent(b,!1,!1)),a.dispatchEvent(e)}function W(a,b){return function(){return V(this,a,b)}}function X(a,b){return function(){return V(this,a,b.apply(this,arguments))}}function Y(a,b){this._groups=a,this._parents=b}function Z(){return new Y([[document.documentElement]],Va)}var $="http://www.w3.org/1999/xhtml",_={svg:"http://www.w3.org/2000/svg",xhtml:$,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},aa=function(a){var b=a+="",c=b.indexOf(":");return c>=0&&"xmlns"!==(b=a.slice(0,c))&&(a=a.slice(c+1)),_.hasOwnProperty(b)?{space:_[b],local:a}:a},ba=function(a){var d=aa(a);return(d.local?c:b)(d)},ca=0;e.prototype=d.prototype={constructor:e,get:function(a){for(var b=this._;!(b in a);)if(!(a=a.parentNode))return;return a[b]},set:function(a,b){return a[this._]=b},remove:function(a){return this._ in a&&delete a[this._]},toString:function(){return this._}};var da=function(a){return function(){return this.matches(a)}};if("undefined"!=typeof document){var ea=document.documentElement;if(!ea.matches){var fa=ea.webkitMatchesSelector||ea.msMatchesSelector||ea.mozMatchesSelector||ea.oMatchesSelector;da=function(a){return function(){return fa.call(this,a)}}}}var ga=da,ha={};if(a.event=null,"undefined"!=typeof document){var ia=document.documentElement;"onmouseenter"in ia||(ha={mouseenter:"mouseover",mouseleave:"mouseout"})}var ja=function(a,b,c){var d,e,f=h(a+""),g=f.length;{if(!(arguments.length<2)){for(k=b?j:i,null==c&&(c=!1),d=0;g>d;++d)this.each(k(f[d],b,c));return this}var k=this.node().__on;if(k)for(var l,m=0,n=k.length;n>m;++m)for(d=0,l=k[m];g>d;++d)if((e=f[d]).type===l.type&&e.name===l.name)return l.value}},ka=function(){for(var b,c=a.event;b=c.sourceEvent;)c=b;return c},la=function(a,b){var c=a.ownerSVGElement||a;if(c.createSVGPoint){var d=c.createSVGPoint();return d.x=b.clientX,d.y=b.clientY,d=d.matrixTransform(a.getScreenCTM().inverse()),[d.x,d.y]}var e=a.getBoundingClientRect();return[b.clientX-e.left-a.clientLeft,b.clientY-e.top-a.clientTop]},ma=function(a){var b=ka();return b.changedTouches&&(b=b.changedTouches[0]),la(a,b)},na=function(a){return null==a?l:function(){return this.querySelector(a)}},oa=function(a){"function"!=typeof a&&(a=na(a));for(var b=this._groups,c=b.length,d=new Array(c),e=0;c>e;++e)for(var f,g,h=b[e],i=h.length,j=d[e]=new Array(i),k=0;i>k;++k)(f=h[k])&&(g=a.call(f,f.__data__,k,h))&&("__data__"in f&&(g.__data__=f.__data__),j[k]=g);return new Y(d,this._parents)},pa=function(a){return null==a?m:function(){return this.querySelectorAll(a)}},qa=function(a){"function"!=typeof a&&(a=pa(a));for(var b=this._groups,c=b.length,d=[],e=[],f=0;c>f;++f)for(var g,h=b[f],i=h.length,j=0;i>j;++j)(g=h[j])&&(d.push(a.call(g,g.__data__,j,h)),e.push(g));return new Y(d,e)},ra=function(a){"function"!=typeof a&&(a=ga(a));for(var b=this._groups,c=b.length,d=new Array(c),e=0;c>e;++e)for(var f,g=b[e],h=g.length,i=d[e]=[],j=0;h>j;++j)(f=g[j])&&a.call(f,f.__data__,j,g)&&i.push(f);return new Y(d,this._parents)},sa=function(a){return new Array(a.length)},ta=function(){return new Y(this._enter||this._groups.map(sa),this._parents)};n.prototype={constructor:n,appendChild:function(a){return this._parent.insertBefore(a,this._next)},insertBefore:function(a,b){return this._parent.insertBefore(a,b)},querySelector:function(a){return this._parent.querySelector(a)},querySelectorAll:function(a){return this._parent.querySelectorAll(a)}};var ua=function(a){return function(){return a}},va="$",wa=function(a,b){if(!a)return n=new Array(this.size()),j=-1,this.each(function(a){n[++j]=a}),n;var c=b?p:o,d=this._parents,e=this._groups;"function"!=typeof a&&(a=ua(a));for(var f=e.length,g=new Array(f),h=new Array(f),i=new Array(f),j=0;f>j;++j){var k=d[j],l=e[j],m=l.length,n=a.call(k,k&&k.__data__,j,d),q=n.length,r=h[j]=new Array(q),s=g[j]=new Array(q),t=i[j]=new Array(m);c(k,l,r,s,t,n,b);for(var u,v,w=0,x=0;q>w;++w)if(u=r[w]){for(w>=x&&(x=w+1);!(v=s[x])&&++x<q;);u._next=v||null}}return g=new Y(g,d),g._enter=h,g._exit=i,g},xa=function(){return new Y(this._exit||this._groups.map(sa),this._parents)},ya=function(a){for(var b=this._groups,c=a._groups,d=b.length,e=c.length,f=Math.min(d,e),g=new Array(d),h=0;f>h;++h)for(var i,j=b[h],k=c[h],l=j.length,m=g[h]=new Array(l),n=0;l>n;++n)(i=j[n]||k[n])&&(m[n]=i);for(;d>h;++h)g[h]=b[h];return new Y(g,this._parents)},za=function(){for(var a=this._groups,b=-1,c=a.length;++b<c;)for(var d,e=a[b],f=e.length-1,g=e[f];--f>=0;)(d=e[f])&&(g&&g!==d.nextSibling&&g.parentNode.insertBefore(d,g),g=d);return this},Aa=function(a){function b(b,c){return b&&c?a(b.__data__,c.__data__):!b-!c}a||(a=q);for(var c=this._groups,d=c.length,e=new Array(d),f=0;d>f;++f){for(var g,h=c[f],i=h.length,j=e[f]=new Array(i),k=0;i>k;++k)(g=h[k])&&(j[k]=g);j.sort(b)}return new Y(e,this._parents).order()},Ba=function(){var a=arguments[0];return arguments[0]=this,a.apply(null,arguments),this},Ca=function(){var a=new Array(this.size()),b=-1;return this.each(function(){a[++b]=this}),a},Da=function(){for(var a=this._groups,b=0,c=a.length;c>b;++b)for(var d=a[b],e=0,f=d.length;f>e;++e){var g=d[e];if(g)return g}return null},Ea=function(){var a=0;return this.each(function(){++a}),a},Fa=function(){return!this.node()},Ga=function(a){for(var b=this._groups,c=0,d=b.length;d>c;++c)for(var e,f=b[c],g=0,h=f.length;h>g;++g)(e=f[g])&&a.call(e,e.__data__,g,f);return this},Ha=function(a,b){var c=aa(a);if(arguments.length<2){var d=this.node();return c.local?d.getAttributeNS(c.space,c.local):d.getAttribute(c)}return this.each((null==b?c.local?s:r:"function"==typeof b?c.local?w:v:c.local?u:t)(c,b))},Ia=function(a){return a.ownerDocument&&a.ownerDocument.defaultView||a.document&&a||a.defaultView},Ja=function(a,b,c){var d;return arguments.length>1?this.each((null==b?x:"function"==typeof b?z:y)(a,b,null==c?"":c)):Ia(d=this.node()).getComputedStyle(d,null).getPropertyValue(a)},Ka=function(a,b){return arguments.length>1?this.each((null==b?A:"function"==typeof b?C:B)(a,b)):this.node()[a]};F.prototype={add:function(a){var b=this._names.indexOf(a);0>b&&(this._names.push(a),this._node.setAttribute("class",this._names.join(" ")))},remove:function(a){var b=this._names.indexOf(a);b>=0&&(this._names.splice(b,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(a){return this._names.indexOf(a)>=0}};var La=function(a,b){var c=D(a+"");if(arguments.length<2){for(var d=E(this.node()),e=-1,f=c.length;++e<f;)if(!d.contains(c[e]))return!1;return!0}return this.each(("function"==typeof b?K:b?I:J)(c,b))},Ma=function(a){return arguments.length?this.each(null==a?L:("function"==typeof a?N:M)(a)):this.node().textContent},Na=function(a){return arguments.length?this.each(null==a?O:("function"==typeof a?Q:P)(a)):this.node().innerHTML},Oa=function(){return this.each(R)},Pa=function(){return this.each(S)},Qa=function(a){var b="function"==typeof a?a:ba(a);return this.select(function(){return this.appendChild(b.apply(this,arguments))})},Ra=function(a,b){var c="function"==typeof a?a:ba(a),d=null==b?T:"function"==typeof b?b:na(b);return this.select(function(){return this.insertBefore(c.apply(this,arguments),d.apply(this,arguments)||null)})},Sa=function(){return this.each(U)},Ta=function(a){return arguments.length?this.property("__data__",a):this.node().__data__},Ua=function(a,b){return this.each(("function"==typeof b?X:W)(a,b))},Va=[null];Y.prototype=Z.prototype={constructor:Y,select:oa,selectAll:qa,filter:ra,data:wa,enter:ta,exit:xa,merge:ya,order:za,sort:Aa,call:Ba,nodes:Ca,node:Da,size:Ea,empty:Fa,each:Ga,attr:Ha,style:Ja,property:Ka,classed:La,text:Ma,html:Na,raise:Oa,lower:Pa,append:Qa,insert:Ra,remove:Sa,datum:Ta,on:ja,dispatch:Ua};var Wa=function(a){return"string"==typeof a?new Y([[document.querySelector(a)]],[document.documentElement]):new Y([[a]],Va)},Xa=function(a){return"string"==typeof a?new Y([document.querySelectorAll(a)],[document.documentElement]):new Y([null==a?[]:a],Va)},Ya=function(a,b,c){arguments.length<3&&(c=b,b=ka().changedTouches);for(var d,e=0,f=b?b.length:0;f>e;++e)if((d=b[e]).identifier===c)return la(a,d);return null},Za=function(a,b){null==b&&(b=ka().touches);for(var c=0,d=b?b.length:0,e=new Array(d);d>c;++c)e[c]=la(a,b[c]);return e};a.creator=ba,a.local=d,a.matcher=ga,a.mouse=ma,a.namespace=aa,a.namespaces=_,a.select=Wa,a.selectAll=Xa,a.selection=Z,a.selector=na,a.selectorAll=pa,a.touch=Ya,a.touches=Za,a.window=Ia,a.customEvent=k,Object.defineProperty(a,"__esModule",{value:!0})})},{}],48:[function(b,c,d){!function(e,f){"object"==typeof d&&"undefined"!=typeof c?f(d,b("d3-time")):"function"==typeof a&&a.amd?a(["exports","d3-time"],f):f(e.d3=e.d3||{},e.d3)}(this,function(a,b){"use strict";function c(a){if(0<=a.y&&a.y<100){var b=new Date(-1,a.m,a.d,a.H,a.M,a.S,a.L);return b.setFullYear(a.y),b}return new Date(a.y,a.m,a.d,a.H,a.M,a.S,a.L)}function d(a){if(0<=a.y&&a.y<100){var b=new Date(Date.UTC(-1,a.m,a.d,a.H,a.M,a.S,a.L));return b.setUTCFullYear(a.y),b}return new Date(Date.UTC(a.y,a.m,a.d,a.H,a.M,a.S,a.L))}function e(a){return{y:a,m:0,d:1,H:0,M:0,S:0,L:0}}function f(a){function b(a,b){return function(c){var d,e,f,g=[],h=-1,i=0,j=a.length;for(c instanceof Date||(c=new Date(+c));++h<j;)37===a.charCodeAt(h)&&(g.push(a.slice(i,h)),null!=(e=da[d=a.charAt(++h)])?d=a.charAt(++h):e="e"===d?" ":"0",(f=b[d])&&(d=f(c,e)),g.push(d),i=h+1);return g.push(a.slice(i,h)),g.join("")}}function f(a,b){return function(c){var f=e(1900),h=g(f,a,c+="",0);if(h!=c.length)return null;if("p"in f&&(f.H=f.H%12+12*f.p),"W"in f||"U"in f){"w"in f||(f.w="W"in f?1:0);var i="Z"in f?d(e(f.y)).getUTCDay():b(e(f.y)).getDay();f.m=0,f.d="W"in f?(f.w+6)%7+7*f.W-(i+5)%7:f.w+7*f.U-(i+6)%7}return"Z"in f?(f.H+=f.Z/100|0,f.M+=f.Z%100,d(f)):b(f)}}function g(a,b,c,d){for(var e,f,g=0,h=b.length,i=c.length;h>g;){if(d>=i)return-1;if(e=b.charCodeAt(g++),37===e){if(e=b.charAt(g++),f=La[e in da?b.charAt(g++):e],!f||(d=f(a,c,d))<0)return-1}else if(e!=c.charCodeAt(d++))return-1}return d}function h(a,b,c){var d=za.exec(b.slice(c));return d?(a.p=Aa[d[0].toLowerCase()],c+d[0].length):-1}function _(a,b,c){var d=Da.exec(b.slice(c));return d?(a.w=Ea[d[0].toLowerCase()],c+d[0].length):-1}function aa(a,b,c){var d=Ba.exec(b.slice(c));return d?(a.w=Ca[d[0].toLowerCase()],c+d[0].length):-1}function ba(a,b,c){var d=Ha.exec(b.slice(c));return d?(a.m=Ia[d[0].toLowerCase()],c+d[0].length):-1}function ca(a,b,c){var d=Fa.exec(b.slice(c));return d?(a.m=Ga[d[0].toLowerCase()],c+d[0].length):-1}function ea(a,b,c){return g(a,ra,b,c)}function fa(a,b,c){return g(a,sa,b,c)}function ga(a,b,c){return g(a,ta,b,c)}function ha(a){return wa[a.getDay()]}function ia(a){return va[a.getDay()]}function ja(a){return ya[a.getMonth()]}function ka(a){return xa[a.getMonth()]}function la(a){return ua[+(a.getHours()>=12)]}function ma(a){return wa[a.getUTCDay()]}function na(a){return va[a.getUTCDay()]}function oa(a){return ya[a.getUTCMonth()]}function pa(a){return xa[a.getUTCMonth()]}function qa(a){return ua[+(a.getUTCHours()>=12)]}var ra=a.dateTime,sa=a.date,ta=a.time,ua=a.periods,va=a.days,wa=a.shortDays,xa=a.months,ya=a.shortMonths,za=i(ua),Aa=j(ua),Ba=i(va),Ca=j(va),Da=i(wa),Ea=j(wa),Fa=i(xa),Ga=j(xa),Ha=i(ya),Ia=j(ya),Ja={a:ha,A:ia,b:ja,B:ka,c:null,d:y,e:y,H:z,I:A,j:B,L:C,m:D,M:E,p:la,S:F,U:G,w:H,W:I,x:null,X:null,y:J,Y:K,Z:L,"%":$},Ka={a:ma,A:na,b:oa,B:pa,c:null,d:M,e:M,H:N,I:O,j:P,L:Q,m:R,M:S,p:qa,S:T,U:U,w:V,W:W,x:null,X:null,y:X,Y:Y,Z:Z,"%":$},La={a:_,A:aa,b:ba,B:ca,c:ea,d:r,e:r,H:t,I:t,j:s,L:w,m:q,M:u,p:h,S:v,U:l,w:k,W:m,x:fa,X:ga,y:o,Y:n,Z:p,"%":x};return Ja.x=b(sa,Ja),Ja.X=b(ta,Ja),Ja.c=b(ra,Ja),Ka.x=b(sa,Ka),Ka.X=b(ta,Ka),Ka.c=b(ra,Ka),{format:function(a){var c=b(a+="",Ja);return c.toString=function(){return a},c},parse:function(a){var b=f(a+="",c);return b.toString=function(){return a},b},utcFormat:function(a){var c=b(a+="",Ka);return c.toString=function(){return a},c},utcParse:function(a){var b=f(a,d);return b.toString=function(){return a},b}}}function g(a,b,c){var d=0>a?"-":"",e=(d?-a:a)+"",f=e.length;return d+(c>f?new Array(c-f+1).join(b)+e:e)}function h(a){return a.replace(ga,"\\$&")}function i(a){return new RegExp("^(?:"+a.map(h).join("|")+")","i")}function j(a){for(var b={},c=-1,d=a.length;++c<d;)b[a[c].toLowerCase()]=c;return b}function k(a,b,c){var d=ea.exec(b.slice(c,c+1));return d?(a.w=+d[0],c+d[0].length):-1}function l(a,b,c){var d=ea.exec(b.slice(c));return d?(a.U=+d[0],c+d[0].length):-1}function m(a,b,c){var d=ea.exec(b.slice(c));return d?(a.W=+d[0],c+d[0].length):-1}function n(a,b,c){var d=ea.exec(b.slice(c,c+4));return d?(a.y=+d[0],c+d[0].length):-1}function o(a,b,c){var d=ea.exec(b.slice(c,c+2));return d?(a.y=+d[0]+(+d[0]>68?1900:2e3),c+d[0].length):-1}function p(a,b,c){var d=/^(Z)|([+-]\d\d)(?:\:?(\d\d))?/.exec(b.slice(c,c+6));return d?(a.Z=d[1]?0:-(d[2]+(d[3]||"00")),c+d[0].length):-1}function q(a,b,c){var d=ea.exec(b.slice(c,c+2));return d?(a.m=d[0]-1,c+d[0].length):-1}function r(a,b,c){var d=ea.exec(b.slice(c,c+2));return d?(a.d=+d[0],c+d[0].length):-1}function s(a,b,c){var d=ea.exec(b.slice(c,c+3));return d?(a.m=0,a.d=+d[0],c+d[0].length):-1}function t(a,b,c){var d=ea.exec(b.slice(c,c+2));return d?(a.H=+d[0],c+d[0].length):-1}function u(a,b,c){var d=ea.exec(b.slice(c,c+2));return d?(a.M=+d[0],c+d[0].length):-1}function v(a,b,c){var d=ea.exec(b.slice(c,c+2));return d?(a.S=+d[0],c+d[0].length):-1}function w(a,b,c){var d=ea.exec(b.slice(c,c+3));return d?(a.L=+d[0],c+d[0].length):-1}function x(a,b,c){var d=fa.exec(b.slice(c,c+1));return d?c+d[0].length:-1}function y(a,b){return g(a.getDate(),b,2)}function z(a,b){return g(a.getHours(),b,2)}function A(a,b){return g(a.getHours()%12||12,b,2)}function B(a,c){return g(1+b.timeDay.count(b.timeYear(a),a),c,3)}function C(a,b){return g(a.getMilliseconds(),b,3)}function D(a,b){return g(a.getMonth()+1,b,2)}function E(a,b){return g(a.getMinutes(),b,2)}function F(a,b){return g(a.getSeconds(),b,2)}function G(a,c){return g(b.timeSunday.count(b.timeYear(a),a),c,2)}function H(a){return a.getDay()}function I(a,c){return g(b.timeMonday.count(b.timeYear(a),a),c,2)}function J(a,b){return g(a.getFullYear()%100,b,2)}function K(a,b){return g(a.getFullYear()%1e4,b,4)}function L(a){var b=a.getTimezoneOffset();return(b>0?"-":(b*=-1,"+"))+g(b/60|0,"0",2)+g(b%60,"0",2)}function M(a,b){return g(a.getUTCDate(),b,2)}function N(a,b){return g(a.getUTCHours(),b,2)}function O(a,b){return g(a.getUTCHours()%12||12,b,2)}function P(a,c){return g(1+b.utcDay.count(b.utcYear(a),a),c,3)}function Q(a,b){return g(a.getUTCMilliseconds(),b,3)}function R(a,b){return g(a.getUTCMonth()+1,b,2)}function S(a,b){return g(a.getUTCMinutes(),b,2)}function T(a,b){return g(a.getUTCSeconds(),b,2)}function U(a,c){return g(b.utcSunday.count(b.utcYear(a),a),c,2)}function V(a){return a.getUTCDay()}function W(a,c){return g(b.utcMonday.count(b.utcYear(a),a),c,2)}function X(a,b){return g(a.getUTCFullYear()%100,b,2)}function Y(a,b){return g(a.getUTCFullYear()%1e4,b,4)}function Z(){return"+0000"}function $(){return"%"}function _(b){return ca=f(b),a.timeFormat=ca.format,a.timeParse=ca.parse,a.utcFormat=ca.utcFormat,a.utcParse=ca.utcParse,ca}function aa(a){return a.toISOString()}function ba(a){var b=new Date(a);return isNaN(b)?null:b}var ca,da={"-":"",_:" ",0:"0"},ea=/^\s*\d+/,fa=/^%/,ga=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;_({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var ha="%Y-%m-%dT%H:%M:%S.%LZ",ia=Date.prototype.toISOString?aa:a.utcFormat(ha),ja=+new Date("2000-01-01T00:00:00.000Z")?ba:a.utcParse(ha);a.timeFormatDefaultLocale=_,a.timeFormatLocale=f,a.isoFormat=ia,a.isoParse=ja,Object.defineProperty(a,"__esModule",{value:!0})})},{"d3-time":49}],49:[function(b,c,d){!function(b,e){"object"==typeof d&&"undefined"!=typeof c?e(d):"function"==typeof a&&a.amd?a(["exports"],e):e(b.d3=b.d3||{})}(this,function(a){"use strict";function b(a,c,d,g){function h(b){return a(b=new Date(+b)),b}return h.floor=h,h.ceil=function(b){return a(b=new Date(b-1)),c(b,1),a(b),b},h.round=function(a){var b=h(a),c=h.ceil(a);return c-a>a-b?b:c},h.offset=function(a,b){return c(a=new Date(+a),null==b?1:Math.floor(b)),a},h.range=function(b,d,e){var f=[];if(b=h.ceil(b),e=null==e?1:Math.floor(e),!(d>b&&e>0))return f;do f.push(new Date(+b));while(c(b,e),a(b),d>b);return f},h.filter=function(d){return b(function(b){if(b>=b)for(;a(b),!d(b);)b.setTime(b-1)},function(a,b){if(a>=a)for(;--b>=0;)for(;c(a,1),!d(a););})},d&&(h.count=function(b,c){
return e.setTime(+b),f.setTime(+c),a(e),a(f),Math.floor(d(e,f))},h.every=function(a){return a=Math.floor(a),isFinite(a)&&a>0?a>1?h.filter(g?function(b){return g(b)%a===0}:function(b){return h.count(0,b)%a===0}):h:null}),h}function c(a){return b(function(b){b.setDate(b.getDate()-(b.getDay()+7-a)%7),b.setHours(0,0,0,0)},function(a,b){a.setDate(a.getDate()+7*b)},function(a,b){return(b-a-(b.getTimezoneOffset()-a.getTimezoneOffset())*j)/m})}function d(a){return b(function(b){b.setUTCDate(b.getUTCDate()-(b.getUTCDay()+7-a)%7),b.setUTCHours(0,0,0,0)},function(a,b){a.setUTCDate(a.getUTCDate()+7*b)},function(a,b){return(b-a)/m})}var e=new Date,f=new Date,g=b(function(){},function(a,b){a.setTime(+a+b)},function(a,b){return b-a});g.every=function(a){return a=Math.floor(a),isFinite(a)&&a>0?a>1?b(function(b){b.setTime(Math.floor(b/a)*a)},function(b,c){b.setTime(+b+c*a)},function(b,c){return(c-b)/a}):g:null};var h=g.range,i=1e3,j=6e4,k=36e5,l=864e5,m=6048e5,n=b(function(a){a.setTime(Math.floor(a/i)*i)},function(a,b){a.setTime(+a+b*i)},function(a,b){return(b-a)/i},function(a){return a.getUTCSeconds()}),o=n.range,p=b(function(a){a.setTime(Math.floor(a/j)*j)},function(a,b){a.setTime(+a+b*j)},function(a,b){return(b-a)/j},function(a){return a.getMinutes()}),q=p.range,r=b(function(a){var b=a.getTimezoneOffset()*j%k;0>b&&(b+=k),a.setTime(Math.floor((+a-b)/k)*k+b)},function(a,b){a.setTime(+a+b*k)},function(a,b){return(b-a)/k},function(a){return a.getHours()}),s=r.range,t=b(function(a){a.setHours(0,0,0,0)},function(a,b){a.setDate(a.getDate()+b)},function(a,b){return(b-a-(b.getTimezoneOffset()-a.getTimezoneOffset())*j)/l},function(a){return a.getDate()-1}),u=t.range,v=c(0),w=c(1),x=c(2),y=c(3),z=c(4),A=c(5),B=c(6),C=v.range,D=w.range,E=x.range,F=y.range,G=z.range,H=A.range,I=B.range,J=b(function(a){a.setDate(1),a.setHours(0,0,0,0)},function(a,b){a.setMonth(a.getMonth()+b)},function(a,b){return b.getMonth()-a.getMonth()+12*(b.getFullYear()-a.getFullYear())},function(a){return a.getMonth()}),K=J.range,L=b(function(a){a.setMonth(0,1),a.setHours(0,0,0,0)},function(a,b){a.setFullYear(a.getFullYear()+b)},function(a,b){return b.getFullYear()-a.getFullYear()},function(a){return a.getFullYear()});L.every=function(a){return isFinite(a=Math.floor(a))&&a>0?b(function(b){b.setFullYear(Math.floor(b.getFullYear()/a)*a),b.setMonth(0,1),b.setHours(0,0,0,0)},function(b,c){b.setFullYear(b.getFullYear()+c*a)}):null};var M=L.range,N=b(function(a){a.setUTCSeconds(0,0)},function(a,b){a.setTime(+a+b*j)},function(a,b){return(b-a)/j},function(a){return a.getUTCMinutes()}),O=N.range,P=b(function(a){a.setUTCMinutes(0,0,0)},function(a,b){a.setTime(+a+b*k)},function(a,b){return(b-a)/k},function(a){return a.getUTCHours()}),Q=P.range,R=b(function(a){a.setUTCHours(0,0,0,0)},function(a,b){a.setUTCDate(a.getUTCDate()+b)},function(a,b){return(b-a)/l},function(a){return a.getUTCDate()-1}),S=R.range,T=d(0),U=d(1),V=d(2),W=d(3),X=d(4),Y=d(5),Z=d(6),$=T.range,_=U.range,aa=V.range,ba=W.range,ca=X.range,da=Y.range,ea=Z.range,fa=b(function(a){a.setUTCDate(1),a.setUTCHours(0,0,0,0)},function(a,b){a.setUTCMonth(a.getUTCMonth()+b)},function(a,b){return b.getUTCMonth()-a.getUTCMonth()+12*(b.getUTCFullYear()-a.getUTCFullYear())},function(a){return a.getUTCMonth()}),ga=fa.range,ha=b(function(a){a.setUTCMonth(0,1),a.setUTCHours(0,0,0,0)},function(a,b){a.setUTCFullYear(a.getUTCFullYear()+b)},function(a,b){return b.getUTCFullYear()-a.getUTCFullYear()},function(a){return a.getUTCFullYear()});ha.every=function(a){return isFinite(a=Math.floor(a))&&a>0?b(function(b){b.setUTCFullYear(Math.floor(b.getUTCFullYear()/a)*a),b.setUTCMonth(0,1),b.setUTCHours(0,0,0,0)},function(b,c){b.setUTCFullYear(b.getUTCFullYear()+c*a)}):null};var ia=ha.range;a.timeInterval=b,a.timeMillisecond=g,a.timeMilliseconds=h,a.utcMillisecond=g,a.utcMilliseconds=h,a.timeSecond=n,a.timeSeconds=o,a.utcSecond=n,a.utcSeconds=o,a.timeMinute=p,a.timeMinutes=q,a.timeHour=r,a.timeHours=s,a.timeDay=t,a.timeDays=u,a.timeWeek=v,a.timeWeeks=C,a.timeSunday=v,a.timeSundays=C,a.timeMonday=w,a.timeMondays=D,a.timeTuesday=x,a.timeTuesdays=E,a.timeWednesday=y,a.timeWednesdays=F,a.timeThursday=z,a.timeThursdays=G,a.timeFriday=A,a.timeFridays=H,a.timeSaturday=B,a.timeSaturdays=I,a.timeMonth=J,a.timeMonths=K,a.timeYear=L,a.timeYears=M,a.utcMinute=N,a.utcMinutes=O,a.utcHour=P,a.utcHours=Q,a.utcDay=R,a.utcDays=S,a.utcWeek=T,a.utcWeeks=$,a.utcSunday=T,a.utcSundays=$,a.utcMonday=U,a.utcMondays=_,a.utcTuesday=V,a.utcTuesdays=aa,a.utcWednesday=W,a.utcWednesdays=ba,a.utcThursday=X,a.utcThursdays=ca,a.utcFriday=Y,a.utcFridays=da,a.utcSaturday=Z,a.utcSaturdays=ea,a.utcMonth=fa,a.utcMonths=ga,a.utcYear=ha,a.utcYears=ia,Object.defineProperty(a,"__esModule",{value:!0})})},{}],50:[function(b,c,d){!function(b,e){"object"==typeof d&&"undefined"!=typeof c?e(d):"function"==typeof a&&a.amd?a(["exports"],e):e(b.d3=b.d3||{})}(this,function(a){"use strict";function b(){return r||(u(c),r=t.now()+s)}function c(){r=0}function d(){this._call=this._time=this._next=null}function e(a,b,c){var e=new d;return e.restart(a,b,c),e}function f(){b(),++m;for(var a,c=k;c;)(a=r-c._time)>=0&&c._call.call(null,a),c=c._next;--m}function g(){r=(q=t.now())+s,m=n=0;try{f()}finally{m=0,i(),r=0}}function h(){var a=t.now(),b=a-q;b>p&&(s-=b,q=a)}function i(){for(var a,b,c=k,d=1/0;c;)c._call?(d>c._time&&(d=c._time),a=c,c=c._next):(b=c._next,c._next=null,c=a?a._next=b:k=b);l=a,j(d)}function j(a){if(!m){n&&(n=clearTimeout(n));var b=a-r;b>24?(1/0>a&&(n=setTimeout(g,b)),o&&(o=clearInterval(o))):(o||(q=r,o=setInterval(h,p)),m=1,u(g))}}var k,l,m=0,n=0,o=0,p=1e3,q=0,r=0,s=0,t="object"==typeof performance&&performance.now?performance:Date,u="function"==typeof requestAnimationFrame?requestAnimationFrame:function(a){setTimeout(a,17)};d.prototype=e.prototype={constructor:d,restart:function(a,c,d){if("function"!=typeof a)throw new TypeError("callback is not a function");d=(null==d?b():+d)+(null==c?0:+c),this._next||l===this||(l?l._next=this:k=this,l=this),this._call=a,this._time=d,j()},stop:function(){this._call&&(this._call=null,this._time=1/0,j())}};var v=function(a,b,c){var e=new d;return b=null==b?0:+b,e.restart(function(c){e.stop(),a(c+b)},b,c),e},w=function(a,c,e){var f=new d,g=c;return null==c?(f.restart(a,c,e),f):(c=+c,e=null==e?b():+e,f.restart(function h(b){b+=g,f.restart(h,g+=c,e),a(b)},c,e),f)};a.now=b,a.timer=e,a.timerFlush=f,a.timeout=v,a.interval=w,Object.defineProperty(a,"__esModule",{value:!0})})},{}],51:[function(b,c,d){!function(e,f){"object"==typeof d&&"undefined"!=typeof c?f(d,b("d3-selection"),b("d3-dispatch"),b("d3-timer"),b("d3-interpolate"),b("d3-color"),b("d3-ease")):"function"==typeof a&&a.amd?a(["exports","d3-selection","d3-dispatch","d3-timer","d3-interpolate","d3-color","d3-ease"],f):f(e.d3=e.d3||{},e.d3,e.d3,e.d3,e.d3,e.d3,e.d3)}(this,function(a,b,c,d,e,f,g){"use strict";function h(a,b){var c=a.__transition;if(!c||!(c=c[b])||c.state>R)throw new Error("too late");return c}function i(a,b){var c=a.__transition;if(!c||!(c=c[b])||c.state>T)throw new Error("too late");return c}function j(a,b){var c=a.__transition;if(!c||!(c=c[b]))throw new Error("too late");return c}function k(a,b,c){function e(a){c.state=S,c.timer.restart(f,c.delay,c.time),c.delay<=a&&f(a-c.delay)}function f(e){var k,l,m,n;if(c.state!==S)return h();for(k in j)if(n=j[k],n.name===c.name){if(n.state===U)return d.timeout(f);n.state===V?(n.state=X,n.timer.stop(),n.on.call("interrupt",a,a.__data__,n.index,n.group),delete j[k]):b>+k&&(n.state=X,n.timer.stop(),delete j[k])}if(d.timeout(function(){c.state===U&&(c.state=V,c.timer.restart(g,c.delay,c.time),g(e))}),c.state=T,c.on.call("start",a,a.__data__,c.index,c.group),c.state===T){for(c.state=U,i=new Array(m=c.tween.length),k=0,l=-1;m>k;++k)(n=c.tween[k].value.call(a,a.__data__,c.index,c.group))&&(i[++l]=n);i.length=l+1}}function g(b){for(var d=b<c.duration?c.ease.call(null,b/c.duration):(c.timer.restart(h),c.state=W,1),e=-1,f=i.length;++e<f;)i[e].call(null,d);c.state===W&&(c.on.call("end",a,a.__data__,c.index,c.group),h())}function h(){c.state=X,c.timer.stop(),delete j[b];for(var d in j)return;delete a.__transition}var i,j=a.__transition;j[b]=c,c.timer=d.timer(e,0,c.time)}function l(a,b){var c,d;return function(){var e=i(this,a),f=e.tween;if(f!==c){d=c=f;for(var g=0,h=d.length;h>g;++g)if(d[g].name===b){d=d.slice(),d.splice(g,1);break}}e.tween=d}}function m(a,b,c){var d,e;if("function"!=typeof c)throw new Error;return function(){var f=i(this,a),g=f.tween;if(g!==d){e=(d=g).slice();for(var h={name:b,value:c},j=0,k=e.length;k>j;++j)if(e[j].name===b){e[j]=h;break}j===k&&e.push(h)}f.tween=e}}function n(a,b,c){var d=a._id;return a.each(function(){var a=i(this,d);(a.value||(a.value={}))[b]=c.apply(this,arguments)}),function(a){return j(a,d).value[b]}}function o(a){return function(){this.removeAttribute(a)}}function p(a){return function(){this.removeAttributeNS(a.space,a.local)}}function q(a,b,c){var d,e;return function(){var f=this.getAttribute(a);return f===c?null:f===d?e:e=b(d=f,c)}}function r(a,b,c){var d,e;return function(){var f=this.getAttributeNS(a.space,a.local);return f===c?null:f===d?e:e=b(d=f,c)}}function s(a,b,c){var d,e,f;return function(){var g,h=c(this);return null==h?void this.removeAttribute(a):(g=this.getAttribute(a),g===h?null:g===d&&h===e?f:f=b(d=g,e=h))}}function t(a,b,c){var d,e,f;return function(){var g,h=c(this);return null==h?void this.removeAttributeNS(a.space,a.local):(g=this.getAttributeNS(a.space,a.local),g===h?null:g===d&&h===e?f:f=b(d=g,e=h))}}function u(a,b){function c(){var c=this,d=b.apply(c,arguments);return d&&function(b){c.setAttributeNS(a.space,a.local,d(b))}}return c._value=b,c}function v(a,b){function c(){var c=this,d=b.apply(c,arguments);return d&&function(b){c.setAttribute(a,d(b))}}return c._value=b,c}function w(a,b){return function(){h(this,a).delay=+b.apply(this,arguments)}}function x(a,b){return b=+b,function(){h(this,a).delay=b}}function y(a,b){return function(){i(this,a).duration=+b.apply(this,arguments)}}function z(a,b){return b=+b,function(){i(this,a).duration=b}}function A(a,b){if("function"!=typeof b)throw new Error;return function(){i(this,a).ease=b}}function B(a){return(a+"").trim().split(/^|\s+/).every(function(a){var b=a.indexOf(".");return b>=0&&(a=a.slice(0,b)),!a||"start"===a})}function C(a,b,c){var d,e,f=B(b)?h:i;return function(){var g=f(this,a),h=g.on;h!==d&&(e=(d=h).copy()).on(b,c),g.on=e}}function D(a){return function(){var b=this.parentNode;for(var c in this.__transition)if(+c!==a)return;b&&b.removeChild(this)}}function E(a,c){var d,e,f;return function(){var g=b.window(this).getComputedStyle(this,null),h=g.getPropertyValue(a),i=(this.style.removeProperty(a),g.getPropertyValue(a));return h===i?null:h===d&&i===e?f:f=c(d=h,e=i)}}function F(a){return function(){this.style.removeProperty(a)}}function G(a,c,d){var e,f;return function(){var g=b.window(this).getComputedStyle(this,null).getPropertyValue(a);return g===d?null:g===e?f:f=c(e=g,d)}}function H(a,c,d){var e,f,g;return function(){var h=b.window(this).getComputedStyle(this,null),i=h.getPropertyValue(a),j=d(this);return null==j&&(this.style.removeProperty(a),j=h.getPropertyValue(a)),i===j?null:i===e&&j===f?g:g=c(e=i,f=j)}}function I(a,b,c){function d(){var d=this,e=b.apply(d,arguments);return e&&function(b){d.style.setProperty(a,e(b),c)}}return d._value=b,d}function J(a){return function(){this.textContent=a}}function K(a){return function(){var b=a(this);this.textContent=null==b?"":b}}function L(a,b,c,d){this._groups=a,this._parents=b,this._name=c,this._id=d}function M(a){return b.selection().transition(a)}function N(){return++sa}function O(a,b){for(var c;!(c=a.__transition)||!(c=c[b]);)if(!(a=a.parentNode))return ua.time=d.now(),ua;return c}var P=c.dispatch("start","end","interrupt"),Q=[],R=0,S=1,T=2,U=3,V=4,W=5,X=6,Y=function(a,b,c,d,e,f){var g=a.__transition;if(g){if(c in g)return}else a.__transition={};k(a,c,{name:b,index:d,group:e,on:P,tween:Q,time:f.time,delay:f.delay,duration:f.duration,ease:f.ease,timer:null,state:R})},Z=function(a,b){var c,d,e,f=a.__transition,g=!0;if(f){b=null==b?null:b+"";for(e in f)(c=f[e]).name===b?(d=c.state>T&&c.state<W,c.state=X,c.timer.stop(),d&&c.on.call("interrupt",a,a.__data__,c.index,c.group),delete f[e]):g=!1;g&&delete a.__transition}},$=function(a){return this.each(function(){Z(this,a)})},_=function(a,b){var c=this._id;if(a+="",arguments.length<2){for(var d,e=j(this.node(),c).tween,f=0,g=e.length;g>f;++f)if((d=e[f]).name===a)return d.value;return null}return this.each((null==b?l:m)(c,a,b))},aa=function(a,b){var c;return("number"==typeof b?e.interpolateNumber:b instanceof f.color?e.interpolateRgb:(c=f.color(b))?(b=c,e.interpolateRgb):e.interpolateString)(a,b)},ba=function(a,c){var d=b.namespace(a),f="transform"===d?e.interpolateTransformSvg:aa;return this.attrTween(a,"function"==typeof c?(d.local?t:s)(d,f,n(this,"attr."+a,c)):null==c?(d.local?p:o)(d):(d.local?r:q)(d,f,c))},ca=function(a,c){var d="attr."+a;if(arguments.length<2)return(d=this.tween(d))&&d._value;if(null==c)return this.tween(d,null);if("function"!=typeof c)throw new Error;var e=b.namespace(a);return this.tween(d,(e.local?u:v)(e,c))},da=function(a){var b=this._id;return arguments.length?this.each(("function"==typeof a?w:x)(b,a)):j(this.node(),b).delay},ea=function(a){var b=this._id;return arguments.length?this.each(("function"==typeof a?y:z)(b,a)):j(this.node(),b).duration},fa=function(a){var b=this._id;return arguments.length?this.each(A(b,a)):j(this.node(),b).ease},ga=function(a){"function"!=typeof a&&(a=b.matcher(a));for(var c=this._groups,d=c.length,e=new Array(d),f=0;d>f;++f)for(var g,h=c[f],i=h.length,j=e[f]=[],k=0;i>k;++k)(g=h[k])&&a.call(g,g.__data__,k,h)&&j.push(g);return new L(e,this._parents,this._name,this._id)},ha=function(a){if(a._id!==this._id)throw new Error;for(var b=this._groups,c=a._groups,d=b.length,e=c.length,f=Math.min(d,e),g=new Array(d),h=0;f>h;++h)for(var i,j=b[h],k=c[h],l=j.length,m=g[h]=new Array(l),n=0;l>n;++n)(i=j[n]||k[n])&&(m[n]=i);for(;d>h;++h)g[h]=b[h];return new L(g,this._parents,this._name,this._id)},ia=function(a,b){var c=this._id;return arguments.length<2?j(this.node(),c).on.on(a):this.each(C(c,a,b))},ja=function(){return this.on("end.remove",D(this._id))},ka=function(a){var c=this._name,d=this._id;"function"!=typeof a&&(a=b.selector(a));for(var e=this._groups,f=e.length,g=new Array(f),h=0;f>h;++h)for(var i,k,l=e[h],m=l.length,n=g[h]=new Array(m),o=0;m>o;++o)(i=l[o])&&(k=a.call(i,i.__data__,o,l))&&("__data__"in i&&(k.__data__=i.__data__),n[o]=k,Y(n[o],c,d,o,n,j(i,d)));return new L(g,this._parents,c,d)},la=function(a){var c=this._name,d=this._id;"function"!=typeof a&&(a=b.selectorAll(a));for(var e=this._groups,f=e.length,g=[],h=[],i=0;f>i;++i)for(var k,l=e[i],m=l.length,n=0;m>n;++n)if(k=l[n]){for(var o,p=a.call(k,k.__data__,n,l),q=j(k,d),r=0,s=p.length;s>r;++r)(o=p[r])&&Y(o,c,d,r,p,q);g.push(p),h.push(k)}return new L(g,h,c,d)},ma=b.selection.prototype.constructor,na=function(){return new ma(this._groups,this._parents)},oa=function(a,b,c){var d="transform"==(a+="")?e.interpolateTransformCss:aa;return null==b?this.styleTween(a,E(a,d)).on("end.style."+a,F(a)):this.styleTween(a,"function"==typeof b?H(a,d,n(this,"style."+a,b)):G(a,d,b),c)},pa=function(a,b,c){var d="style."+(a+="");if(arguments.length<2)return(d=this.tween(d))&&d._value;if(null==b)return this.tween(d,null);if("function"!=typeof b)throw new Error;return this.tween(d,I(a,b,null==c?"":c))},qa=function(a){return this.tween("text","function"==typeof a?K(n(this,"text",a)):J(null==a?"":a+""))},ra=function(){for(var a=this._name,b=this._id,c=N(),d=this._groups,e=d.length,f=0;e>f;++f)for(var g,h=d[f],i=h.length,k=0;i>k;++k)if(g=h[k]){var l=j(g,b);Y(g,a,c,k,h,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new L(d,this._parents,a,c)},sa=0,ta=b.selection.prototype;L.prototype=M.prototype={constructor:L,select:ka,selectAll:la,filter:ga,merge:ha,selection:na,transition:ra,call:ta.call,nodes:ta.nodes,node:ta.node,size:ta.size,empty:ta.empty,each:ta.each,on:ia,attr:ba,attrTween:ca,style:oa,styleTween:pa,text:qa,remove:ja,tween:_,delay:da,duration:ea,ease:fa};var ua={time:null,delay:0,duration:250,ease:g.easeCubicInOut},va=function(a){var b,c;a instanceof L?(b=a._id,a=a._name):(b=N(),(c=ua).time=d.now(),a=null==a?null:a+"");for(var e=this._groups,f=e.length,g=0;f>g;++g)for(var h,i=e[g],j=i.length,k=0;j>k;++k)(h=i[k])&&Y(h,a,b,k,i,c||O(h,b));return new L(e,this._parents,a,b)};b.selection.prototype.interrupt=$,b.selection.prototype.transition=va;var wa=[null],xa=function(a,b){var c,d,e=a.__transition;if(e){b=null==b?null:b+"";for(d in e)if((c=e[d]).state>S&&c.name===b)return new L([[a]],wa,b,+d)}return null};a.transition=M,a.active=xa,a.interrupt=Z,Object.defineProperty(a,"__esModule",{value:!0})})},{"d3-color":38,"d3-dispatch":39,"d3-ease":42,"d3-interpolate":44,"d3-selection":47,"d3-timer":50}],52:[function(b,c,d){!function(e,f){"object"==typeof d&&"undefined"!=typeof c?f(d,b("d3-dispatch"),b("d3-drag"),b("d3-interpolate"),b("d3-selection"),b("d3-transition")):"function"==typeof a&&a.amd?a(["exports","d3-dispatch","d3-drag","d3-interpolate","d3-selection","d3-transition"],f):f(e.d3=e.d3||{},e.d3,e.d3,e.d3,e.d3,e.d3)}(this,function(a,b,c,d,e,f){"use strict";function g(a,b,c){this.target=a,this.type=b,this.transform=c}function h(a,b,c){this.k=a,this.x=b,this.y=c}function i(a){return a.__zoom||o}function j(){e.event.stopImmediatePropagation()}function k(){return!e.event.button}function l(){var a,b,c=this;return c instanceof SVGElement?(c=c.ownerSVGElement||c,a=c.width.baseVal.value,b=c.height.baseVal.value):(a=c.clientWidth,b=c.clientHeight),[[0,0],[a,b]]}function m(){return this.__zoom||o}var n=function(a){return function(){return a}};h.prototype={constructor:h,scale:function(a){return 1===a?this:new h(this.k*a,this.x,this.y)},translate:function(a,b){return 0===a&0===b?this:new h(this.k,this.x+this.k*a,this.y+this.k*b)},apply:function(a){return[a[0]*this.k+this.x,a[1]*this.k+this.y]},applyX:function(a){return a*this.k+this.x},applyY:function(a){return a*this.k+this.y},invert:function(a){return[(a[0]-this.x)/this.k,(a[1]-this.y)/this.k]},invertX:function(a){return(a-this.x)/this.k},invertY:function(a){return(a-this.y)/this.k},rescaleX:function(a){return a.copy().domain(a.range().map(this.invertX,this).map(a.invert,a))},rescaleY:function(a){return a.copy().domain(a.range().map(this.invertY,this).map(a.invert,a))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var o=new h(1,0,0);i.prototype=h.prototype;var p=function(){e.event.preventDefault(),e.event.stopImmediatePropagation()},q=function(){function a(a){a.on("wheel.zoom",v).on("mousedown.zoom",w).on("dblclick.zoom",x).on("touchstart.zoom",y).on("touchmove.zoom",z).on("touchend.zoom touchcancel.zoom",A).style("-webkit-tap-highlight-color","rgba(0,0,0,0)").property("__zoom",m)}function i(a,b){return b=Math.max(F,Math.min(G,b)),b===a.k?a:new h(b,a.x,a.y)}function o(a,b,c){var d=b[0]-c[0]*a.k,e=b[1]-c[1]*a.k;return d===a.x&&e===a.y?a:new h(a.k,d,e)}function q(a,b){var c=a.invertX(b[0][0])-H,d=a.invertX(b[1][0])-I,e=a.invertY(b[0][1])-J,f=a.invertY(b[1][1])-K;return a.translate(d>c?(c+d)/2:Math.min(0,c)||Math.max(0,d),f>e?(e+f)/2:Math.min(0,e)||Math.max(0,f))}function r(a){return[(+a[0][0]+ +a[1][0])/2,(+a[0][1]+ +a[1][1])/2]}function s(a,b,c){a.on("start.zoom",function(){t(this,arguments).start()}).on("interrupt.zoom end.zoom",function(){t(this,arguments).end()}).tween("zoom",function(){var a=this,d=arguments,e=t(a,d),f=E.apply(a,d),g=c||r(f),i=Math.max(f[1][0]-f[0][0],f[1][1]-f[0][1]),j=a.__zoom,k="function"==typeof b?b.apply(a,d):b,l=M(j.invert(g).concat(i/j.k),k.invert(g).concat(i/k.k));return function(a){if(1===a)a=k;else{var b=l(a),c=i/b[2];a=new h(c,g[0]-b[0]*c,g[1]-b[1]*c)}e.zoom(null,a)}})}function t(a,b){for(var c,d=0,e=N.length;e>d;++d)if((c=N[d]).that===a)return c;return new u(a,b)}function u(a,b){this.that=a,this.args=b,this.index=-1,this.active=0,this.extent=E.apply(a,b)}function v(){function a(){b.wheel=null,b.end()}if(D.apply(this,arguments)){var b=t(this,arguments),c=this.__zoom,d=Math.max(F,Math.min(G,c.k*Math.pow(2,-e.event.deltaY*(e.event.deltaMode?120:1)/500))),g=e.mouse(this);if(b.wheel)(b.mouse[0][0]!==g[0]||b.mouse[0][1]!==g[1])&&(b.mouse[1]=c.invert(b.mouse[0]=g)),clearTimeout(b.wheel);else{if(c.k===d)return;b.mouse=[g,c.invert(g)],f.interrupt(this),b.start()}p(),b.wheel=setTimeout(a,Q),b.zoom("mouse",q(o(i(c,d),b.mouse[0],b.mouse[1]),b.extent))}}function w(){function a(){p(),d.moved=!0,d.zoom("mouse",q(o(d.that.__zoom,d.mouse[0]=e.mouse(d.that),d.mouse[1]),d.extent))}function b(){g.on("mousemove.zoom mouseup.zoom",null),c.dragEnable(e.event.view,d.moved),p(),d.end()}if(!C&&D.apply(this,arguments)){var d=t(this,arguments),g=e.select(e.event.view).on("mousemove.zoom",a,!0).on("mouseup.zoom",b,!0),h=e.mouse(this);c.dragDisable(e.event.view),j(),d.mouse=[h,this.__zoom.invert(h)],f.interrupt(this),d.start()}}function x(){if(D.apply(this,arguments)){var b=this.__zoom,c=e.mouse(this),d=b.invert(c),f=b.k*(e.event.shiftKey?.5:2),g=q(o(i(b,f),c,d),E.apply(this,arguments));p(),L>0?e.select(this).transition().duration(L).call(s,g,c):e.select(this).call(a.transform,g)}}function y(){if(D.apply(this,arguments)){var a,b,c,d,g=t(this,arguments),h=e.event.changedTouches,i=h.length;for(j(),b=0;i>b;++b)c=h[b],d=e.touch(this,h,c.identifier),d=[d,this.__zoom.invert(d),c.identifier],g.touch0?g.touch1||(g.touch1=d):(g.touch0=d,a=!0);return B&&(B=clearTimeout(B),!g.touch1)?(g.end(),d=e.select(this).on("dblclick.zoom"),void(d&&d.apply(this,arguments))):void(a&&(B=setTimeout(function(){B=null},P),f.interrupt(this),g.start()))}}function z(){var a,b,c,d,f=t(this,arguments),g=e.event.changedTouches,h=g.length;for(p(),B&&(B=clearTimeout(B)),a=0;h>a;++a)b=g[a],c=e.touch(this,g,b.identifier),f.touch0&&f.touch0[2]===b.identifier?f.touch0[0]=c:f.touch1&&f.touch1[2]===b.identifier&&(f.touch1[0]=c);if(b=f.that.__zoom,f.touch1){var j=f.touch0[0],k=f.touch0[1],l=f.touch1[0],m=f.touch1[1],n=(n=l[0]-j[0])*n+(n=l[1]-j[1])*n,r=(r=m[0]-k[0])*r+(r=m[1]-k[1])*r;b=i(b,Math.sqrt(n/r)),c=[(j[0]+l[0])/2,(j[1]+l[1])/2],d=[(k[0]+m[0])/2,(k[1]+m[1])/2]}else{if(!f.touch0)return;c=f.touch0[0],d=f.touch0[1]}f.zoom("touch",q(o(b,c,d),f.extent))}function A(){var a,b,c=t(this,arguments),d=e.event.changedTouches,f=d.length;for(j(),C&&clearTimeout(C),C=setTimeout(function(){C=null},P),a=0;f>a;++a)b=d[a],c.touch0&&c.touch0[2]===b.identifier?delete c.touch0:c.touch1&&c.touch1[2]===b.identifier&&delete c.touch1;c.touch1&&!c.touch0&&(c.touch0=c.touch1,delete c.touch1),c.touch0||c.end()}var B,C,D=k,E=l,F=0,G=1/0,H=-G,I=G,J=H,K=I,L=250,M=d.interpolateZoom,N=[],O=b.dispatch("start","zoom","end"),P=500,Q=150;return a.transform=function(a,b){var c=a.selection?a.selection():a;c.property("__zoom",m),a!==c?s(a,b):c.interrupt().each(function(){t(this,arguments).start().zoom(null,"function"==typeof b?b.apply(this,arguments):b).end()})},a.scaleBy=function(b,c){a.scaleTo(b,function(){var a=this.__zoom.k,b="function"==typeof c?c.apply(this,arguments):c;return a*b})},a.scaleTo=function(b,c){a.transform(b,function(){var a=E.apply(this,arguments),b=this.__zoom,d=r(a),e=b.invert(d),f="function"==typeof c?c.apply(this,arguments):c;return q(o(i(b,f),d,e),a)})},a.translateBy=function(b,c,d){a.transform(b,function(){return q(this.__zoom.translate("function"==typeof c?c.apply(this,arguments):c,"function"==typeof d?d.apply(this,arguments):d),E.apply(this,arguments))})},u.prototype={start:function(){return 1===++this.active&&(this.index=N.push(this)-1,this.emit("start")),this},zoom:function(a,b){return this.mouse&&"mouse"!==a&&(this.mouse[1]=b.invert(this.mouse[0])),this.touch0&&"touch"!==a&&(this.touch0[1]=b.invert(this.touch0[0])),this.touch1&&"touch"!==a&&(this.touch1[1]=b.invert(this.touch1[0])),this.that.__zoom=b,this.emit("zoom"),this},end:function(){return 0===--this.active&&(N.splice(this.index,1),this.index=-1,this.emit("end")),this},emit:function(b){e.customEvent(new g(a,b,this.that.__zoom),O.apply,O,[b,this.that,this.args])}},a.filter=function(b){return arguments.length?(D="function"==typeof b?b:n(!!b),a):D},a.extent=function(b){return arguments.length?(E="function"==typeof b?b:n([[+b[0][0],+b[0][1]],[+b[1][0],+b[1][1]]]),a):E},a.scaleExtent=function(b){return arguments.length?(F=+b[0],G=+b[1],a):[F,G]},a.translateExtent=function(b){return arguments.length?(H=+b[0][0],I=+b[1][0],J=+b[0][1],K=+b[1][1],a):[[H,J],[I,K]]},a.duration=function(b){return arguments.length?(L=+b,a):L},a.interpolate=function(b){return arguments.length?(M=b,a):M},a.on=function(){var b=O.on.apply(O,arguments);return b===O?a:b},a};a.zoom=q,a.zoomTransform=i,a.zoomIdentity=o,Object.defineProperty(a,"__esModule",{value:!0})})},{"d3-dispatch":39,"d3-drag":40,"d3-interpolate":44,"d3-selection":47,"d3-transition":51}],53:[function(b,c,d){var e=e||function(a){"use strict";if(!("undefined"==typeof a||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var b=a.document,c=function(){return a.URL||a.webkitURL||a},d=b.createElementNS("http://www.w3.org/1999/xhtml","a"),e="download"in d,f=function(a){var b=new MouseEvent("click");a.dispatchEvent(b)},g=/constructor/i.test(a.HTMLElement)||a.safari,h=/CriOS\/[\d]+/.test(navigator.userAgent),i=function(b){(a.setImmediate||a.setTimeout)(function(){throw b},0)},j="application/octet-stream",k=4e4,l=function(a){var b=function(){"string"==typeof a?c().revokeObjectURL(a):a.remove()};setTimeout(b,k)},m=function(a,b,c){b=[].concat(b);for(var d=b.length;d--;){var e=a["on"+b[d]];if("function"==typeof e)try{e.call(a,c||a)}catch(f){i(f)}}},n=function(a){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob([String.fromCharCode(65279),a],{type:a.type}):a},o=function(b,i,k){k||(b=n(b));var o,p=this,q=b.type,r=q===j,s=function(){m(p,"writestart progress write writeend".split(" "))},t=function(){if((h||r&&g)&&a.FileReader){var d=new FileReader;return d.onloadend=function(){var b=h?d.result:d.result.replace(/^data:[^;]*;/,"data:attachment/file;"),c=a.open(b,"_blank");c||(a.location.href=b),b=void 0,p.readyState=p.DONE,s()},d.readAsDataURL(b),void(p.readyState=p.INIT)}if(o||(o=c().createObjectURL(b)),r)a.location.href=o;else{var e=a.open(o,"_blank");e||(a.location.href=o)}p.readyState=p.DONE,s(),l(o)};return p.readyState=p.INIT,e?(o=c().createObjectURL(b),void setTimeout(function(){d.href=o,d.download=i,f(d),s(),l(o),p.readyState=p.DONE})):void t()},p=o.prototype,q=function(a,b,c){return new o(a,b||a.name||"download",c)};return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(a,b,c){return b=b||a.name||"download",c||(a=n(a)),navigator.msSaveOrOpenBlob(a,b)}:(p.abort=function(){},p.readyState=p.INIT=0,p.WRITING=1,p.DONE=2,p.error=p.onwritestart=p.onprogress=p.onwrite=p.onabort=p.onerror=p.onwriteend=null,q)}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);"undefined"!=typeof c&&c.exports?c.exports.saveAs=e:"undefined"!=typeof a&&null!==a&&null!==a.amd&&a("FileSaver.js",function(){return e})},{}],54:[function(b,c,d){!function(b,d,e){function f(a,b,c){return a.addEventListener?void a.addEventListener(b,c,!1):void a.attachEvent("on"+b,c)}function g(a){if("keypress"==a.type){var b=String.fromCharCode(a.which);return a.shiftKey||(b=b.toLowerCase()),b}return t[a.which]?t[a.which]:u[a.which]?u[a.which]:String.fromCharCode(a.which).toLowerCase()}function h(a,b){return a.sort().join(",")===b.sort().join(",")}function i(a){var b=[];return a.shiftKey&&b.push("shift"),a.altKey&&b.push("alt"),a.ctrlKey&&b.push("ctrl"),a.metaKey&&b.push("meta"),b}function j(a){return a.preventDefault?void a.preventDefault():void(a.returnValue=!1)}function k(a){return a.stopPropagation?void a.stopPropagation():void(a.cancelBubble=!0)}function l(a){return"shift"==a||"ctrl"==a||"alt"==a||"meta"==a}function m(){if(!s){s={};for(var a in t)a>95&&112>a||t.hasOwnProperty(a)&&(s[t[a]]=a)}return s}function n(a,b,c){return c||(c=m()[a]?"keydown":"keypress"),"keypress"==c&&b.length&&(c="keydown"),c}function o(a){return"+"===a?["+"]:(a=a.replace(/\+{2}/g,"+plus"),a.split("+"))}function p(a,b){var c,d,e,f=[];for(c=o(a),e=0;e<c.length;++e)d=c[e],w[d]&&(d=w[d]),b&&"keypress"!=b&&v[d]&&(d=v[d],f.push("shift")),l(d)&&f.push(d);return b=n(d,f,b),{key:d,modifiers:f,action:b}}function q(a,b){return null===a||a===d?!1:a===b?!0:q(a.parentNode,b)}function r(a){function b(a){a=a||{};var b,c=!1;for(b in u)a[b]?c=!0:u[b]=0;c||(x=!1)}function c(a,b,c,d,e,f){var g,i,j=[],k=c.type;if(!s._callbacks[a])return[];for("keyup"==k&&l(a)&&(b=[a]),g=0;g<s._callbacks[a].length;++g)if(i=s._callbacks[a][g],(d||!i.seq||u[i.seq]==i.level)&&k==i.action&&("keypress"==k&&!c.metaKey&&!c.ctrlKey||h(b,i.modifiers))){var m=!d&&i.combo==e,n=d&&i.seq==d&&i.level==f;(m||n)&&s._callbacks[a].splice(g,1),j.push(i)}return j}function e(a,b,c,d){s.stopCallback(b,b.target||b.srcElement,c,d)||a(b,c)===!1&&(j(b),k(b))}function m(a){"number"!=typeof a.which&&(a.which=a.keyCode);var b=g(a);if(b)return"keyup"==a.type&&v===b?void(v=!1):void s.handleKey(b,i(a),a)}function n(){clearTimeout(t),t=setTimeout(b,1e3)}function o(a,c,d,f){function h(b){return function(){x=b,++u[a],n()}}function i(c){e(d,c,a),"keyup"!==f&&(v=g(c)),setTimeout(b,10)}u[a]=0;for(var j=0;j<c.length;++j){var k=j+1===c.length,l=k?i:h(f||p(c[j+1]).action);q(c[j],l,f,a,j)}}function q(a,b,d,e,f){s._directMap[a+":"+d]=b,a=a.replace(/\s+/g," ");var g,h=a.split(" ");return h.length>1?void o(a,h,b,d):(g=p(a,d),s._callbacks[g.key]=s._callbacks[g.key]||[],c(g.key,g.modifiers,{type:g.action},e,a,f),void s._callbacks[g.key][e?"unshift":"push"]({callback:b,modifiers:g.modifiers,action:g.action,seq:e,level:f,combo:a}))}var s=this;if(a=a||d,!(s instanceof r))return new r(a);s.target=a,s._callbacks={},s._directMap={};var t,u={},v=!1,w=!1,x=!1;s._handleKey=function(a,d,f){var g,h=c(a,d,f),i={},j=0,k=!1;for(g=0;g<h.length;++g)h[g].seq&&(j=Math.max(j,h[g].level));for(g=0;g<h.length;++g)if(h[g].seq){if(h[g].level!=j)continue;k=!0,i[h[g].seq]=1,e(h[g].callback,f,h[g].combo,h[g].seq)}else k||e(h[g].callback,f,h[g].combo);var m="keypress"==f.type&&w;f.type!=x||l(a)||m||b(i),w=k&&"keydown"==f.type},s._bindMultiple=function(a,b,c){for(var d=0;d<a.length;++d)q(a[d],b,c)},f(a,"keypress",m),f(a,"keydown",m),f(a,"keyup",m)}if(b){for(var s,t={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},u={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},v={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},w={option:"alt",command:"meta","return":"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},x=1;20>x;++x)t[111+x]="f"+x;for(x=0;9>=x;++x)t[x+96]=x;r.prototype.bind=function(a,b,c){var d=this;return a=a instanceof Array?a:[a],d._bindMultiple.call(d,a,b,c),d},r.prototype.unbind=function(a,b){var c=this;return c.bind.call(c,a,function(){},b)},r.prototype.trigger=function(a,b){var c=this;return c._directMap[a+":"+b]&&c._directMap[a+":"+b]({},a),c},r.prototype.reset=function(){var a=this;return a._callbacks={},a._directMap={},a},r.prototype.stopCallback=function(a,b){var c=this;return(" "+b.className+" ").indexOf(" mousetrap ")>-1?!1:q(b,c.target)?!1:"INPUT"==b.tagName||"SELECT"==b.tagName||"TEXTAREA"==b.tagName||b.isContentEditable},r.prototype.handleKey=function(){var a=this;return a._handleKey.apply(a,arguments)},r.addKeycodes=function(a){for(var b in a)a.hasOwnProperty(b)&&(t[b]=a[b]);s=null},r.init=function(){var a=r(d);for(var b in a)"_"!==b.charAt(0)&&(r[b]=function(b){return function(){return a[b].apply(a,arguments)}}(b))},r.init(),b.Mousetrap=r,"undefined"!=typeof c&&c.exports&&(c.exports=r),
"function"==typeof a&&a.amd&&a(function(){return r})}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null)},{}],55:[function(a,b,c){"use strict";function d(){}function e(a){return function(){return a}}function f(a){return a[a.length-1]}function g(a){return[a.slice(0,-1),f(a)]}function h(a){return[a[0],a.slice(1)]}function i(a){return a.reduce(function(a,b){var c,d=b[0],e=b[1];return Ia({},a,(c={},c[d]=e,c))},{})}function j(a,b){return a&&"string"!=typeof a&&a.hasOwnProperty(b)?a[b]:null}function k(a){return"undefined"==typeof a}function l(a){return null!=a&&"object"===("undefined"==typeof a?"undefined":Ha(a))}function m(a){return Array.isArray(a)}function n(a){return"string"==typeof a}function o(a){return"number"==typeof a}function p(a){return"boolean"==typeof a}function q(a){return"function"==typeof a}function r(a){return null!==a}function s(a,b){var c={};for(var d in a)c[d]=b(a[d],d);return c}function t(a,b,c){var d=c;for(var e in a)d=b(d,a[e],e);return d}function u(a){for(var b=Math.max.apply(null,a.filter(function(a){return null!==a}).map(function(a){return a.length})),c=[],d=function(b){c.push(a.map(function(a){return null!==a&&b<a.length?a[b]:null}))},e=0;b>e;e++)d(e);return c}function v(a){for(var b=a.length,c={},d=0;b>d;d++){var e=a[d];if(null!==e)for(var f in e)c[f]=!0}var g={};for(var h in c){g[h]=Array(b);for(var i=0;b>i;i++){var k=a[i];g[h][i]=j(k,h)}}return g}function w(a,b){var c={};for(var d in a){var e=a[d];b(e,d)&&(c[d]=e)}return c}function x(a){for(var b=0,c=a.length;c>b;b++){var d=a[b];if(!p(d))throw new Error("Not a boolean: "+d);if(d)return!0}return!1}function y(a){setTimeout(a,1)}function z(a,b){if(!n(a))throw new Error("First argument must be a string");if(!l(b))throw new Error("Second argument must be an object");return b.type=a,b}function A(a,b){if(null===b)return a===Pa;if("string"!=typeof a)throw new Error("First argument must be a string");if(k(b))throw new Error("Bad second argument");return j(b,"type")===a}function B(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:C;for(var d in b)if(d===Pa&&null===a||d===Ma&&m(a)||l(a)&&A(d,a))return b[d](a);return Na in b&&l(a)?b[Na](a):c(a)}function C(a){throw new Error("Unrecognized type in pattern matching: "+a)}function D(a){var b;return B(a,(b={},b[Ja]=function(){return!0},b[Ka]=function(){return!0},b[La]=function(){return!0},b[Ma]=function(a){return x(a.map(D))},b[Na]=function(a){return x(Object.keys(a).map(function(b){return D(a[b])}))},b))}function E(a,b,c){var d,e=function(c,d){var e=null===d?a:j(a,d);if(null!==a&&null===e)throw new Error("Shape of the bindings object does not match the model.Model: "+b+"  Bindings object: "+a)},f=function(b,d){E(j(a,d),b,j(c,d))};B(b,(d={},d[Ka]=function(d){if(null!==a&&x(Object.keys(a).map(function(a){return!(a in c)})))throw new Error("Shape of the bindings object does not match the model. Model: "+b+" Bindings object: "+a);s(c,e)},d[Ja]=function(d){if(null!==a&&c.length!==a.length)throw new Error("Shape of the bindings object does not match the model. Model: "+b+" Bindings object: "+a);c.map(e)},d[La]=function(a){return e(c,null)},d[Ma]=function(c){if(null!==a&&!m(a))throw new Error("Shape of the bindings object does not match the model. Model: "+b+" Bindings object: "+a);c.map(f)},d[Na]=function(c){if(null!==a&&m(a))throw new Error("Shape of the bindings object does not match the model. Model: "+b+" Bindings object: "+a);s(c,f)},d))}function F(a,b,c){return E(a,b,c),a}function G(a,b,c,e,f,g,h,i){var j=fa(a,b,h.callReducer),k=ga(a,b,h.callSignal),l=ha(a,b,h.callMethod,j,k),m={state:c,methods:l,reducers:j,signals:k,el:g,lastRenderedEl:f};if(null===g&&e!==Sa&&b.render!==d)throw new Error("No binding provided for component "+b.displayName+" at ["+a.join(", ")+"].");if(e===Sa)return b.willUnmount(m),{bindings:null,lastRenderedEl:f};var n=e===Qa||e===Ra||g!==f;e===Qa?b.willMount(m):n&&b.willUpdate(m),i.verbose&&n&&console.log("Rendering "+b.displayName+" at ["+a.join(", ")+"].");var o=n?F(b.render(m),b.model,c):null;if(n&&null===o&&D(b.model))throw new Error("The render function of component "+b.displayName+" did not return new bindings");return e===Qa?y(function(){return b.didMount(m)}):n&&y(function(){return b.didUpdate(m)}),{bindings:o,lastRenderedEl:n?g:f}}function H(a){var b;return B(a,(b={},b[Oa]=function(a){return a.data},b[Na]=function(a){return s(a,H)},b[Ma]=function(a){return a.map(H)},b[Pa]=function(){return null},b))}function I(a,b,c,d,e,f,g,h){var i,k=function(c,d){var i=c[0],k=c[1],l=null!==d?b.component:b,m=null!==d?J(a,d):a,n=null!==d?j(e,d):e,o=null!==d?j(f,d):f,p=G(m,l,k,i.data,j(n,"data"),o,g,h),q=null!==p.bindings?p.bindings:H(n.children),r=p.lastRenderedEl,s=I(m,l.model,k,i.children,j(n,"children"),q,g,h);return z(Oa,{data:r,children:s})},l=function(b,i){return I(J(a,i),b,j(c,i),d[i],j(e,i),j(f,i),g,h)};return B(b,(i={},i[Ka]=function(a){return s(v([d,c]),k)},i[Ja]=function(a){return u([d,c]).map(k)},i[La]=function(a){return k([d,c],null)},i[Ma]=function(a){return a.map(l)},i[Na]=function(a){return s(a,l)},i))}function J(a,b){if(null===b)return a;var c=a.slice(0);return c.push(b),c}function K(a,b){return null===a||null===b||a.length!==b.length?!1:a.reduce(function(a,c,d){return a&&c===b[d]},!0)}function L(a,b){return a.reduce(function(a,b){return A(Oa,a)?a.children[b]:a[b]},b)}function M(a,b,c){if(0===a.length)return c;var d,e=h(a),f=e[0],g=e[1];return"string"==typeof f?Ia({},b,(d={},d[f]=M(g,L([f],b),c),d)):[].concat(b.slice(0,f),[M(g,L([f],b),c)],b.slice(f+1))}function N(a,b,c){if(0===a.length)return c;var d=g(a),e=d[0],f=d[1],h=L(e,b);return A(Oa,h)?h.children[f]=c:h[f]=c,b}function O(a,b){var c=a;return{get:function(a){return L(a,c)},set:function(a,d){c=b?N(a,c,d):M(a,c,d)}}}function P(a,b){var c;null!==b&&B(a,(c={},c[Ka]=function(c){if(!l(b)||m(b))throw new Error("Shape of the new state does not match the model. Model: "+c+"  State: "+b);s(b,function(b){return P(a.component.model,b)})},c[Ja]=function(c){if(!m(b))throw new Error("Shape of the new state does not match the model.Model: "+c+"  State: "+b);b.map(function(b){return P(a.component.model,b)})},c[La]=function(c){P(a.model,b)},c[Ma]=function(a){if(!m(b))throw new Error("Shape of the new state does not match the model.Model: "+a+"  State: "+b);a.map(function(a,c){return P(a,j(b,c))})},c[Na]=function(a){if(!l(b)||m(b))throw new Error("Shape of the new state does not match the model. Model: "+a+"  State: "+b);s(a,function(a,c){return P(a,j(b,c))})},c))}function Q(a,b,c,d,e,f,g){var h=d(a,c),i=d(b,c);if(h&&!i)return Qa;if(h&&i){var j=null===c?a!==b:a[c]!==b[c],k=K(f,g);return j&&e({state:a,lastState:b,componentTriggeredUpdate:k})?Ra:null}return!h&&i?Sa:null}function R(a,b,c,d,e){var f;return B(a,(f={},f[Ka]=function(a){var f=function(a,b){return l(a)&&b in a&&null!==a[b]},g=Object.assign({},b||{},c||{});return s(g,function(g,h){var i=Q(b,c,h,f,a.component.shouldUpdate,J(d,h),e),k=R(a.component.model,j(b,h),j(c,h),J(d,h),e);return z(Oa,{data:i,children:k})})},f[Ja]=function(a){var f=function(a,b){return m(a)&&b<a.length&&null!==a[b]},g=Math.max(m(b)?b.length:0,m(c)?c.length:0),h=Array.apply(null,{length:g});return h.map(function(g,h){var i=Q(b,c,h,f,a.component.shouldUpdate,J(d,h),e),k=R(a.component.model,j(b,h),j(c,h),J(d,h),e);return z(Oa,{data:i,children:k})})},f[La]=function(a){var f=function(a,b){return null!==a},g=Q(b,c,null,f,a.shouldUpdate,d,e),h=R(a.model,b||null,c||null,d,e);return z(Oa,{data:g,children:h})},f[Ma]=function(a){return a.map(function(a,f){return R(a,j(b,f),j(c,f),J(d,f),e)})},f[Na]=function(a){return s(a,function(a,f){return R(a,j(b,f),j(c,f),J(d,f),e)})},f))}function S(a,b,c,d,e){var f=R(a,b,c,d,e);return{minSignals:{diff:f,address:d,modelNode:a},minUpdate:{diff:f,address:d,modelNode:a}}}function T(){var a={_onFns:[]};return a.on=function(b){if(!q(b))throw new Error('First argument to "on" must be a function');a._onFns=[].concat(a._onFns,[b])},a.call=function(){for(var b=arguments.length,c=Array(b),d=0;b>d;d++)c[d]=arguments[d];return a._onFns.map(function(a){return a.apply(void 0,c)})},a}function U(a){var b={_callFns:[]};b.call=function(){for(var a=arguments.length,c=Array(a),d=0;a>d;d++)c[d]=arguments[d];if(c.length>1||!l(c[0]))throw new Error("Call only accepts a single object as argument.");b._callFns.map(function(a){var b=a.fn;return b(c[0])})},b._onFns=[];var c=a?"onEach":"on";return b[c]=function(a){if(!q(a))throw new Error('Argument to "'+c+'" must be a function');b._onFns.push(function(b){return function(){if(arguments.length>1||!l(arguments.length<=0?void 0:arguments[0]))throw new Error("On function only accepts a single object as argument.");var c="string"==typeof b?Ia({k:b},arguments.length<=0?void 0:arguments[0]):"number"==typeof b?Ia({i:b},arguments.length<=0?void 0:arguments[0]):arguments.length<=0?void 0:arguments[0];a(c)}})},b}function V(a,b){return i(a.map(function(a){return[a,U(b)]}))}function W(a){var b;return B(a,(b={},b[Ka]=function(a){return V(a.component.signalNames,!0)},b[Ja]=function(a){return V(a.component.signalNames,!0)},b[La]=function(a){return V(a.signalNames,!1)},b[Ma]=function(a){return a.map(W).filter(r)},b[Na]=function(a){return w(s(a,W),r)},b),e(null))}function X(a,b,c){var d,f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return B(a,(d={},d[Oa]=function(a){return b(c,a.data,f)},d[Ma]=function(a){return a.reduce(function(a,c,d){return X(c,b,a,J(f,d))},c)},d[Na]=function(a){return t(a,function(a,c,d){return X(c,b,a,J(f,d))},c)},d),e(c))}function Y(a,b,c){var d=V(a.signalNames,!1),e=W(a.model),f=fa(b,a,c.callReducer),g=ga(b,a,c.callSignal),h=ha(b,a,c.callMethod,f,g);return a.signalSetup({methods:h,reducers:f,signals:d,childSignals:e}),{signalsAPI:d,childSignalsAPI:e}}function Z(a,b,c,d,f){var g,h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,k=function(c,d){var e=c[0],g=c[1],k=null!==d?a.component:a,l=null!==d?J(b,d):b,m=e.data;if(m!==Qa){if(m===Sa)return null;var n=X(e.children,function(a,b,c){var d=a.hasCreated||b===Qa,e=b===Sa?[].concat(a.destroyed,[c]):a.destroyed;return{hasCreated:d,destroyed:e}},{hasCreated:!1,destroyed:[]}),o=n.hasCreated,p=n.destroyed;p.map(function(a){var b=a.reduce(function(b,c,d){if(c in b)return b[c];if(d===a.length-1)return b;throw new Error("Bad address "+a+" for object "+g.data.childSignalsAPI)},g.data.childSignalsAPI);s(b,function(b){b._callFns=b._callFns.filter(function(b){var c=b.address;return!K(c,a)})})});var q=o?g.data.childSignalsAPI:null,r=o?[]:null,t=Z(k.model,l,e.children,j(g,"children"),f,q,r);return z(Oa,{data:j(g,"data"),children:t})}var u=function(){var a=Y(k,l,f),b=a.signalsAPI,c=a.childSignalsAPI,m=null===i?null:J(i,d),n=s(v([b,h]),function(a,b){var c=a[0],e=a[1],f=T();return c._onFns.map(function(a){return f.on(a())}),c._callFns=[{fn:f.call,address:null}],null!==e&&(e._onFns.map(function(a){return f.on(a(d))}),e._callFns=[].concat(e._callFns,[{fn:f.call,address:m}])),f}),o={signals:n,signalsAPI:b,childSignalsAPI:c},p=Z(k.model,l,e.children,j(g,"children"),f,c,[]);return{v:z(Oa,{data:o,children:p})}}();return"object"===("undefined"==typeof u?"undefined":Ha(u))?u.v:void 0},l=function(a,c){var d=a[0],e=a[1],g=a[2],h=a[3],j=J(b,c),k=null===i?null:J(i,c);return Z(d,j,e,g,f,h,k)};return B(a,(g={},g[Ka]=function(a){return w(s(v([c,d]),k),r)},g[Ja]=function(a){return u([c,d]).map(k).filter(r)},g[La]=function(a){return k([c,d],null)},g[Ma]=function(a){return u([a,c,d,h]).map(l)},g[Na]=function(a){return s(v([a,c,d,h]),l)},g),e(null))}function $(a){return z(Ka,{component:a})}function _(a){return z(Ja,{component:a})}function aa(a){var b=a.state,c=a.lastState;return b!==c}function ba(a,b){s(a,function(a,c){c in b||console.error("Unexpected argument "+c)})}function ca(a){return function(){if(0===arguments.length)return a({});if(arguments.length>1||!l(arguments.length<=0?void 0:arguments[0]))throw new Error("Reducers can only take 1 or 0 arguments, and the argument should be an object.");return a(arguments.length<=0?void 0:arguments[0])}}function da(a){return s(a,function(a,b){return function(){if(1===arguments.length&&l(arguments.length<=0?void 0:arguments[0])){if("state"in(arguments.length<=0?void 0:arguments[0]))return a(arguments.length<=0?void 0:arguments[0]);throw new Error('The argument to the reducer must have a "state" attribute.')}throw new Error("Reducers can only take 1 arguments, and the argument should be an object.")}})}function ea(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},b={displayName:"",signalNames:[],signalSetup:d,model:{},init:e({}),reducers:{},methods:{},willMount:d,didMount:d,shouldUpdate:aa,willUpdate:d,didUpdate:d,willUnmount:d,render:d};if(ba(a,b),"init"in a&&(a.init=ca(a.init)),"reducers"in a&&(a.reducersRaw=a.reducers,a.reducers=da(a.reducers)),a.model&&A(La,a.model))throw new Error("The model cannot be another Component. The top level of the model should be an array or an object literal");return z(La,Ia({},b,a))}function fa(a,b,c){return s(b.reducersRaw,function(d,e){return function(){if(0===arguments.length)c(a,b,d,{},e);else{if(arguments.length>1||!l(arguments.length<=0?void 0:arguments[0]))throw new Error("Reducers can only take 1 or 0 arguments, and the argument should be an object.");c(a,b,d,arguments.length<=0?void 0:arguments[0],e)}}})}function ga(a,b,c){return i(b.signalNames.map(function(b){return[b,{call:function(d){return c(a,b,d)}}]}))}function ha(a,b,c,d,e){var f=s(b.methods,function(b){return function(g){"undefined"!=typeof Event&&g instanceof Event?c(a,b,e,f,d,this,g,{}):c(a,b,e,f,d,null,null,g)}});return f}function ia(a,b){return function(b,c,d,e,f,g,h,i){if(null===a.get([]))throw new Error("Cannot call method before the app is initialized (e.g. in signalSetup).");var j=a.get(b);c(Ia({state:j,signals:d,methods:e,reducers:f,target:g,event:h},i))}}function ja(a,b){return function(c,d,e){b.verbose&&console.log("Called signal "+d+" at ["+c.join(", ")+"]."),a.get(c).data.signals[d].call(e)}}function ka(a,b,c,d,e,f){return function(g,h,i,j,k){if(!q(i))throw new Error("Reducer "+k+" is not a function");var l=b.get(g),m=i(Ia({},j,{state:l}));f.verbose&&(console.log("Called reducer "+k+" for "+h.displayName+" at ["+g.join(", ")+"]."),console.log(l),console.log(m)),P(h.model,m);var n=b.get([]);b.set(g,m);var o=S(a,b.get([]),n,[],g),p=o.minSignals,r=o.minUpdate,s=d.get(p.address),t=Z(p.modelNode,p.address,p.diff,s,e);d.set(p.address,t);var u=c.get(r.address),v=u.data,w=b.get(r.address),x=I(r.address,r.modelNode,w,r.diff,u,v,e,f);c.set(r.address,x)}}function la(a,b,c,d,e){var f={};return f.callMethod=ia(b,e),f.callSignal=ja(d,e),f.callReducer=ka(a,b,c,d,f,e),f}function ma(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},d=O(null,!1),e=z(Oa,{data:b,children:null}),f=O(e,!0),g=O(null,!0),h=la(a,d,f,g,c),i="initialState"in c?c.initialState:a.init(),k=function(a){var b=a.newState;return b},l=function(b){return h.callReducer([],a,k,{newState:b},"setState")};l(i);var m=function(){return d.get([])},n=function(a){return d.set([],a)},o=fa([],a,h.callReducer),p=ga([],a,h.callSignal),q=ha([],a,h.callMethod,o,p),r=j(g.get([]).data,"signals");return{setState:l,setStateNoRender:n,getState:m,reducers:o,methods:q,signals:r}}function na(a){var b={};for(var c in a)b[a[c]]=c;return b}function oa(a,b){var c={};return a.map(function(a){return c[a[b]]=a}),c}function pa(a,b){if(k(a[0]))return b;var c=a[0];if(n(c)){var d;return d={},d[c]=pa(a.slice(1),b),d}var e=Array(c+1);return e[c]=pa(a.slice(1),b),e}function qa(a){for(var b=0,c=0,d=a.length;d>c;c++){var e=a[c];if(!m(e))throw Error("Incompatible bindings: mix of types");var f=e.length;f>b&&(b=f)}for(var g=[],h=0;b>h;h++)for(var i=0,j=a.length;j>i;i++){var k=a[i];null!=k[h]&&(null!=g[h]?g[h]=sa([k[h],g[h]]):g[h]=k[h])}return g}function ra(a){return a.reduce(function(a,b){if(m(b))throw Error("Incompatible bindings: mix of types");for(var c in b)b[c]&&(a[c]?a[c]=sa([b[c],a[c]]):a[c]=b[c]);return a},{})}function sa(a){return m(a[0])?qa(a):ra(a)}function ta(a){return a&&"object"===("undefined"==typeof a?"undefined":Ha(a))&&null!==a&&1===a.nodeType&&"string"==typeof a.nodeName}function ua(a){return a&&"object"===("undefined"==typeof a?"undefined":Ha(a))&&null!==a&&3===a.nodeType&&"string"==typeof a.nodeName}function va(a,b){for(var c=arguments.length,d=Array(c>2?c-2:0),e=2;c>e;e++)d[e-2]=arguments[e];var f=null==b?{}:b;return z(Ua,{tagName:a,attributes:f,children:d})}function wa(a){var b=m(a)?a:[a];return z(Ta,{address:b})}function xa(a){var b=a.indexOf(":");if(-1!==b){var c=a.slice(0,b);if(c in Za){var d="xmlns"===c?a:a.slice(b+1);return{name:d,explicit:Za[c]}}return{name:a,explicit:null}}return{name:a,explicit:null}}function ya(a,b){var c=a.tagName,d=xa(c),e=d.name,f=d.explicit,g=null!==f?f:c in Za?Za[c]:b.namespaceURI,h=g===Za.xhtml?document.createElement(e):document.createElementNS(g,e);return Da(h,a)}function za(a){for(var b=/([^:; ]+):/g,c=[],d=void 0;null!==(d=b.exec(a));)c.push(d[1]);return c}function Aa(a){return a.replace(/-(.)/g,function(a){return a.toUpperCase()}).replace(/-/g,"")}function Ba(a){return a.slice(2).toLowerCase()}function Ca(a,b,c,d){var e=d===!0?c:d;a===Za.xhtml?b.setAttribute(c,e):b.setAttributeNS(a,c,e)}function Da(a,b){var c=null,d=a.namespaceURI;a.hasOwnProperty(Va)&&(s(a[Va],function(b,c){a.removeEventListener(c,b)}),delete a[Va]),s(b.attributes,function(e,f){if("id"===f)a.id=e;else if("style"!==f||n(e))if(0===f.indexOf("on")){if(a.hasOwnProperty(Va)||(a[Va]={}),null!==e){var g=Ba(f);if(!q(e)&&null!==e)throw new Error(e+" is not a function.");a[Va][g]=e,a.addEventListener(g,e)}}else if(f in Wa){var h=xa(f),i=(h.name,h.explicit);Ca(null!==i?i:d,a,Wa[i],e)}else if(f in Ya)Ya[f](a,b.tagName,e);else if("then"===f){if(null!==e){if(!q(e))throw new Error(e+" is not a function or null.");c=e}}else{var j=xa(f),k=j.name,l=j.explicit;Ca(null!==l?l:d,a,k,e)}else s(e,function(b,c){a.style.setProperty(c,b)})});for(var e=[],f=0,g=a.attributes.length;g>f;f++)e.push(a.attributes[f].name);e.filter(function(a){return!(a in b.attributes)||b.attributes[a]===!1}).map(function(c){c in Xa?a.removeAttribute(Xa[c]):c in Ya?Ya[c](a,b.tagName):a.removeAttribute(c)});var h=b.attributes.style;return h&&!n(h)&&za(a.style.cssText).filter(function(a){return!(a in h||Aa(a)in h)}).map(function(b){return a.style.removeProperty(b)}),c&&y(function(){return c(a)}),a}function Ea(a){return a.reduce(function(a,b){return m(b)?[].concat(a,b):[].concat(a,[b])},[]).filter(r)}function Fa(a,b){for(var c=a.childNodes.length-1;c>=b;c--)a.removeChild(a.childNodes[c])}function Ga(a){if(!ta(a))throw new Error("First argument must be a DOM Element.");for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;b>d;d++)c[d-1]=arguments[d];var e=Ea(c),f=j(e,0);if($a(f)){if(1!==e.length)throw new Error("A binding cannot have siblings in TinierDOM. At binding: [ "+f.address.join(", ")+" ].");return sa([pa(f.address,a)])}var g=Array.from(a.children).filter(function(a){return a.id}),h=oa(g,"id"),i=e.map(function(b,c){if(k(b))throw new Error("Children in Tinier Elements cannot be undefined.");if(_a(b)){var d=a.childNodes[c];if(b.attributes.id in h){var e=h[b.attributes.id];return d?a.replaceChild(e,d):a.appendChild(e),Ga.apply(void 0,[e].concat(b.children))}if(d){if(d.tagName&&d.tagName.toLowerCase()===b.tagName.toLowerCase()){var f=d.id?d.cloneNode(!0):d;return Da(f,b),d.id&&a.replaceChild(f,d),Ga.apply(void 0,[f].concat(b.children))}var g=ya(b,a);return a.replaceChild(g,d),Ga.apply(void 0,[g].concat(b.children))}var i=ya(b,a);return a.appendChild(i),Ga.apply(void 0,[i].concat(b.children))}if($a(b))throw new Error("A binding cannot have siblings in TinierDOM. At binding: [ "+b.address.join(", ")+" ].");var j=a.childNodes[c],l=String(b);return ua(j)?j.textContent=l:j?a.replaceChild(document.createTextNode(l),j):a.appendChild(document.createTextNode(l)),null});return Fa(a,e.length),sa(i.filter(function(a){return null!==a}))}c.__esModule=!0;var Ha="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},Ia=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a};c.tail=g,c.head=h,c.fromPairs=i,c.get=j,c.isUndefined=k,c.isObject=l,c.isArray=m,c.isString=n,c.isNumber=o,c.isBoolean=p,c.isFunction=q,c.notNull=r,c.mapValues=s,c.reduceValues=t,c.zipArrays=u,c.zipObjects=v,c.filterValues=w,c.any=x,c.tagType=z,c.checkType=A,c.match=B,c.hasChildren=D,c.checkRenderResult=F,c.updateEl=G,c.addressWith=J,c.addressEqual=K,c.makeTree=O,c.checkState=P,c.diffWithModelMin=S,c.makeSignal=T,c.makeOneSignalAPI=U,c.makeChildSignalsAPI=W,c.reduceChildren=X,c.mergeSignals=Z,c.objectOf=$,c.arrayOf=_,c.createComponent=ea,c.patchMethods=ha,c.makeCallMethod=ia,c.makeCallReducer=ka,c.makeStateCallers=la,c.run=ma,c.addressToObj=pa,c.objectForBindings=sa,c.createElement=va,c.bind=wa,c.createDOMElement=ya,c.getStyles=za,c.updateDOMElement=Da,c.render=Ga;var Ja=c.ARRAY_OF="@TINIER_ARRAY_OF",Ka=c.OBJECT_OF="@TINIER_OBJECT_OF",La=c.COMPONENT="@TINIER_COMPONENT",Ma=c.ARRAY="@TINIER_ARRAY",Na=c.OBJECT="@TINIER_OBJECT",Oa=c.NODE="@TINIER_NODE",Pa=c.NULL="@TINIER_NULL",Qa=(c.STRING="@TINIER_STRING",c.NUMBER="@TINIER_NUMBER",c.BOOLEAN="@TINIER_BOOLEAN",c.ANY="@TINIER_ANY",c.NO_ARGUMENT="@TINIER_NO_ARGUMENT",c.TOP="@TINIER_TOP",c.CREATE="@TINIER_CREATE"),Ra=c.UPDATE="@TINIER_UPDATE",Sa=c.DESTROY="@TINIER_DESTROY",Ta=c.BINDING="@TINIER_BINDING",Ua=c.ELEMENT="@TINIER_ELEMENT",Va="@TINIER_LISTENERS",Wa={},Xa=na(Wa),Ya={checked:function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!1;if("input"!==b)throw new Error('"checked" attribute is only supported on input elements.');a.checked=c},value:function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!1;if(-1===["input","textarea"].indexOf(b))throw new Error('"value" attribute is only supported on input and textarea elements.');a.value=c}},Za={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},$a=function(a){return A(Ta,a)},_a=function(a){return A(Ua,a)};c["default"]={arrayOf:_,objectOf:$,createComponent:ea,run:ma,bind:wa,createElement:va,render:Ga}},{}],56:[function(b,c,d){(function(){function b(a){function b(b,c,d,e,f,g){for(;f>=0&&g>f;f+=a){var h=e?e[f]:f;d=c(d,b[h],h,b)}return d}return function(c,d,e,f){d=w(d,f,4);var g=!D(c)&&v.keys(c),h=(g||c).length,i=a>0?0:h-1;return arguments.length<3&&(e=c[g?g[i]:i],i+=a),b(c,d,e,g,i,h)}}function e(a){return function(b,c,d){c=x(c,d);for(var e=C(b),f=a>0?0:e-1;f>=0&&e>f;f+=a)if(c(b[f],f,b))return f;return-1}}function f(a,b,c){return function(d,e,f){var g=0,h=C(d);if("number"==typeof f)a>0?g=f>=0?f:Math.max(f+h,g):h=f>=0?Math.min(f+1,h):f+h+1;else if(c&&f&&h)return f=c(d,e),d[f]===e?f:-1;if(e!==e)return f=b(n.call(d,g,h),v.isNaN),f>=0?f+g:-1;for(f=a>0?g:h-1;f>=0&&h>f;f+=a)if(d[f]===e)return f;return-1}}function g(a,b){var c=I.length,d=a.constructor,e=v.isFunction(d)&&d.prototype||k,f="constructor";for(v.has(a,f)&&!v.contains(b,f)&&b.push(f);c--;)f=I[c],f in a&&a[f]!==e[f]&&!v.contains(b,f)&&b.push(f)}var h=this,i=h._,j=Array.prototype,k=Object.prototype,l=Function.prototype,m=j.push,n=j.slice,o=k.toString,p=k.hasOwnProperty,q=Array.isArray,r=Object.keys,s=l.bind,t=Object.create,u=function(){},v=function(a){return a instanceof v?a:this instanceof v?void(this._wrapped=a):new v(a)};"undefined"!=typeof d?("undefined"!=typeof c&&c.exports&&(d=c.exports=v),d._=v):h._=v,v.VERSION="1.8.3";var w=function(a,b,c){if(void 0===b)return a;switch(null==c?3:c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)};case 4:return function(c,d,e,f){return a.call(b,c,d,e,f)}}return function(){return a.apply(b,arguments)}},x=function(a,b,c){return null==a?v.identity:v.isFunction(a)?w(a,b,c):v.isObject(a)?v.matcher(a):v.property(a)};v.iteratee=function(a,b){return x(a,b,1/0)};var y=function(a,b){return function(c){var d=arguments.length;if(2>d||null==c)return c;for(var e=1;d>e;e++)for(var f=arguments[e],g=a(f),h=g.length,i=0;h>i;i++){var j=g[i];b&&void 0!==c[j]||(c[j]=f[j])}return c}},z=function(a){if(!v.isObject(a))return{};if(t)return t(a);u.prototype=a;var b=new u;return u.prototype=null,b},A=function(a){return function(b){return null==b?void 0:b[a]}},B=Math.pow(2,53)-1,C=A("length"),D=function(a){var b=C(a);return"number"==typeof b&&b>=0&&B>=b};v.each=v.forEach=function(a,b,c){b=w(b,c);var d,e;if(D(a))for(d=0,e=a.length;e>d;d++)b(a[d],d,a);else{var f=v.keys(a);for(d=0,e=f.length;e>d;d++)b(a[f[d]],f[d],a)}return a},v.map=v.collect=function(a,b,c){b=x(b,c);for(var d=!D(a)&&v.keys(a),e=(d||a).length,f=Array(e),g=0;e>g;g++){var h=d?d[g]:g;f[g]=b(a[h],h,a)}return f},v.reduce=v.foldl=v.inject=b(1),v.reduceRight=v.foldr=b(-1),v.find=v.detect=function(a,b,c){var d;return d=D(a)?v.findIndex(a,b,c):v.findKey(a,b,c),void 0!==d&&-1!==d?a[d]:void 0},v.filter=v.select=function(a,b,c){var d=[];return b=x(b,c),v.each(a,function(a,c,e){b(a,c,e)&&d.push(a)}),d},v.reject=function(a,b,c){return v.filter(a,v.negate(x(b)),c)},v.every=v.all=function(a,b,c){b=x(b,c);for(var d=!D(a)&&v.keys(a),e=(d||a).length,f=0;e>f;f++){var g=d?d[f]:f;if(!b(a[g],g,a))return!1}return!0},v.some=v.any=function(a,b,c){b=x(b,c);for(var d=!D(a)&&v.keys(a),e=(d||a).length,f=0;e>f;f++){var g=d?d[f]:f;if(b(a[g],g,a))return!0}return!1},v.contains=v.includes=v.include=function(a,b,c,d){return D(a)||(a=v.values(a)),("number"!=typeof c||d)&&(c=0),v.indexOf(a,b,c)>=0},v.invoke=function(a,b){var c=n.call(arguments,2),d=v.isFunction(b);return v.map(a,function(a){var e=d?b:a[b];return null==e?e:e.apply(a,c)})},v.pluck=function(a,b){return v.map(a,v.property(b))},v.where=function(a,b){return v.filter(a,v.matcher(b))},v.findWhere=function(a,b){return v.find(a,v.matcher(b))},v.max=function(a,b,c){var d,e,f=-(1/0),g=-(1/0);if(null==b&&null!=a){a=D(a)?a:v.values(a);for(var h=0,i=a.length;i>h;h++)d=a[h],d>f&&(f=d)}else b=x(b,c),v.each(a,function(a,c,d){e=b(a,c,d),(e>g||e===-(1/0)&&f===-(1/0))&&(f=a,g=e)});return f},v.min=function(a,b,c){var d,e,f=1/0,g=1/0;if(null==b&&null!=a){a=D(a)?a:v.values(a);for(var h=0,i=a.length;i>h;h++)d=a[h],f>d&&(f=d)}else b=x(b,c),v.each(a,function(a,c,d){e=b(a,c,d),(g>e||e===1/0&&f===1/0)&&(f=a,g=e)});return f},v.shuffle=function(a){for(var b,c=D(a)?a:v.values(a),d=c.length,e=Array(d),f=0;d>f;f++)b=v.random(0,f),b!==f&&(e[f]=e[b]),e[b]=c[f];return e},v.sample=function(a,b,c){return null==b||c?(D(a)||(a=v.values(a)),a[v.random(a.length-1)]):v.shuffle(a).slice(0,Math.max(0,b))},v.sortBy=function(a,b,c){return b=x(b,c),v.pluck(v.map(a,function(a,c,d){return{value:a,index:c,criteria:b(a,c,d)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index-b.index}),"value")};var E=function(a){return function(b,c,d){var e={};return c=x(c,d),v.each(b,function(d,f){var g=c(d,f,b);a(e,d,g)}),e}};v.groupBy=E(function(a,b,c){v.has(a,c)?a[c].push(b):a[c]=[b]}),v.indexBy=E(function(a,b,c){a[c]=b}),v.countBy=E(function(a,b,c){v.has(a,c)?a[c]++:a[c]=1}),v.toArray=function(a){return a?v.isArray(a)?n.call(a):D(a)?v.map(a,v.identity):v.values(a):[]},v.size=function(a){return null==a?0:D(a)?a.length:v.keys(a).length},v.partition=function(a,b,c){b=x(b,c);var d=[],e=[];return v.each(a,function(a,c,f){(b(a,c,f)?d:e).push(a)}),[d,e]},v.first=v.head=v.take=function(a,b,c){return null==a?void 0:null==b||c?a[0]:v.initial(a,a.length-b)},v.initial=function(a,b,c){return n.call(a,0,Math.max(0,a.length-(null==b||c?1:b)))},v.last=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-1]:v.rest(a,Math.max(0,a.length-b))},v.rest=v.tail=v.drop=function(a,b,c){return n.call(a,null==b||c?1:b)},v.compact=function(a){return v.filter(a,v.identity)};var F=function(a,b,c,d){for(var e=[],f=0,g=d||0,h=C(a);h>g;g++){var i=a[g];if(D(i)&&(v.isArray(i)||v.isArguments(i))){b||(i=F(i,b,c));var j=0,k=i.length;for(e.length+=k;k>j;)e[f++]=i[j++]}else c||(e[f++]=i)}return e};v.flatten=function(a,b){return F(a,b,!1)},v.without=function(a){return v.difference(a,n.call(arguments,1))},v.uniq=v.unique=function(a,b,c,d){v.isBoolean(b)||(d=c,c=b,b=!1),null!=c&&(c=x(c,d));for(var e=[],f=[],g=0,h=C(a);h>g;g++){var i=a[g],j=c?c(i,g,a):i;b?(g&&f===j||e.push(i),f=j):c?v.contains(f,j)||(f.push(j),e.push(i)):v.contains(e,i)||e.push(i)}return e},v.union=function(){return v.uniq(F(arguments,!0,!0))},v.intersection=function(a){for(var b=[],c=arguments.length,d=0,e=C(a);e>d;d++){var f=a[d];if(!v.contains(b,f)){for(var g=1;c>g&&v.contains(arguments[g],f);g++);g===c&&b.push(f)}}return b},v.difference=function(a){var b=F(arguments,!0,!0,1);return v.filter(a,function(a){return!v.contains(b,a)})},v.zip=function(){return v.unzip(arguments)},v.unzip=function(a){for(var b=a&&v.max(a,C).length||0,c=Array(b),d=0;b>d;d++)c[d]=v.pluck(a,d);return c},v.object=function(a,b){for(var c={},d=0,e=C(a);e>d;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},v.findIndex=e(1),v.findLastIndex=e(-1),v.sortedIndex=function(a,b,c,d){c=x(c,d,1);for(var e=c(b),f=0,g=C(a);g>f;){var h=Math.floor((f+g)/2);c(a[h])<e?f=h+1:g=h}return f},v.indexOf=f(1,v.findIndex,v.sortedIndex),v.lastIndexOf=f(-1,v.findLastIndex),v.range=function(a,b,c){null==b&&(b=a||0,a=0),c=c||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=Array(d),f=0;d>f;f++,a+=c)e[f]=a;return e};var G=function(a,b,c,d,e){if(!(d instanceof b))return a.apply(c,e);var f=z(a.prototype),g=a.apply(f,e);return v.isObject(g)?g:f};v.bind=function(a,b){if(s&&a.bind===s)return s.apply(a,n.call(arguments,1));if(!v.isFunction(a))throw new TypeError("Bind must be called on a function");var c=n.call(arguments,2),d=function(){return G(a,d,b,this,c.concat(n.call(arguments)))};return d},v.partial=function(a){var b=n.call(arguments,1),c=function(){for(var d=0,e=b.length,f=Array(e),g=0;e>g;g++)f[g]=b[g]===v?arguments[d++]:b[g];for(;d<arguments.length;)f.push(arguments[d++]);return G(a,c,this,this,f)};return c},v.bindAll=function(a){var b,c,d=arguments.length;if(1>=d)throw new Error("bindAll must be passed function names");for(b=1;d>b;b++)c=arguments[b],a[c]=v.bind(a[c],a);return a},v.memoize=function(a,b){var c=function(d){var e=c.cache,f=""+(b?b.apply(this,arguments):d);return v.has(e,f)||(e[f]=a.apply(this,arguments)),e[f]};return c.cache={},c},v.delay=function(a,b){var c=n.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},v.defer=v.partial(v.delay,v,1),v.throttle=function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var i=function(){h=c.leading===!1?0:v.now(),g=null,f=a.apply(d,e),g||(d=e=null)};return function(){var j=v.now();h||c.leading!==!1||(h=j);var k=b-(j-h);return d=this,e=arguments,0>=k||k>b?(g&&(clearTimeout(g),g=null),h=j,f=a.apply(d,e),g||(d=e=null)):g||c.trailing===!1||(g=setTimeout(i,k)),f}},v.debounce=function(a,b,c){var d,e,f,g,h,i=function(){var j=v.now()-g;b>j&&j>=0?d=setTimeout(i,b-j):(d=null,c||(h=a.apply(f,e),d||(f=e=null)))};return function(){f=this,e=arguments,g=v.now();var j=c&&!d;return d||(d=setTimeout(i,b)),j&&(h=a.apply(f,e),f=e=null),h}},v.wrap=function(a,b){return v.partial(b,a)},v.negate=function(a){return function(){return!a.apply(this,arguments)}},v.compose=function(){var a=arguments,b=a.length-1;return function(){for(var c=b,d=a[b].apply(this,arguments);c--;)d=a[c].call(this,d);return d}},v.after=function(a,b){return function(){return--a<1?b.apply(this,arguments):void 0}},v.before=function(a,b){var c;return function(){return--a>0&&(c=b.apply(this,arguments)),1>=a&&(b=null),c}},v.once=v.partial(v.before,2);var H=!{toString:null}.propertyIsEnumerable("toString"),I=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];
v.keys=function(a){if(!v.isObject(a))return[];if(r)return r(a);var b=[];for(var c in a)v.has(a,c)&&b.push(c);return H&&g(a,b),b},v.allKeys=function(a){if(!v.isObject(a))return[];var b=[];for(var c in a)b.push(c);return H&&g(a,b),b},v.values=function(a){for(var b=v.keys(a),c=b.length,d=Array(c),e=0;c>e;e++)d[e]=a[b[e]];return d},v.mapObject=function(a,b,c){b=x(b,c);for(var d,e=v.keys(a),f=e.length,g={},h=0;f>h;h++)d=e[h],g[d]=b(a[d],d,a);return g},v.pairs=function(a){for(var b=v.keys(a),c=b.length,d=Array(c),e=0;c>e;e++)d[e]=[b[e],a[b[e]]];return d},v.invert=function(a){for(var b={},c=v.keys(a),d=0,e=c.length;e>d;d++)b[a[c[d]]]=c[d];return b},v.functions=v.methods=function(a){var b=[];for(var c in a)v.isFunction(a[c])&&b.push(c);return b.sort()},v.extend=y(v.allKeys),v.extendOwn=v.assign=y(v.keys),v.findKey=function(a,b,c){b=x(b,c);for(var d,e=v.keys(a),f=0,g=e.length;g>f;f++)if(d=e[f],b(a[d],d,a))return d},v.pick=function(a,b,c){var d,e,f={},g=a;if(null==g)return f;v.isFunction(b)?(e=v.allKeys(g),d=w(b,c)):(e=F(arguments,!1,!1,1),d=function(a,b,c){return b in c},g=Object(g));for(var h=0,i=e.length;i>h;h++){var j=e[h],k=g[j];d(k,j,g)&&(f[j]=k)}return f},v.omit=function(a,b,c){if(v.isFunction(b))b=v.negate(b);else{var d=v.map(F(arguments,!1,!1,1),String);b=function(a,b){return!v.contains(d,b)}}return v.pick(a,b,c)},v.defaults=y(v.allKeys,!0),v.create=function(a,b){var c=z(a);return b&&v.extendOwn(c,b),c},v.clone=function(a){return v.isObject(a)?v.isArray(a)?a.slice():v.extend({},a):a},v.tap=function(a,b){return b(a),a},v.isMatch=function(a,b){var c=v.keys(b),d=c.length;if(null==a)return!d;for(var e=Object(a),f=0;d>f;f++){var g=c[f];if(b[g]!==e[g]||!(g in e))return!1}return!0};var J=function(a,b,c,d){if(a===b)return 0!==a||1/a===1/b;if(null==a||null==b)return a===b;a instanceof v&&(a=a._wrapped),b instanceof v&&(b=b._wrapped);var e=o.call(a);if(e!==o.call(b))return!1;switch(e){case"[object RegExp]":case"[object String]":return""+a==""+b;case"[object Number]":return+a!==+a?+b!==+b:0===+a?1/+a===1/b:+a===+b;case"[object Date]":case"[object Boolean]":return+a===+b}var f="[object Array]"===e;if(!f){if("object"!=typeof a||"object"!=typeof b)return!1;var g=a.constructor,h=b.constructor;if(g!==h&&!(v.isFunction(g)&&g instanceof g&&v.isFunction(h)&&h instanceof h)&&"constructor"in a&&"constructor"in b)return!1}c=c||[],d=d||[];for(var i=c.length;i--;)if(c[i]===a)return d[i]===b;if(c.push(a),d.push(b),f){if(i=a.length,i!==b.length)return!1;for(;i--;)if(!J(a[i],b[i],c,d))return!1}else{var j,k=v.keys(a);if(i=k.length,v.keys(b).length!==i)return!1;for(;i--;)if(j=k[i],!v.has(b,j)||!J(a[j],b[j],c,d))return!1}return c.pop(),d.pop(),!0};v.isEqual=function(a,b){return J(a,b)},v.isEmpty=function(a){return null==a?!0:D(a)&&(v.isArray(a)||v.isString(a)||v.isArguments(a))?0===a.length:0===v.keys(a).length},v.isElement=function(a){return!(!a||1!==a.nodeType)},v.isArray=q||function(a){return"[object Array]"===o.call(a)},v.isObject=function(a){var b=typeof a;return"function"===b||"object"===b&&!!a},v.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(a){v["is"+a]=function(b){return o.call(b)==="[object "+a+"]"}}),v.isArguments(arguments)||(v.isArguments=function(a){return v.has(a,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(v.isFunction=function(a){return"function"==typeof a||!1}),v.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},v.isNaN=function(a){return v.isNumber(a)&&a!==+a},v.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"===o.call(a)},v.isNull=function(a){return null===a},v.isUndefined=function(a){return void 0===a},v.has=function(a,b){return null!=a&&p.call(a,b)},v.noConflict=function(){return h._=i,this},v.identity=function(a){return a},v.constant=function(a){return function(){return a}},v.noop=function(){},v.property=A,v.propertyOf=function(a){return null==a?function(){}:function(b){return a[b]}},v.matcher=v.matches=function(a){return a=v.extendOwn({},a),function(b){return v.isMatch(b,a)}},v.times=function(a,b,c){var d=Array(Math.max(0,a));b=w(b,c,1);for(var e=0;a>e;e++)d[e]=b(e);return d},v.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))},v.now=Date.now||function(){return(new Date).getTime()};var K={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},L=v.invert(K),M=function(a){var b=function(b){return a[b]},c="(?:"+v.keys(a).join("|")+")",d=RegExp(c),e=RegExp(c,"g");return function(a){return a=null==a?"":""+a,d.test(a)?a.replace(e,b):a}};v.escape=M(K),v.unescape=M(L),v.result=function(a,b,c){var d=null==a?void 0:a[b];return void 0===d&&(d=c),v.isFunction(d)?d.call(a):d};var N=0;v.uniqueId=function(a){var b=++N+"";return a?a+b:b},v.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var O=/(.)^/,P={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Q=/\\|'|\r|\n|\u2028|\u2029/g,R=function(a){return"\\"+P[a]};v.template=function(a,b,c){!b&&c&&(b=c),b=v.defaults({},b,v.templateSettings);var d=RegExp([(b.escape||O).source,(b.interpolate||O).source,(b.evaluate||O).source].join("|")+"|$","g"),e=0,f="__p+='";a.replace(d,function(b,c,d,g,h){return f+=a.slice(e,h).replace(Q,R),e=h+b.length,c?f+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'":d?f+="'+\n((__t=("+d+"))==null?'':__t)+\n'":g&&(f+="';\n"+g+"\n__p+='"),b}),f+="';\n",b.variable||(f="with(obj||{}){\n"+f+"}\n"),f="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+f+"return __p;\n";try{var g=new Function(b.variable||"obj","_",f)}catch(h){throw h.source=f,h}var i=function(a){return g.call(this,a,v)},j=b.variable||"obj";return i.source="function("+j+"){\n"+f+"}",i},v.chain=function(a){var b=v(a);return b._chain=!0,b};var S=function(a,b){return a._chain?v(b).chain():b};v.mixin=function(a){v.each(v.functions(a),function(b){var c=v[b]=a[b];v.prototype[b]=function(){var a=[this._wrapped];return m.apply(a,arguments),S(this,c.apply(v,a))}})},v.mixin(v),v.each(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=j[a];v.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!==a&&"splice"!==a||0!==c.length||delete c[0],S(this,c)}}),v.each(["concat","join","slice"],function(a){var b=j[a];v.prototype[a]=function(){return S(this,b.apply(this._wrapped,arguments))}}),v.prototype.value=function(){return this._wrapped},v.prototype.valueOf=v.prototype.toJSON=v.prototype.value,v.prototype.toString=function(){return""+this._wrapped},"function"==typeof a&&a.amd&&a("underscore",[],function(){return v})}).call(this)},{}],57:[function(a,b,c){function d(a){var b="    ";if(isNaN(parseInt(a)))b=a;else switch(a){case 1:b=" ";break;case 2:b="  ";break;case 3:b="   ";break;case 4:b="    ";break;case 5:b="     ";break;case 6:b="      ";break;case 7:b="       ";break;case 8:b="        ";break;case 9:b="         ";break;case 10:b="          ";break;case 11:b="           ";break;case 12:b="            "}var c=["\n"];for(ix=0;ix<100;ix++)c.push(c[ix]+b);return c}function e(){this.step="    ",this.shift=d(this.step)}function f(a,b){return b-(a.replace(/\(/g,"").length-a.replace(/\)/g,"").length)}function g(a,b){return a.replace(/\s{1,}/g," ").replace(/ AND /gi,"~::~"+b+b+"AND ").replace(/ BETWEEN /gi,"~::~"+b+"BETWEEN ").replace(/ CASE /gi,"~::~"+b+"CASE ").replace(/ ELSE /gi,"~::~"+b+"ELSE ").replace(/ END /gi,"~::~"+b+"END ").replace(/ FROM /gi,"~::~FROM ").replace(/ GROUP\s{1,}BY/gi,"~::~GROUP BY ").replace(/ HAVING /gi,"~::~HAVING ").replace(/ IN /gi," IN ").replace(/ JOIN /gi,"~::~JOIN ").replace(/ CROSS~::~{1,}JOIN /gi,"~::~CROSS JOIN ").replace(/ INNER~::~{1,}JOIN /gi,"~::~INNER JOIN ").replace(/ LEFT~::~{1,}JOIN /gi,"~::~LEFT JOIN ").replace(/ RIGHT~::~{1,}JOIN /gi,"~::~RIGHT JOIN ").replace(/ ON /gi,"~::~"+b+"ON ").replace(/ OR /gi,"~::~"+b+b+"OR ").replace(/ ORDER\s{1,}BY/gi,"~::~ORDER BY ").replace(/ OVER /gi,"~::~"+b+"OVER ").replace(/\(\s{0,}SELECT /gi,"~::~(SELECT ").replace(/\)\s{0,}SELECT /gi,")~::~SELECT ").replace(/ THEN /gi," THEN~::~"+b).replace(/ UNION /gi,"~::~UNION~::~").replace(/ USING /gi,"~::~USING ").replace(/ WHEN /gi,"~::~"+b+"WHEN ").replace(/ WHERE /gi,"~::~WHERE ").replace(/ WITH /gi,"~::~WITH ").replace(/ ALL /gi," ALL ").replace(/ AS /gi," AS ").replace(/ ASC /gi," ASC ").replace(/ DESC /gi," DESC ").replace(/ DISTINCT /gi," DISTINCT ").replace(/ EXISTS /gi," EXISTS ").replace(/ NOT /gi," NOT ").replace(/ NULL /gi," NULL ").replace(/ LIKE /gi," LIKE ").replace(/\s{0,}SELECT /gi,"SELECT ").replace(/\s{0,}UPDATE /gi,"UPDATE ").replace(/ SET /gi," SET ").replace(/~::~{1,}/g,"~::~").split("~::~")}e.prototype.xml=function(a,b){var c=a.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").replace(/\s*xmlns\=/g,"~::~xmlns=").split("~::~"),e=c.length,f=!1,g=0,h="",i=0,j=b?d(b):this.shift;for(i=0;e>i;i++)c[i].search(/<!/)>-1?(h+=j[g]+c[i],f=!0,(c[i].search(/-->/)>-1||c[i].search(/\]>/)>-1||c[i].search(/!DOCTYPE/)>-1)&&(f=!1)):c[i].search(/-->/)>-1||c[i].search(/\]>/)>-1?(h+=c[i],f=!1):/^<\w/.exec(c[i-1])&&/^<\/\w/.exec(c[i])&&/^<[\w:\-\.\,]+/.exec(c[i-1])==/^<\/[\w:\-\.\,]+/.exec(c[i])[0].replace("/","")?(h+=c[i],f||g--):c[i].search(/<\w/)>-1&&-1==c[i].search(/<\//)&&-1==c[i].search(/\/>/)?h=h+=f?c[i]:j[g++]+c[i]:c[i].search(/<\w/)>-1&&c[i].search(/<\//)>-1?h=h+=f?c[i]:j[g]+c[i]:c[i].search(/<\//)>-1?h=h+=f?c[i]:j[--g]+c[i]:c[i].search(/\/>/)>-1?h=h+=f?c[i]:j[g]+c[i]:h+=c[i].search(/<\?/)>-1?j[g]+c[i]:c[i].search(/xmlns\:/)>-1||c[i].search(/xmlns\=/)>-1?j[g]+c[i]:c[i];return"\n"==h[0]?h.slice(1):h},e.prototype.json=function(a,b){var b=b?b:this.step;return"undefined"==typeof JSON?a:"string"==typeof a?JSON.stringify(JSON.parse(a),null,b):"object"==typeof a?JSON.stringify(a,null,b):a},e.prototype.css=function(a,b){var c=a.replace(/\s{1,}/g," ").replace(/\{/g,"{~::~").replace(/\}/g,"~::~}~::~").replace(/\;/g,";~::~").replace(/\/\*/g,"~::~/*").replace(/\*\//g,"*/~::~").replace(/~::~\s{0,}~::~/g,"~::~").split("~::~"),e=c.length,f=0,g="",h=0,i=b?d(b):this.shift;for(h=0;e>h;h++)g+=/\{/.exec(c[h])?i[f++]+c[h]:/\}/.exec(c[h])?i[--f]+c[h]:/\*\\/.exec(c[h])?i[f]+c[h]:i[f]+c[h];return g.replace(/^\n{1,}/,"")},e.prototype.sql=function(a,b){var c=a.replace(/\s{1,}/g," ").replace(/\'/gi,"~::~'").split("~::~"),e=c.length,h=[],i=0,j=this.step,k=0,l="",m=0,n=b?d(b):this.shift;for(m=0;e>m;m++)h=m%2?h.concat(c[m]):h.concat(g(c[m],j));for(e=h.length,m=0;e>m;m++){k=f(h[m],k),/\s{0,}\s{0,}SELECT\s{0,}/.exec(h[m])&&(h[m]=h[m].replace(/\,/g,",\n"+j+j)),/\s{0,}\s{0,}SET\s{0,}/.exec(h[m])&&(h[m]=h[m].replace(/\,/g,",\n"+j+j)),/\s{0,}\(\s{0,}SELECT\s{0,}/.exec(h[m])?(i++,l+=n[i]+h[m]):/\'/.exec(h[m])?(1>k&&i&&i--,l+=h[m]):(l+=n[i]+h[m],1>k&&i&&i--)}return l=l.replace(/^\n{1,}/,"").replace(/\n{1,}/g,"\n")},e.prototype.xmlmin=function(a,b){var c=b?a:a.replace(/\<![ \r\n\t]*(--([^\-]|[\r\n]|-[^\-])*--[ \r\n\t]*)\>/g,"").replace(/[ \r\n\t]{1,}xmlns/g," xmlns");return c.replace(/>\s{0,}</g,"><")},e.prototype.jsonmin=function(a){return"undefined"==typeof JSON?a:JSON.stringify(JSON.parse(a),null,0)},e.prototype.cssmin=function(a,b){var c=b?a:a.replace(/\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\//g,"");return c.replace(/\s{1,}/g," ").replace(/\{\s{1,}/g,"{").replace(/\}\s{1,}/g,"}").replace(/\;\s{1,}/g,";").replace(/\/\*\s{1,}/g,"/*").replace(/\*\/\s{1,}/g,"*/")},e.prototype.sqlmin=function(a){return a.replace(/\s{1,}/g," ").replace(/\s{1,}\(/,"(").replace(/\s{1,}\)/,")")},b.exports=new e},{}]},{},[30])(30)});
//# sourceMappingURL=escher.min.js.map